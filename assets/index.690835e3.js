import{X as k,q as g,p as V}from"./index.ab2bd5b7.js";import B from"./index.efc4c5aa.js";import N from"./index.16b8bca7.js";import F from"./index.0f146d6f.js";import{G as M,D as A}from"./api.4013b156.js";import{a as C,r as l,l as X,al as d,o as w,Q as x,R as c,X as n,b as y,u as s,U as E,H as G}from"./vue.562ccee8.js";import{_ as j}from"./_plugin-vue_export-helper.c27b6911.js";import"./index.es.d2375c1e.js";import"./md5.b5efbca3.js";import"./crud.f15e3bf8.js";import"./dictionary.100483c1.js";import"./authFunction.ff362cdf.js";import"./index.vue_vue_type_script_setup_true_name_importExcel_lang.c6a669b0.js";import"./echarts.041eecf8.js";const q={class:"dept-box dept-left"},z={class:"dept-box dept-table"},H=C({name:"dept"}),I=C({...H,setup(K){let p=l([]),_=l([]),o=l(!1),i=l({}),f=l(null),D=l(null);const m=async()=>{let e=await M({});if((e==null?void 0:e.code)===2e3&&Array.isArray(e.data)){const t=k.toArrayTree(e.data,{parentKey:"parent",children:"children"});p.value=t}},b=e=>{var t;(t=f.value)==null||t.handleDoRefreshUser(e.id)},T=(e,t)=>{g.confirm("您确认删除该部门吗?","温馨提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(async()=>{var r;const a=await A(e);t(),(a==null?void 0:a.code)===2e3&&(V(a.msg),m(),(r=f.value)==null||r.handleDoRefreshUser(""))})},U=(e,t)=>{var a,r;if(e==="update"&&t){const u=((r=(a=D.value)==null?void 0:a.treeRef)==null?void 0:r.currentNode.parent.data)||{};_.value=[u],i.value=t}o.value=!0},h=e=>{e==="submit"&&m(),o.value=!1,i.value={}};return X(()=>{m()}),(e,t)=>{const a=d("el-col"),r=d("el-row"),u=d("el-drawer"),R=d("fs-page");return w(),x(R,null,{default:c(()=>[n(r,{class:"dept-el-row"},{default:c(()=>[n(a,{span:6},{default:c(()=>[y("div",q,[n(B,{ref_key:"deptTreeRef",ref:D,treeData:s(p),onTreeClick:b,onUpdateDept:U,onDeleteDept:T},null,8,["treeData"])])]),_:1}),n(a,{span:18},{default:c(()=>[y("div",z,[n(F,{ref_key:"deptUserRef",ref:f},null,512)])]),_:1})]),_:1}),n(u,{modelValue:s(o),"onUpdate:modelValue":t[0]||(t[0]=v=>G(o)?o.value=v:o=v),title:"部门配置",direction:"rtl",size:"500px","close-on-click-modal":!1,"before-close":h},{default:c(()=>[s(o)?(w(),x(N,{key:0,initFormData:s(i),treeData:s(p),cacheData:s(_),onDrawerClose:h},null,8,["initFormData","treeData","cacheData"])):E("",!0)]),_:1},8,["modelValue"])]),_:1})}}});const re=j(I,[["__scopeId","data-v-26d83cfb"]]);export{re as default};
