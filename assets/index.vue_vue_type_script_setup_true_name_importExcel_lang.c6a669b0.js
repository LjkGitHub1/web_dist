import{S as R,d as E,I as _,r as L,q as N}from"./index.ab2bd5b7.js";import{a as k,G as $,r as p,al as v,at as j,o as b,c as y,X as o,R as t,K as q,V as i,b as n,u as d,S as D}from"./vue.562ccee8.js";const I={style:{display:"inline-block"}},K={class:"dialog-footer"},O=k({name:"importExcel"}),J=k({...O,props:{upload:{type:Object,default(){return{open:!0,title:"",isUploading:!1,updateSupport:0,headers:{Authorization:"JWT "+R.get("token")},url:E()+"api/system/file/"}}},api:{type:String,default(){}}},setup(w){const V=$("refreshView");let a=w,s=p(!1);const f=p(),r=p(!1),m=p(!1),C=function(){r.value=!0},S=function(){_({url:a.api+"import_data/",params:{},method:"get"})},B=function(){_({url:a.api+"update_template/",params:{},method:"get"})},F=function(u,e,l){m.value=!0},T=function(u,e,l){return m.value=!1,s.value=!0,f.value.clearFiles(),L({url:a.api+"import_data/",method:"post",data:{url:u.data.url}}).then(g=>{s.value=!1,N.alert("导入成功","导入完成",{confirmButtonText:"OK",callback:x=>{V()}})}).catch(()=>{s.value=!1})},U=function(){f.value.submit()};return(u,e)=>{const l=v("el-button"),g=v("el-upload"),x=v("el-dialog"),z=j("loading");return b(),y("div",I,[o(l,{size:"default",type:"success",onClick:e[0]||(e[0]=c=>C())},{default:t(()=>[q(u.$slots,"default",{},()=>[e[3]||(e[3]=i("导入"))])]),_:3}),o(x,{title:d(a).upload.title,modelValue:r.value,"onUpdate:modelValue":e[2]||(e[2]=c=>r.value=c),width:"400px","append-to-body":""},{footer:t(()=>[n("div",K,[o(l,{type:"primary",disabled:d(s),onClick:U},{default:t(()=>e[9]||(e[9]=[i("确 定")])),_:1},8,["disabled"]),o(l,{disabled:d(s),onClick:e[1]||(e[1]=c=>r.value=!1)},{default:t(()=>e[10]||(e[10]=[i("取 消")])),_:1},8,["disabled"])])]),default:t(()=>[D((b(),y("div",null,[o(g,{ref_key:"uploadRef",ref:f,limit:1,accept:".xlsx, .xls",headers:d(a).upload.headers,action:d(a).upload.url,disabled:m.value,"on-progress":F,"on-success":T,"auto-upload":!1,drag:""},{tip:t(()=>e[4]||(e[4]=[n("div",{class:"el-upload__tip",style:{color:"red"}},"提示：仅允许导入“xls”或“xlsx”格式文件！",-1)])),default:t(()=>[e[5]||(e[5]=n("i",{class:"el-icon-upload"},null,-1)),e[6]||(e[6]=n("div",{class:"el-upload__text"},[i(" 将文件拖到此处，或 "),n("em",null,"点击上传")],-1))]),_:1},8,["headers","action","disabled"]),n("div",null,[o(l,{type:"warning",style:{"font-size":"14px","margin-top":"20px"},onClick:S},{default:t(()=>e[7]||(e[7]=[i("下载导入模板")])),_:1}),o(l,{type:"warning",style:{"font-size":"14px","margin-top":"20px"},onClick:B},{default:t(()=>e[8]||(e[8]=[i("批量更新模板")])),_:1})])])),[[z,d(s)]])]),_:1},8,["title","modelValue"])])}}});export{J as _};
