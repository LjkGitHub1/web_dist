import{k as O,a0 as j,l as N,al as p,o as r,c as w,X as a,R as s,V as g,u as T,W as C,U as u,S as V,Y as h,ac as E,Q as f,F as K,n as L}from"./vue.562ccee8.js";import{U as S,A,G,D as M}from"./api.214b983a.js";import{m as c}from"./index.ab2bd5b7.js";const Q={key:0},R={key:0},W={__name:"option",props:["questionId"],setup(q){const{proxy:_}=O(),d=q;d.questionId;let l=j([]);const I=()=>{console.log("点到我了"),l.push({question:d.questionId,text:"",editing:!0}),b(l.length-1),console.log("editing状态",l[l.length-1])},k=e=>{console.log(typeof d.questionId);const o={...e.id&&{id:e.id},question:d.questionId,text:e.text,score:e.score};if(e.id)return S(o).then(n=>{if(n.code==2e3)return e.editing=!1,m(),c({title:"成功",message:n.msg,type:"success"});c({title:"失败",message:n.msg,type:"danger"})});A(o).then(n=>{if(n.code==2e3)return e.editing=!1,m(),c({title:"成功",message:n.msg,type:"success"});c({title:"失败",message:n.msg,type:"danger"})})},$=e=>{e.text||l.pop(),e.editing=!1},U=e=>{e.editing=!0,b(e)},x=()=>{G({question:d.questionId}).then(e=>{Object.assign(l,e.data)})},m=()=>{x(),console.log("after",l)},B=e=>{console.log("item",e),console.log("before",l),_.$confirm("您确定要删除该记录吗?","删除提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(()=>{M(e.id).then(o=>{if(o.code==2e3)return e.editing=!1,m(),l.pop(),console.log("optionListddd",l),c({title:"成功",message:o.msg,type:"success"});c({title:"失败",message:o.msg,type:"danger"})})}).catch(()=>{})},b=e=>{console.log("indexOrItem",e);let o;typeof e=="number"?o="autoFocus"+l[e].id:o="autoFocus"+e.id,console.log(o),L(()=>{const n=_.$refs[o];n&&n.focus()})};return N(async()=>{x(),console.log("questionId",d.questionId)}),(e,o)=>{const n=p("el-button"),v=p("el-input"),y=p("el-table-column"),D=p("el-table"),F=p("el-form");return r(),w(K,null,[a(n,{type:"primary",plain:"",icon:"plus",onClick:o[0]||(o[0]=t=>I())},{default:s(()=>o[1]||(o[1]=[g("添加选项")])),_:1}),a(F,null,{default:s(()=>[a(D,{data:T(l),"show-header":!1},{default:s(()=>[a(y,{prop:"text"},{default:s(t=>[t.row.editing?u("",!0):(r(),w("span",Q,C(t.row.text),1)),V(a(v,{modelValue:t.row.text,"onUpdate:modelValue":i=>t.row.text=i,ref:"autoFocus"+t.row.id},null,8,["modelValue","onUpdate:modelValue"]),[[h,t.row.editing]])]),_:1}),a(y,{prop:"score"},{default:s(t=>[t.row.editing?u("",!0):(r(),w("span",R,C(t.row.score)+"分",1)),V(a(v,{type:"number",modelValue:t.row.score,"onUpdate:modelValue":i=>t.row.score=i,onKeyup:E(i=>k(t.row),["enter","native"])},{append:s(()=>o[2]||(o[2]=[g("分")])),_:2},1032,["modelValue","onUpdate:modelValue","onKeyup"]),[[h,t.row.editing]])]),_:1}),a(y,{label:"操作",fixed:"right",width:"180"},{default:s(t=>[t.row.editing?(r(),f(n,{key:0,type:"primary",plain:"",onClick:i=>k(t.row)},{default:s(()=>o[3]||(o[3]=[g("保存")])),_:2},1032,["onClick"])):u("",!0),t.row.editing?u("",!0):(r(),f(n,{key:1,type:"primary",icon:"edit",circle:"",onClick:i=>U(t.row)},null,8,["onClick"])),t.row.editing?(r(),f(n,{key:2,type:"info",onClick:i=>$(t.row)},{default:s(()=>o[4]||(o[4]=[g("取消")])),_:2},1032,["onClick"])):u("",!0),t.row.editing?u("",!0):(r(),f(n,{key:3,type:"danger",icon:"delete",circle:"",onClick:i=>B(t.row)},null,8,["onClick"]))]),_:1})]),_:1},8,["data"])]),_:1})],64)}}},H=W;export{H as default};
