import{a as $,r as d,a0 as F,m as O,l as T,al as s,o as v,c as y,X as l,R as n,b as p,V as m,S as E,Y as I,W as k,F as U,ab as q,O as A,u as P}from"./vue.562ccee8.js";import{$ as Q,p as W,w as X}from"./index.ab2bd5b7.js";import{g as Y,c as j}from"./crud.5d2f62f3.js";import{a as z}from"./api.1e82473c.js";import{_ as G}from"./_plugin-vue_export-helper.c27b6911.js";import"./authFunction.ff362cdf.js";const H={class:"model-card"},J=["value"],K={class:"dialog-footer"},Z={style:{height:"80vh"}},ee=$({__name:"index",setup(oe,{expose:h}){let r=d({name:null});const t=F({model:"",app:"",menu:""}),u=d(!1),i=d([]),g=d(null),x=(e,o)=>{g.value=o,t.model=e.key,t.app=e.app},c=d(""),w=O(()=>{if(!c.value)return i.value;const e=c.value.toLowerCase();return i.value.filter(o=>o.app.toLowerCase().includes(e)||o.title.toLowerCase().includes(e)||o.key.toLowerCase().includes(e))}),V=e=>{!e.is_catalog&&e.id?(r.value=e,_.doRefresh()):_.setTableData([])},b=async()=>{if(t.menu=r.value.id,u.value=!1,t.menu&&t.model){const e=await z(t);(e==null?void 0:e.code)===2e3&&W("匹配成功"),_.doSearch({form:{menu:t.menu,model:t.model}})}else X("请选择角色和模型表！")},{crudBinding:D,crudRef:L,crudExpose:_}=Q({createCrudOptions:j,props:t,modelDialog:u,selectOptions:r,allModelData:i});return T(async()=>{const e=await Y();i.value=e.data}),h({selectOptions:r,handleRefreshTable:V}),(e,o)=>{const M=s("el-tag"),R=s("el-input"),N=s("el-text"),C=s("el-button"),B=s("el-dialog"),S=s("fs-crud");return v(),y("div",null,[l(B,{ref:"modelRef",modelValue:u.value,"onUpdate:modelValue":o[2]||(o[2]=a=>u.value=a),title:"选择model"},{footer:n(()=>[p("span",K,[l(C,{onClick:o[1]||(o[1]=a=>u.value=!1)},{default:n(()=>o[3]||(o[3]=[m("取消")])),_:1}),l(C,{type:"primary",onClick:b},{default:n(()=>o[4]||(o[4]=[m(" 确定 ")])),_:1})])]),default:n(()=>[E(p("div",null,[l(M,null,{default:n(()=>[m("已选择:"+k(t.model),1)]),_:1})],512),[[I,t.model]]),l(R,{modelValue:c.value,"onUpdate:modelValue":o[0]||(o[0]=a=>c.value=a),placeholder:"搜索模型...",style:{"margin-bottom":"10px"}},null,8,["modelValue"]),p("div",H,[(v(!0),y(U,null,q(w.value,(a,f)=>(v(),y("div",{value:a.key,key:f},[l(N,{type:g.value===f?"primary":"",onClick:te=>x(a,f)},{default:n(()=>[m(k(a.app+"--"+a.title+"("+a.key+")"),1)]),_:2},1032,["type","onClick"])],8,J))),128))])]),_:1},8,["modelValue"]),p("div",Z,[l(S,A({ref_key:"crudRef",ref:L},P(D)),null,16)])])}}});const re=G(ee,[["__scopeId","data-v-291b137a"]]);export{re as default};
