import{c as Pt,g as Et,a1 as Ot,l as Rt,Z as It,a0 as wt}from"./index.ab2bd5b7.js";import"./vue.562ccee8.js";var mt={exports:{}};(function(Ne,$e){(function(re,P){Ne.exports=P()})(Pt,function(){return function(H){var re={};function P(F){if(re[F])return re[F].exports;var O=re[F]={i:F,l:!1,exports:{}};return H[F].call(O.exports,O,O.exports,P),O.l=!0,O.exports}return P.m=H,P.c=re,P.d=function(F,O,s){P.o(F,O)||Object.defineProperty(F,O,{enumerable:!0,get:s})},P.r=function(F){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(F,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(F,"__esModule",{value:!0})},P.t=function(F,O){if(O&1&&(F=P(F)),O&8||O&4&&typeof F=="object"&&F&&F.__esModule)return F;var s=Object.create(null);if(P.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:F}),O&2&&typeof F!="string")for(var j in F)P.d(s,j,(function(b){return F[b]}).bind(null,j));return s},P.n=function(F){var O=F&&F.__esModule?function(){return F.default}:function(){return F};return P.d(O,"a",O),O},P.o=function(F,O){return Object.prototype.hasOwnProperty.call(F,O)},P.p="/dist/",P(P.s="./index.js")}({"./index.js":function(H,re,P){var F=P("./src/cos.js");H.exports=F},"./lib/base64.js":function(H,re){var P=function(F){F=F||{};var O=F.Base64,s="2.1.9",j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b=function(i){for(var u={},y=0,L=i.length;y<L;y++)u[i.charAt(y)]=y;return u}(j),M=String.fromCharCode,f=function(u){if(u.length<2){var y=u.charCodeAt(0);return y<128?u:y<2048?M(192|y>>>6)+M(128|y&63):M(224|y>>>12&15)+M(128|y>>>6&63)+M(128|y&63)}else{var y=65536+(u.charCodeAt(0)-55296)*1024+(u.charCodeAt(1)-56320);return M(240|y>>>18&7)+M(128|y>>>12&63)+M(128|y>>>6&63)+M(128|y&63)}},d=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,m=function(u){return u.replace(d,f)},h=function(u){var y=[0,2,1][u.length%3],L=u.charCodeAt(0)<<16|(u.length>1?u.charCodeAt(1):0)<<8|(u.length>2?u.charCodeAt(2):0),k=[j.charAt(L>>>18),j.charAt(L>>>12&63),y>=2?"=":j.charAt(L>>>6&63),y>=1?"=":j.charAt(L&63)];return k.join("")},C=F.btoa?function(i){return F.btoa(i)}:function(i){return i.replace(/[\s\S]{1,3}/g,h)},A=function(i){return C(m(i))},R=function(u,y){return y?A(String(u)).replace(/[+\/]/g,function(L){return L=="+"?"-":"_"}).replace(/=/g,""):A(String(u))},N=function(u){return R(u,!0)},U=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),z=function(u){switch(u.length){case 4:var y=(7&u.charCodeAt(0))<<18|(63&u.charCodeAt(1))<<12|(63&u.charCodeAt(2))<<6|63&u.charCodeAt(3),L=y-65536;return M((L>>>10)+55296)+M((L&1023)+56320);case 3:return M((15&u.charCodeAt(0))<<12|(63&u.charCodeAt(1))<<6|63&u.charCodeAt(2));default:return M((31&u.charCodeAt(0))<<6|63&u.charCodeAt(1))}},G=function(u){return u.replace(U,z)},g=function(u){var y=u.length,L=y%4,k=(y>0?b[u.charAt(0)]<<18:0)|(y>1?b[u.charAt(1)]<<12:0)|(y>2?b[u.charAt(2)]<<6:0)|(y>3?b[u.charAt(3)]:0),w=[M(k>>>16),M(k>>>8&255),M(k&255)];return w.length-=[0,0,2,1][L],w.join("")},l=F.atob?function(i){return F.atob(i)}:function(i){return i.replace(/[\s\S]{1,4}/g,g)},x=function(i){return G(l(i))},n=function(u){return x(String(u).replace(/[-_]/g,function(y){return y=="-"?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},o=function(){var u=F.Base64;return F.Base64=O,u},t={VERSION:s,atob:l,btoa:C,fromBase64:n,toBase64:R,utob:m,encode:R,encodeURI:N,btou:G,decode:n,noConflict:o};return t}();H.exports=P},"./lib/crypto.js":function(H,re,P){(function(F){var O=P("./node_modules/@babel/runtime/helpers/typeof.js"),s=s||function(j,b){var M={},f=M.lib={},d=function(){},m=f.Base={extend:function(g){d.prototype=this;var l=new d;return g&&l.mixIn(g),l.hasOwnProperty("init")||(l.init=function(){l.$super.init.apply(this,arguments)}),l.init.prototype=l,l.$super=this,l},create:function(){var g=this.extend();return g.init.apply(g,arguments),g},init:function(){},mixIn:function(g){for(var l in g)g.hasOwnProperty(l)&&(this[l]=g[l]);g.hasOwnProperty("toString")&&(this.toString=g.toString)},clone:function(){return this.init.prototype.extend(this)}},h=f.WordArray=m.extend({init:function(g,l){g=this.words=g||[],this.sigBytes=l!=b?l:4*g.length},toString:function(g){return(g||A).stringify(this)},concat:function(g){var l=this.words,x=g.words,n=this.sigBytes;if(g=g.sigBytes,this.clamp(),n%4)for(var o=0;o<g;o++)l[n+o>>>2]|=(x[o>>>2]>>>24-8*(o%4)&255)<<24-8*((n+o)%4);else if(65535<x.length)for(o=0;o<g;o+=4)l[n+o>>>2]=x[o>>>2];else l.push.apply(l,x);return this.sigBytes+=g,this},clamp:function(){var g=this.words,l=this.sigBytes;g[l>>>2]&=4294967295<<32-8*(l%4),g.length=j.ceil(l/4)},clone:function(){var g=m.clone.call(this);return g.words=this.words.slice(0),g},random:function(g){for(var l=[],x=0;x<g;x+=4)l.push(4294967296*j.random()|0);return new h.init(l,g)}}),C=M.enc={},A=C.Hex={stringify:function(g){var l=g.words;g=g.sigBytes;for(var x=[],n=0;n<g;n++){var o=l[n>>>2]>>>24-8*(n%4)&255;x.push((o>>>4).toString(16)),x.push((o&15).toString(16))}return x.join("")},parse:function(g){for(var l=g.length,x=[],n=0;n<l;n+=2)x[n>>>3]|=parseInt(g.substr(n,2),16)<<24-4*(n%8);return new h.init(x,l/2)}},R=C.Latin1={stringify:function(g){var l=g.words;g=g.sigBytes;for(var x=[],n=0;n<g;n++)x.push(String.fromCharCode(l[n>>>2]>>>24-8*(n%4)&255));return x.join("")},parse:function(g){for(var l=g.length,x=[],n=0;n<l;n++)x[n>>>2]|=(g.charCodeAt(n)&255)<<24-8*(n%4);return new h.init(x,l)}},N=C.Utf8={stringify:function(g){try{return decodeURIComponent(escape(R.stringify(g)))}catch{throw Error("Malformed UTF-8 data")}},parse:function(g){return R.parse(unescape(encodeURIComponent(g)))}},U=f.BufferedBlockAlgorithm=m.extend({reset:function(){this._data=new h.init,this._nDataBytes=0},_append:function(g){typeof g=="string"&&(g=N.parse(g)),this._data.concat(g),this._nDataBytes+=g.sigBytes},_process:function(g){var l=this._data,x=l.words,n=l.sigBytes,o=this.blockSize,t=n/(4*o),t=g?j.ceil(t):j.max((t|0)-this._minBufferSize,0);if(g=t*o,n=j.min(4*g,n),g){for(var i=0;i<g;i+=o)this._doProcessBlock(x,i);i=x.splice(0,g),l.sigBytes-=n}return new h.init(i,n)},clone:function(){var g=m.clone.call(this);return g._data=this._data.clone(),g},_minBufferSize:0});f.Hasher=U.extend({cfg:m.extend(),init:function(g){this.cfg=this.cfg.extend(g),this.reset()},reset:function(){U.reset.call(this),this._doReset()},update:function(g){return this._append(g),this._process(),this},finalize:function(g){return g&&this._append(g),this._doFinalize()},blockSize:16,_createHelper:function(g){return function(l,x){return new g.init(x).finalize(l)}},_createHmacHelper:function(g){return function(l,x){return new z.HMAC.init(g,x).finalize(l)}}});var z=M.algo={};return M}(Math);(function(){var j=s,d=j.lib,b=d.WordArray,M=d.Hasher,f=[],d=j.algo.SHA1=M.extend({_doReset:function(){this._hash=new b.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(h,C){for(var A=this._hash.words,R=A[0],N=A[1],U=A[2],z=A[3],G=A[4],g=0;80>g;g++){if(16>g)f[g]=h[C+g]|0;else{var l=f[g-3]^f[g-8]^f[g-14]^f[g-16];f[g]=l<<1|l>>>31}l=(R<<5|R>>>27)+G+f[g],l=20>g?l+((N&U|~N&z)+1518500249):40>g?l+((N^U^z)+1859775393):60>g?l+((N&U|N&z|U&z)-1894007588):l+((N^U^z)-899497514),G=z,z=U,U=N<<30|N>>>2,N=R,R=l}A[0]=A[0]+R|0,A[1]=A[1]+N|0,A[2]=A[2]+U|0,A[3]=A[3]+z|0,A[4]=A[4]+G|0},_doFinalize:function(){var h=this._data,C=h.words,A=8*this._nDataBytes,R=8*h.sigBytes;return C[R>>>5]|=128<<24-R%32,C[(R+64>>>9<<4)+14]=Math.floor(A/4294967296),C[(R+64>>>9<<4)+15]=A,h.sigBytes=4*C.length,this._process(),this._hash},clone:function(){var h=M.clone.call(this);return h._hash=this._hash.clone(),h}});j.SHA1=M._createHelper(d),j.HmacSHA1=M._createHmacHelper(d)})(),function(){var j=s,b=j.enc.Utf8;j.algo.HMAC=j.lib.Base.extend({init:function(f,d){f=this._hasher=new f.init,typeof d=="string"&&(d=b.parse(d));var m=f.blockSize,h=4*m;d.sigBytes>h&&(d=f.finalize(d)),d.clamp();for(var C=this._oKey=d.clone(),A=this._iKey=d.clone(),R=C.words,N=A.words,U=0;U<m;U++)R[U]^=1549556828,N[U]^=909522486;C.sigBytes=A.sigBytes=h,this.reset()},reset:function(){var f=this._hasher;f.reset(),f.update(this._iKey)},update:function(f){return this._hasher.update(f),this},finalize:function(f){var d=this._hasher;return f=d.finalize(f),d.reset(),d.finalize(this._oKey.clone().concat(f))}})}(),function(){var j=s,b=j.lib,M=b.WordArray,f=j.enc;f.Base64={stringify:function(m){var h=m.words,C=m.sigBytes,A=this._map;m.clamp();for(var R=[],N=0;N<C;N+=3)for(var U=h[N>>>2]>>>24-N%4*8&255,z=h[N+1>>>2]>>>24-(N+1)%4*8&255,G=h[N+2>>>2]>>>24-(N+2)%4*8&255,g=U<<16|z<<8|G,l=0;l<4&&N+l*.75<C;l++)R.push(A.charAt(g>>>6*(3-l)&63));var x=A.charAt(64);if(x)for(;R.length%4;)R.push(x);return R.join("")},parse:function(m){var h=m.length,C=this._map,A=C.charAt(64);if(A){var R=m.indexOf(A);R!=-1&&(h=R)}for(var N=[],U=0,z=0;z<h;z++)if(z%4){var G=C.indexOf(m.charAt(z-1))<<z%4*2,g=C.indexOf(m.charAt(z))>>>6-z%4*2;N[U>>>2]|=(G|g)<<24-U%4*8,U++}return M.create(N,U)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),O(F)==="object"?F.exports=s:window.CryptoJS=s}).call(this,P("./node_modules/webpack/buildin/module.js")(H))},"./lib/md5.js":function(H,re,P){(function(F){var O,s=P("./node_modules/@babel/runtime/helpers/typeof.js");(function(){var j=(typeof window>"u"?"undefined":s(window))==="object",b=j?window:{};b.JS_MD5_NO_WINDOW&&(j=!1);var M=!j&&(typeof self>"u"?"undefined":s(self))==="object";M&&(b=self);var f=!b.JS_MD5_NO_COMMON_JS&&s(F)==="object"&&F.exports,d=P("./node_modules/webpack/buildin/amd-options.js"),m=!b.JS_MD5_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",h="0123456789abcdef".split(""),C=[128,32768,8388608,-2147483648],A=[0,8,16,24],R=["hex","array","digest","buffer","arrayBuffer","base64"],N="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),U=[],z;if(m){var G=new ArrayBuffer(68);z=new Uint8Array(G),U=new Uint32Array(G)}(b.JS_MD5_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(o){return Object.prototype.toString.call(o)==="[object Array]"}),m&&(b.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(o){return s(o)==="object"&&o.buffer&&o.buffer.constructor===ArrayBuffer});var g=function(t){return function(i,u){return new x(!0).update(i,u)[t]()}},l=function(){var t=g("hex");t.getCtx=t.create=function(){return new x},t.update=function(y){return t.create().update(y)};for(var i=0;i<R.length;++i){var u=R[i];t[u]=g(u)}return t};function x(o){if(o)U[0]=U[16]=U[1]=U[2]=U[3]=U[4]=U[5]=U[6]=U[7]=U[8]=U[9]=U[10]=U[11]=U[12]=U[13]=U[14]=U[15]=0,this.blocks=U,this.buffer8=z;else if(m){var t=new ArrayBuffer(68);this.buffer8=new Uint8Array(t),this.blocks=new Uint32Array(t)}else this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}x.prototype.update=function(o,t){if(!this.finalized){for(var i,u=0,y,L=o.length,k=this.blocks,w=this.buffer8;u<L;){if(this.hashed&&(this.hashed=!1,k[0]=k[16],k[16]=k[1]=k[2]=k[3]=k[4]=k[5]=k[6]=k[7]=k[8]=k[9]=k[10]=k[11]=k[12]=k[13]=k[14]=k[15]=0),m)for(y=this.start;u<L&&y<64;++u)i=o.charCodeAt(u),t||i<128?w[y++]=i:i<2048?(w[y++]=192|i>>6,w[y++]=128|i&63):i<55296||i>=57344?(w[y++]=224|i>>12,w[y++]=128|i>>6&63,w[y++]=128|i&63):(i=65536+((i&1023)<<10|o.charCodeAt(++u)&1023),w[y++]=240|i>>18,w[y++]=128|i>>12&63,w[y++]=128|i>>6&63,w[y++]=128|i&63);else for(y=this.start;u<L&&y<64;++u)i=o.charCodeAt(u),t||i<128?k[y>>2]|=i<<A[y++&3]:i<2048?(k[y>>2]|=(192|i>>6)<<A[y++&3],k[y>>2]|=(128|i&63)<<A[y++&3]):i<55296||i>=57344?(k[y>>2]|=(224|i>>12)<<A[y++&3],k[y>>2]|=(128|i>>6&63)<<A[y++&3],k[y>>2]|=(128|i&63)<<A[y++&3]):(i=65536+((i&1023)<<10|o.charCodeAt(++u)&1023),k[y>>2]|=(240|i>>18)<<A[y++&3],k[y>>2]|=(128|i>>12&63)<<A[y++&3],k[y>>2]|=(128|i>>6&63)<<A[y++&3],k[y>>2]|=(128|i&63)<<A[y++&3]);this.lastByteIndex=y,this.bytes+=y-this.start,y>=64?(this.start=y-64,this.hash(),this.hashed=!0):this.start=y}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},x.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var o=this.blocks,t=this.lastByteIndex;o[t>>2]|=C[t&3],t>=56&&(this.hashed||this.hash(),o[0]=o[16],o[16]=o[1]=o[2]=o[3]=o[4]=o[5]=o[6]=o[7]=o[8]=o[9]=o[10]=o[11]=o[12]=o[13]=o[14]=o[15]=0),o[14]=this.bytes<<3,o[15]=this.hBytes<<3|this.bytes>>>29,this.hash()}},x.prototype.hash=function(){var o,t,i,u,y,L,k=this.blocks;this.first?(o=k[0]-680876937,o=(o<<7|o>>>25)-271733879<<0,u=(-1732584194^o&2004318071)+k[1]-117830708,u=(u<<12|u>>>20)+o<<0,i=(-271733879^u&(o^-271733879))+k[2]-1126478375,i=(i<<17|i>>>15)+u<<0,t=(o^i&(u^o))+k[3]-1316259209,t=(t<<22|t>>>10)+i<<0):(o=this.h0,t=this.h1,i=this.h2,u=this.h3,o+=(u^t&(i^u))+k[0]-680876936,o=(o<<7|o>>>25)+t<<0,u+=(i^o&(t^i))+k[1]-389564586,u=(u<<12|u>>>20)+o<<0,i+=(t^u&(o^t))+k[2]+606105819,i=(i<<17|i>>>15)+u<<0,t+=(o^i&(u^o))+k[3]-1044525330,t=(t<<22|t>>>10)+i<<0),o+=(u^t&(i^u))+k[4]-176418897,o=(o<<7|o>>>25)+t<<0,u+=(i^o&(t^i))+k[5]+1200080426,u=(u<<12|u>>>20)+o<<0,i+=(t^u&(o^t))+k[6]-1473231341,i=(i<<17|i>>>15)+u<<0,t+=(o^i&(u^o))+k[7]-45705983,t=(t<<22|t>>>10)+i<<0,o+=(u^t&(i^u))+k[8]+1770035416,o=(o<<7|o>>>25)+t<<0,u+=(i^o&(t^i))+k[9]-1958414417,u=(u<<12|u>>>20)+o<<0,i+=(t^u&(o^t))+k[10]-42063,i=(i<<17|i>>>15)+u<<0,t+=(o^i&(u^o))+k[11]-1990404162,t=(t<<22|t>>>10)+i<<0,o+=(u^t&(i^u))+k[12]+1804603682,o=(o<<7|o>>>25)+t<<0,u+=(i^o&(t^i))+k[13]-40341101,u=(u<<12|u>>>20)+o<<0,i+=(t^u&(o^t))+k[14]-1502002290,i=(i<<17|i>>>15)+u<<0,t+=(o^i&(u^o))+k[15]+1236535329,t=(t<<22|t>>>10)+i<<0,o+=(i^u&(t^i))+k[1]-165796510,o=(o<<5|o>>>27)+t<<0,u+=(t^i&(o^t))+k[6]-1069501632,u=(u<<9|u>>>23)+o<<0,i+=(o^t&(u^o))+k[11]+643717713,i=(i<<14|i>>>18)+u<<0,t+=(u^o&(i^u))+k[0]-373897302,t=(t<<20|t>>>12)+i<<0,o+=(i^u&(t^i))+k[5]-701558691,o=(o<<5|o>>>27)+t<<0,u+=(t^i&(o^t))+k[10]+38016083,u=(u<<9|u>>>23)+o<<0,i+=(o^t&(u^o))+k[15]-660478335,i=(i<<14|i>>>18)+u<<0,t+=(u^o&(i^u))+k[4]-405537848,t=(t<<20|t>>>12)+i<<0,o+=(i^u&(t^i))+k[9]+568446438,o=(o<<5|o>>>27)+t<<0,u+=(t^i&(o^t))+k[14]-1019803690,u=(u<<9|u>>>23)+o<<0,i+=(o^t&(u^o))+k[3]-187363961,i=(i<<14|i>>>18)+u<<0,t+=(u^o&(i^u))+k[8]+1163531501,t=(t<<20|t>>>12)+i<<0,o+=(i^u&(t^i))+k[13]-1444681467,o=(o<<5|o>>>27)+t<<0,u+=(t^i&(o^t))+k[2]-51403784,u=(u<<9|u>>>23)+o<<0,i+=(o^t&(u^o))+k[7]+1735328473,i=(i<<14|i>>>18)+u<<0,t+=(u^o&(i^u))+k[12]-1926607734,t=(t<<20|t>>>12)+i<<0,y=t^i,o+=(y^u)+k[5]-378558,o=(o<<4|o>>>28)+t<<0,u+=(y^o)+k[8]-2022574463,u=(u<<11|u>>>21)+o<<0,L=u^o,i+=(L^t)+k[11]+1839030562,i=(i<<16|i>>>16)+u<<0,t+=(L^i)+k[14]-35309556,t=(t<<23|t>>>9)+i<<0,y=t^i,o+=(y^u)+k[1]-1530992060,o=(o<<4|o>>>28)+t<<0,u+=(y^o)+k[4]+1272893353,u=(u<<11|u>>>21)+o<<0,L=u^o,i+=(L^t)+k[7]-155497632,i=(i<<16|i>>>16)+u<<0,t+=(L^i)+k[10]-1094730640,t=(t<<23|t>>>9)+i<<0,y=t^i,o+=(y^u)+k[13]+681279174,o=(o<<4|o>>>28)+t<<0,u+=(y^o)+k[0]-358537222,u=(u<<11|u>>>21)+o<<0,L=u^o,i+=(L^t)+k[3]-722521979,i=(i<<16|i>>>16)+u<<0,t+=(L^i)+k[6]+76029189,t=(t<<23|t>>>9)+i<<0,y=t^i,o+=(y^u)+k[9]-640364487,o=(o<<4|o>>>28)+t<<0,u+=(y^o)+k[12]-421815835,u=(u<<11|u>>>21)+o<<0,L=u^o,i+=(L^t)+k[15]+530742520,i=(i<<16|i>>>16)+u<<0,t+=(L^i)+k[2]-995338651,t=(t<<23|t>>>9)+i<<0,o+=(i^(t|~u))+k[0]-198630844,o=(o<<6|o>>>26)+t<<0,u+=(t^(o|~i))+k[7]+1126891415,u=(u<<10|u>>>22)+o<<0,i+=(o^(u|~t))+k[14]-1416354905,i=(i<<15|i>>>17)+u<<0,t+=(u^(i|~o))+k[5]-57434055,t=(t<<21|t>>>11)+i<<0,o+=(i^(t|~u))+k[12]+1700485571,o=(o<<6|o>>>26)+t<<0,u+=(t^(o|~i))+k[3]-1894986606,u=(u<<10|u>>>22)+o<<0,i+=(o^(u|~t))+k[10]-1051523,i=(i<<15|i>>>17)+u<<0,t+=(u^(i|~o))+k[1]-2054922799,t=(t<<21|t>>>11)+i<<0,o+=(i^(t|~u))+k[8]+1873313359,o=(o<<6|o>>>26)+t<<0,u+=(t^(o|~i))+k[15]-30611744,u=(u<<10|u>>>22)+o<<0,i+=(o^(u|~t))+k[6]-1560198380,i=(i<<15|i>>>17)+u<<0,t+=(u^(i|~o))+k[13]+1309151649,t=(t<<21|t>>>11)+i<<0,o+=(i^(t|~u))+k[4]-145523070,o=(o<<6|o>>>26)+t<<0,u+=(t^(o|~i))+k[11]-1120210379,u=(u<<10|u>>>22)+o<<0,i+=(o^(u|~t))+k[2]+718787259,i=(i<<15|i>>>17)+u<<0,t+=(u^(i|~o))+k[9]-343485551,t=(t<<21|t>>>11)+i<<0,this.first?(this.h0=o+1732584193<<0,this.h1=t-271733879<<0,this.h2=i-1732584194<<0,this.h3=u+271733878<<0,this.first=!1):(this.h0=this.h0+o<<0,this.h1=this.h1+t<<0,this.h2=this.h2+i<<0,this.h3=this.h3+u<<0)},x.prototype.hex=function(){this.finalize();var o=this.h0,t=this.h1,i=this.h2,u=this.h3;return h[o>>4&15]+h[o&15]+h[o>>12&15]+h[o>>8&15]+h[o>>20&15]+h[o>>16&15]+h[o>>28&15]+h[o>>24&15]+h[t>>4&15]+h[t&15]+h[t>>12&15]+h[t>>8&15]+h[t>>20&15]+h[t>>16&15]+h[t>>28&15]+h[t>>24&15]+h[i>>4&15]+h[i&15]+h[i>>12&15]+h[i>>8&15]+h[i>>20&15]+h[i>>16&15]+h[i>>28&15]+h[i>>24&15]+h[u>>4&15]+h[u&15]+h[u>>12&15]+h[u>>8&15]+h[u>>20&15]+h[u>>16&15]+h[u>>28&15]+h[u>>24&15]},x.prototype.toString=x.prototype.hex,x.prototype.digest=function(o){if(o==="hex")return this.hex();this.finalize();var t=this.h0,i=this.h1,u=this.h2,y=this.h3,L=[t&255,t>>8&255,t>>16&255,t>>24&255,i&255,i>>8&255,i>>16&255,i>>24&255,u&255,u>>8&255,u>>16&255,u>>24&255,y&255,y>>8&255,y>>16&255,y>>24&255];return L},x.prototype.array=x.prototype.digest,x.prototype.arrayBuffer=function(){this.finalize();var o=new ArrayBuffer(16),t=new Uint32Array(o);return t[0]=this.h0,t[1]=this.h1,t[2]=this.h2,t[3]=this.h3,o},x.prototype.buffer=x.prototype.arrayBuffer,x.prototype.base64=function(){for(var o,t,i,u="",y=this.array(),L=0;L<15;)o=y[L++],t=y[L++],i=y[L++],u+=N[o>>>2]+N[(o<<4|t>>>4)&63]+N[(t<<2|i>>>6)&63]+N[i&63];return o=y[L],u+=N[o>>>2]+N[o<<4&63]+"==",u};var n=l();f?F.exports=n:(b.md5=n,d&&(O=(function(){return n}).call(n,P,n,F),O!==void 0&&(F.exports=O)))})()}).call(this,P("./node_modules/webpack/buildin/module.js")(H))},"./lib/request.js":function(H,re,P){var F=P("./node_modules/@babel/runtime/helpers/typeof.js"),O=function(d){switch(F(d)){case"string":return d;case"boolean":return d?"true":"false";case"number":return isFinite(d)?d:"";default:return""}},s=function(d,m,h,C){return m=m||"&",h=h||"=",d===null&&(d=void 0),F(d)==="object"?Object.keys(d).map(function(A){var R=encodeURIComponent(O(A))+h;return Array.isArray(d[A])?d[A].map(function(N){return R+encodeURIComponent(O(N))}).join(m):R+encodeURIComponent(O(d[A]))}).filter(Boolean).join(m):C?encodeURIComponent(O(C))+h+encodeURIComponent(O(d)):""},j=function(d,m,h){var C={},A=m.getAllResponseHeaders();return A&&A.length>0&&A.trim().split(`
`).forEach(function(R){if(R){var N=R.indexOf(":"),U=R.substr(0,N).trim().toLowerCase(),z=R.substr(N+1).trim();C[U]=z}}),{error:d,statusCode:m.status,statusMessage:m.statusText,headers:C,body:h}},b=function(d,m){return!m&&m==="text"?d.responseText:d.response},M=function(d,m){var h=(d.method||"GET").toUpperCase(),C=d.url;if(d.qs){var A=s(d.qs);A&&(C+=(C.indexOf("?")===-1?"?":"&")+A)}var R=new XMLHttpRequest;if(R.open(h,C,!0),R.responseType=d.dataType||"text",d.xhrFields)for(var N in d.xhrFields)R[N]=d.xhrFields[N];var U=d.headers;if(U)for(var z in U)U.hasOwnProperty(z)&&z.toLowerCase()!=="content-length"&&z.toLowerCase()!=="user-agent"&&z.toLowerCase()!=="origin"&&z.toLowerCase()!=="host"&&R.setRequestHeader(z,U[z]);return d.onProgress&&R.upload&&(R.upload.onprogress=d.onProgress),d.onDownloadProgress&&(R.onprogress=d.onDownloadProgress),d.timeout&&(R.timeout=d.timeout),R.ontimeout=function(G){var g=new Error("timeout");m(j(g,R))},R.onload=function(){m(j(null,R,b(R,d.dataType)))},R.onerror=function(G){var g=b(R,d.dataType);if(g)m(j(null,R,g));else{var l=R.statusText;!l&&R.status===0&&(l=new Error("CORS blocked or network error")),m(j(l,R,g))}},R.send(d.body||""),R};H.exports=M},"./node_modules/@babel/runtime/helpers/classCallCheck.js":function(H,re){function P(F,O){if(!(F instanceof O))throw new TypeError("Cannot call a class as a function")}H.exports=P,H.exports.__esModule=!0,H.exports.default=H.exports},"./node_modules/@babel/runtime/helpers/createClass.js":function(H,re,P){var F=P("./node_modules/@babel/runtime/helpers/toPropertyKey.js");function O(j,b){for(var M=0;M<b.length;M++){var f=b[M];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(j,F(f.key),f)}}function s(j,b,M){return b&&O(j.prototype,b),M&&O(j,M),Object.defineProperty(j,"prototype",{writable:!1}),j}H.exports=s,H.exports.__esModule=!0,H.exports.default=H.exports},"./node_modules/@babel/runtime/helpers/toPrimitive.js":function(H,re,P){var F=P("./node_modules/@babel/runtime/helpers/typeof.js").default;function O(s,j){if(F(s)!=="object"||s===null)return s;var b=s[Symbol.toPrimitive];if(b!==void 0){var M=b.call(s,j||"default");if(F(M)!=="object")return M;throw new TypeError("@@toPrimitive must return a primitive value.")}return(j==="string"?String:Number)(s)}H.exports=O,H.exports.__esModule=!0,H.exports.default=H.exports},"./node_modules/@babel/runtime/helpers/toPropertyKey.js":function(H,re,P){var F=P("./node_modules/@babel/runtime/helpers/typeof.js").default,O=P("./node_modules/@babel/runtime/helpers/toPrimitive.js");function s(j){var b=O(j,"string");return F(b)==="symbol"?b:String(b)}H.exports=s,H.exports.__esModule=!0,H.exports.default=H.exports},"./node_modules/@babel/runtime/helpers/typeof.js":function(H,re){function P(F){"@babel/helpers - typeof";return H.exports=P=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(O){return typeof O}:function(O){return O&&typeof Symbol=="function"&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O},H.exports.__esModule=!0,H.exports.default=H.exports,P(F)}H.exports=P,H.exports.__esModule=!0,H.exports.default=H.exports},"./node_modules/fast-xml-parser/src/fxp.js":function(H,re,P){const F=P("./node_modules/fast-xml-parser/src/validator.js"),O=P("./node_modules/fast-xml-parser/src/xmlparser/XMLParser.js"),s=P("./node_modules/fast-xml-parser/src/xmlbuilder/json2xml.js");H.exports={XMLParser:O,XMLValidator:F,XMLBuilder:s}},"./node_modules/fast-xml-parser/src/util.js":function(H,re,P){const F=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",O=F+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",s="["+F+"]["+O+"]*",j=new RegExp("^"+s+"$"),b=function(f,d){const m=[];let h=d.exec(f);for(;h;){const C=[];C.startIndex=d.lastIndex-h[0].length;const A=h.length;for(let R=0;R<A;R++)C.push(h[R]);m.push(C),h=d.exec(f)}return m},M=function(f){const d=j.exec(f);return!(d===null||typeof d>"u")};re.isExist=function(f){return typeof f<"u"},re.isEmptyObject=function(f){return Object.keys(f).length===0},re.merge=function(f,d,m){if(d){const h=Object.keys(d),C=h.length;for(let A=0;A<C;A++)m==="strict"?f[h[A]]=[d[h[A]]]:f[h[A]]=d[h[A]]}},re.getValue=function(f){return re.isExist(f)?f:""},re.isName=M,re.getAllMatches=b,re.nameRegexp=s},"./node_modules/fast-xml-parser/src/validator.js":function(H,re,P){const F=P("./node_modules/fast-xml-parser/src/util.js"),O={allowBooleanAttributes:!1,unpairedTags:[]};re.validate=function(g,l){l=Object.assign({},O,l);const x=[];let n=!1,o=!1;g[0]==="\uFEFF"&&(g=g.substr(1));for(let t=0;t<g.length;t++)if(g[t]==="<"&&g[t+1]==="?"){if(t+=2,t=j(g,t),t.err)return t}else if(g[t]==="<"){let i=t;if(t++,g[t]==="!"){t=b(g,t);continue}else{let u=!1;g[t]==="/"&&(u=!0,t++);let y="";for(;t<g.length&&g[t]!==">"&&g[t]!==" "&&g[t]!=="	"&&g[t]!==`
`&&g[t]!=="\r";t++)y+=g[t];if(y=y.trim(),y[y.length-1]==="/"&&(y=y.substring(0,y.length-1),t--),!U(y)){let w;return y.trim().length===0?w="Invalid space after '<'.":w="Tag '"+y+"' is an invalid name.",R("InvalidTag",w,z(g,t))}const L=d(g,t);if(L===!1)return R("InvalidAttr","Attributes for '"+y+"' have open quote.",z(g,t));let k=L.value;if(t=L.index,k[k.length-1]==="/"){const w=t-k.length;k=k.substring(0,k.length-1);const $=h(k,l);if($===!0)n=!0;else return R($.err.code,$.err.msg,z(g,w+$.err.line))}else if(u)if(L.tagClosed){if(k.trim().length>0)return R("InvalidTag","Closing tag '"+y+"' can't have attributes or invalid starting.",z(g,i));if(x.length===0)return R("InvalidTag","Closing tag '"+y+"' has not been opened.",z(g,i));{const w=x.pop();if(y!==w.tagName){let $=z(g,w.tagStartPos);return R("InvalidTag","Expected closing tag '"+w.tagName+"' (opened in line "+$.line+", col "+$.col+") instead of closing tag '"+y+"'.",z(g,i))}x.length==0&&(o=!0)}}else return R("InvalidTag","Closing tag '"+y+"' doesn't have proper closing.",z(g,t));else{const w=h(k,l);if(w!==!0)return R(w.err.code,w.err.msg,z(g,t-k.length+w.err.line));if(o===!0)return R("InvalidXml","Multiple possible root nodes found.",z(g,t));l.unpairedTags.indexOf(y)!==-1||x.push({tagName:y,tagStartPos:i}),n=!0}for(t++;t<g.length;t++)if(g[t]==="<")if(g[t+1]==="!"){t++,t=b(g,t);continue}else if(g[t+1]==="?"){if(t=j(g,++t),t.err)return t}else break;else if(g[t]==="&"){const w=A(g,t);if(w==-1)return R("InvalidChar","char '&' is not expected.",z(g,t));t=w}else if(o===!0&&!s(g[t]))return R("InvalidXml","Extra text at the end",z(g,t));g[t]==="<"&&t--}}else{if(s(g[t]))continue;return R("InvalidChar","char '"+g[t]+"' is not expected.",z(g,t))}if(n){if(x.length==1)return R("InvalidTag","Unclosed tag '"+x[0].tagName+"'.",z(g,x[0].tagStartPos));if(x.length>0)return R("InvalidXml","Invalid '"+JSON.stringify(x.map(t=>t.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return R("InvalidXml","Start tag expected.",1);return!0};function s(g){return g===" "||g==="	"||g===`
`||g==="\r"}function j(g,l){const x=l;for(;l<g.length;l++)if(g[l]=="?"||g[l]==" "){const n=g.substr(x,l-x);if(l>5&&n==="xml")return R("InvalidXml","XML declaration allowed only at the start of the document.",z(g,l));if(g[l]=="?"&&g[l+1]==">"){l++;break}else continue}return l}function b(g,l){if(g.length>l+5&&g[l+1]==="-"&&g[l+2]==="-"){for(l+=3;l<g.length;l++)if(g[l]==="-"&&g[l+1]==="-"&&g[l+2]===">"){l+=2;break}}else if(g.length>l+8&&g[l+1]==="D"&&g[l+2]==="O"&&g[l+3]==="C"&&g[l+4]==="T"&&g[l+5]==="Y"&&g[l+6]==="P"&&g[l+7]==="E"){let x=1;for(l+=8;l<g.length;l++)if(g[l]==="<")x++;else if(g[l]===">"&&(x--,x===0))break}else if(g.length>l+9&&g[l+1]==="["&&g[l+2]==="C"&&g[l+3]==="D"&&g[l+4]==="A"&&g[l+5]==="T"&&g[l+6]==="A"&&g[l+7]==="["){for(l+=8;l<g.length;l++)if(g[l]==="]"&&g[l+1]==="]"&&g[l+2]===">"){l+=2;break}}return l}const M='"',f="'";function d(g,l){let x="",n="",o=!1;for(;l<g.length;l++){if(g[l]===M||g[l]===f)n===""?n=g[l]:n!==g[l]||(n="");else if(g[l]===">"&&n===""){o=!0;break}x+=g[l]}return n!==""?!1:{value:x,index:l,tagClosed:o}}const m=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function h(g,l){const x=F.getAllMatches(g,m),n={};for(let o=0;o<x.length;o++){if(x[o][1].length===0)return R("InvalidAttr","Attribute '"+x[o][2]+"' has no space in starting.",G(x[o]));if(x[o][3]!==void 0&&x[o][4]===void 0)return R("InvalidAttr","Attribute '"+x[o][2]+"' is without value.",G(x[o]));if(x[o][3]===void 0&&!l.allowBooleanAttributes)return R("InvalidAttr","boolean attribute '"+x[o][2]+"' is not allowed.",G(x[o]));const t=x[o][2];if(!N(t))return R("InvalidAttr","Attribute '"+t+"' is an invalid name.",G(x[o]));if(!n.hasOwnProperty(t))n[t]=1;else return R("InvalidAttr","Attribute '"+t+"' is repeated.",G(x[o]))}return!0}function C(g,l){let x=/\d/;for(g[l]==="x"&&(l++,x=/[\da-fA-F]/);l<g.length;l++){if(g[l]===";")return l;if(!g[l].match(x))break}return-1}function A(g,l){if(l++,g[l]===";")return-1;if(g[l]==="#")return l++,C(g,l);let x=0;for(;l<g.length;l++,x++)if(!(g[l].match(/\w/)&&x<20)){if(g[l]===";")break;return-1}return l}function R(g,l,x){return{err:{code:g,msg:l,line:x.line||x,col:x.col}}}function N(g){return F.isName(g)}function U(g){return F.isName(g)}function z(g,l){const x=g.substring(0,l).split(/\r?\n/);return{line:x.length,col:x[x.length-1].length+1}}function G(g){return g.startIndex+g[1].length}},"./node_modules/fast-xml-parser/src/xmlbuilder/json2xml.js":function(H,re,P){const F=P("./node_modules/fast-xml-parser/src/xmlbuilder/orderedJs2Xml.js"),O={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(f,d){return d},attributeValueProcessor:function(f,d){return d},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function s(f){this.options=Object.assign({},O,f),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=M),this.processTextOrObjNode=j,this.options.format?(this.indentate=b,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}s.prototype.build=function(f){return this.options.preserveOrder?F(f,this.options):(Array.isArray(f)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(f={[this.options.arrayNodeName]:f}),this.j2x(f,0).val)},s.prototype.j2x=function(f,d){let m="",h="";for(let C in f)if(Object.prototype.hasOwnProperty.call(f,C))if(typeof f[C]>"u")this.isAttribute(C)&&(h+="");else if(f[C]===null)this.isAttribute(C)?h+="":C[0]==="?"?h+=this.indentate(d)+"<"+C+"?"+this.tagEndChar:h+=this.indentate(d)+"<"+C+"/"+this.tagEndChar;else if(f[C]instanceof Date)h+=this.buildTextValNode(f[C],C,"",d);else if(typeof f[C]!="object"){const A=this.isAttribute(C);if(A)m+=this.buildAttrPairStr(A,""+f[C]);else if(C===this.options.textNodeName){let R=this.options.tagValueProcessor(C,""+f[C]);h+=this.replaceEntitiesValue(R)}else h+=this.buildTextValNode(f[C],C,"",d)}else if(Array.isArray(f[C])){const A=f[C].length;let R="";for(let N=0;N<A;N++){const U=f[C][N];typeof U>"u"||(U===null?C[0]==="?"?h+=this.indentate(d)+"<"+C+"?"+this.tagEndChar:h+=this.indentate(d)+"<"+C+"/"+this.tagEndChar:typeof U=="object"?this.options.oneListGroup?R+=this.j2x(U,d+1).val:R+=this.processTextOrObjNode(U,C,d):R+=this.buildTextValNode(U,C,"",d))}this.options.oneListGroup&&(R=this.buildObjectNode(R,C,"",d)),h+=R}else if(this.options.attributesGroupName&&C===this.options.attributesGroupName){const A=Object.keys(f[C]),R=A.length;for(let N=0;N<R;N++)m+=this.buildAttrPairStr(A[N],""+f[C][A[N]])}else h+=this.processTextOrObjNode(f[C],C,d);return{attrStr:m,val:h}},s.prototype.buildAttrPairStr=function(f,d){return d=this.options.attributeValueProcessor(f,""+d),d=this.replaceEntitiesValue(d),this.options.suppressBooleanAttributes&&d==="true"?" "+f:" "+f+'="'+d+'"'};function j(f,d,m){const h=this.j2x(f,m+1);return f[this.options.textNodeName]!==void 0&&Object.keys(f).length===1?this.buildTextValNode(f[this.options.textNodeName],d,h.attrStr,m):this.buildObjectNode(h.val,d,h.attrStr,m)}s.prototype.buildObjectNode=function(f,d,m,h){if(f==="")return d[0]==="?"?this.indentate(h)+"<"+d+m+"?"+this.tagEndChar:this.indentate(h)+"<"+d+m+this.closeTag(d)+this.tagEndChar;{let C="</"+d+this.tagEndChar,A="";return d[0]==="?"&&(A="?",C=""),(m||m==="")&&f.indexOf("<")===-1?this.indentate(h)+"<"+d+m+A+">"+f+C:this.options.commentPropName!==!1&&d===this.options.commentPropName&&A.length===0?this.indentate(h)+`<!--${f}-->`+this.newLine:this.indentate(h)+"<"+d+m+A+this.tagEndChar+f+this.indentate(h)+C}},s.prototype.closeTag=function(f){let d="";return this.options.unpairedTags.indexOf(f)!==-1?this.options.suppressUnpairedNode||(d="/"):this.options.suppressEmptyNode?d="/":d=`></${f}`,d},s.prototype.buildTextValNode=function(f,d,m,h){if(this.options.cdataPropName!==!1&&d===this.options.cdataPropName)return this.indentate(h)+`<![CDATA[${f}]]>`+this.newLine;if(this.options.commentPropName!==!1&&d===this.options.commentPropName)return this.indentate(h)+`<!--${f}-->`+this.newLine;if(d[0]==="?")return this.indentate(h)+"<"+d+m+"?"+this.tagEndChar;{let C=this.options.tagValueProcessor(d,f);return C=this.replaceEntitiesValue(C),C===""?this.indentate(h)+"<"+d+m+this.closeTag(d)+this.tagEndChar:this.indentate(h)+"<"+d+m+">"+C+"</"+d+this.tagEndChar}},s.prototype.replaceEntitiesValue=function(f){if(f&&f.length>0&&this.options.processEntities)for(let d=0;d<this.options.entities.length;d++){const m=this.options.entities[d];f=f.replace(m.regex,m.val)}return f};function b(f){return this.options.indentBy.repeat(f)}function M(f){return f.startsWith(this.options.attributeNamePrefix)&&f!==this.options.textNodeName?f.substr(this.attrPrefixLen):!1}H.exports=s},"./node_modules/fast-xml-parser/src/xmlbuilder/orderedJs2Xml.js":function(H,re){const P=`
`;function F(f,d){let m="";return d.format&&d.indentBy.length>0&&(m=P),O(f,d,"",m)}function O(f,d,m,h){let C="",A=!1;for(let R=0;R<f.length;R++){const N=f[R],U=s(N);if(U===void 0)continue;let z="";if(m.length===0?z=U:z=`${m}.${U}`,U===d.textNodeName){let n=N[U];b(z,d)||(n=d.tagValueProcessor(U,n),n=M(n,d)),A&&(C+=h),C+=n,A=!1;continue}else if(U===d.cdataPropName){A&&(C+=h),C+=`<![CDATA[${N[U][0][d.textNodeName]}]]>`,A=!1;continue}else if(U===d.commentPropName){C+=h+`<!--${N[U][0][d.textNodeName]}-->`,A=!0;continue}else if(U[0]==="?"){const n=j(N[":@"],d),o=U==="?xml"?"":h;let t=N[U][0][d.textNodeName];t=t.length!==0?" "+t:"",C+=o+`<${U}${t}${n}?>`,A=!0;continue}let G=h;G!==""&&(G+=d.indentBy);const g=j(N[":@"],d),l=h+`<${U}${g}`,x=O(N[U],d,z,G);d.unpairedTags.indexOf(U)!==-1?d.suppressUnpairedNode?C+=l+">":C+=l+"/>":(!x||x.length===0)&&d.suppressEmptyNode?C+=l+"/>":x&&x.endsWith(">")?C+=l+`>${x}${h}</${U}>`:(C+=l+">",x&&h!==""&&(x.includes("/>")||x.includes("</"))?C+=h+d.indentBy+x+h:C+=x,C+=`</${U}>`),A=!0}return C}function s(f){const d=Object.keys(f);for(let m=0;m<d.length;m++){const h=d[m];if(f.hasOwnProperty(h)&&h!==":@")return h}}function j(f,d){let m="";if(f&&!d.ignoreAttributes)for(let h in f){if(!f.hasOwnProperty(h))continue;let C=d.attributeValueProcessor(h,f[h]);C=M(C,d),C===!0&&d.suppressBooleanAttributes?m+=` ${h.substr(d.attributeNamePrefix.length)}`:m+=` ${h.substr(d.attributeNamePrefix.length)}="${C}"`}return m}function b(f,d){f=f.substr(0,f.length-d.textNodeName.length-1);let m=f.substr(f.lastIndexOf(".")+1);for(let h in d.stopNodes)if(d.stopNodes[h]===f||d.stopNodes[h]==="*."+m)return!0;return!1}function M(f,d){if(f&&f.length>0&&d.processEntities)for(let m=0;m<d.entities.length;m++){const h=d.entities[m];f=f.replace(h.regex,h.val)}return f}H.exports=F},"./node_modules/fast-xml-parser/src/xmlparser/DocTypeReader.js":function(H,re,P){const F=P("./node_modules/fast-xml-parser/src/util.js");function O(h,C){const A={};if(h[C+3]==="O"&&h[C+4]==="C"&&h[C+5]==="T"&&h[C+6]==="Y"&&h[C+7]==="P"&&h[C+8]==="E"){C=C+9;let R=1,N=!1,U=!1,z="";for(;C<h.length;C++)if(h[C]==="<"&&!U){if(N&&b(h,C))C+=7,[entityName,val,C]=s(h,C+1),val.indexOf("&")===-1&&(A[m(entityName)]={regx:RegExp(`&${entityName};`,"g"),val});else if(N&&M(h,C))C+=8;else if(N&&f(h,C))C+=8;else if(N&&d(h,C))C+=9;else if(j)U=!0;else throw new Error("Invalid DOCTYPE");R++,z=""}else if(h[C]===">"){if(U?h[C-1]==="-"&&h[C-2]==="-"&&(U=!1,R--):R--,R===0)break}else h[C]==="["?N=!0:z+=h[C];if(R!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:A,i:C}}function s(h,C){let A="";for(;C<h.length&&h[C]!=="'"&&h[C]!=='"';C++)A+=h[C];if(A=A.trim(),A.indexOf(" ")!==-1)throw new Error("External entites are not supported");const R=h[C++];let N="";for(;C<h.length&&h[C]!==R;C++)N+=h[C];return[A,N,C]}function j(h,C){return h[C+1]==="!"&&h[C+2]==="-"&&h[C+3]==="-"}function b(h,C){return h[C+1]==="!"&&h[C+2]==="E"&&h[C+3]==="N"&&h[C+4]==="T"&&h[C+5]==="I"&&h[C+6]==="T"&&h[C+7]==="Y"}function M(h,C){return h[C+1]==="!"&&h[C+2]==="E"&&h[C+3]==="L"&&h[C+4]==="E"&&h[C+5]==="M"&&h[C+6]==="E"&&h[C+7]==="N"&&h[C+8]==="T"}function f(h,C){return h[C+1]==="!"&&h[C+2]==="A"&&h[C+3]==="T"&&h[C+4]==="T"&&h[C+5]==="L"&&h[C+6]==="I"&&h[C+7]==="S"&&h[C+8]==="T"}function d(h,C){return h[C+1]==="!"&&h[C+2]==="N"&&h[C+3]==="O"&&h[C+4]==="T"&&h[C+5]==="A"&&h[C+6]==="T"&&h[C+7]==="I"&&h[C+8]==="O"&&h[C+9]==="N"}function m(h){if(F.isName(h))return h;throw new Error(`Invalid entity name ${h}`)}H.exports=O},"./node_modules/fast-xml-parser/src/xmlparser/OptionsBuilder.js":function(H,re){const P={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(O,s){return s},attributeValueProcessor:function(O,s){return s},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(O,s,j){return O}},F=function(O){return Object.assign({},P,O)};re.buildOptions=F,re.defaultOptions=P},"./node_modules/fast-xml-parser/src/xmlparser/OrderedObjParser.js":function(H,re,P){const F=P("./node_modules/fast-xml-parser/src/util.js"),O=P("./node_modules/fast-xml-parser/src/xmlparser/xmlNode.js"),s=P("./node_modules/fast-xml-parser/src/xmlparser/DocTypeReader.js"),j=P("./node_modules/strnum/strnum.js");class b{constructor(o){this.options=o,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"¢"},pound:{regex:/&(pound|#163);/g,val:"£"},yen:{regex:/&(yen|#165);/g,val:"¥"},euro:{regex:/&(euro|#8364);/g,val:"€"},copyright:{regex:/&(copy|#169);/g,val:"©"},reg:{regex:/&(reg|#174);/g,val:"®"},inr:{regex:/&(inr|#8377);/g,val:"₹"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(t,i)=>String.fromCharCode(Number.parseInt(i,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(t,i)=>String.fromCharCode(Number.parseInt(i,16))}},this.addExternalEntities=M,this.parseXml=C,this.parseTextData=f,this.resolveNameSpace=d,this.buildAttributesMap=h,this.isItStopNode=U,this.replaceEntitiesValue=R,this.readStopNodeData=l,this.saveTextToParentTag=N,this.addChild=A}}function M(n){const o=Object.keys(n);for(let t=0;t<o.length;t++){const i=o[t];this.lastEntities[i]={regex:new RegExp("&"+i+";","g"),val:n[i]}}}function f(n,o,t,i,u,y,L){if(n!==void 0&&(this.options.trimValues&&!i&&(n=n.trim()),n.length>0)){L||(n=this.replaceEntitiesValue(n));const k=this.options.tagValueProcessor(o,n,t,u,y);return k==null?n:typeof k!=typeof n||k!==n?k:this.options.trimValues?x(n,this.options.parseTagValue,this.options.numberParseOptions):n.trim()===n?x(n,this.options.parseTagValue,this.options.numberParseOptions):n}}function d(n){if(this.options.removeNSPrefix){const o=n.split(":"),t=n.charAt(0)==="/"?"/":"";if(o[0]==="xmlns")return"";o.length===2&&(n=t+o[1])}return n}const m=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function h(n,o,t){if(!this.options.ignoreAttributes&&typeof n=="string"){const i=F.getAllMatches(n,m),u=i.length,y={};for(let L=0;L<u;L++){const k=this.resolveNameSpace(i[L][1]);let w=i[L][4],$=this.options.attributeNamePrefix+k;if(k.length)if(this.options.transformAttributeName&&($=this.options.transformAttributeName($)),$==="__proto__"&&($="#__proto__"),w!==void 0){this.options.trimValues&&(w=w.trim()),w=this.replaceEntitiesValue(w);const D=this.options.attributeValueProcessor(k,w,o);D==null?y[$]=w:typeof D!=typeof w||D!==w?y[$]=D:y[$]=x(w,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(y[$]=!0)}if(!Object.keys(y).length)return;if(this.options.attributesGroupName){const L={};return L[this.options.attributesGroupName]=y,L}return y}}const C=function(n){n=n.replace(/\r\n?/g,`
`);const o=new O("!xml");let t=o,i="",u="";for(let y=0;y<n.length;y++)if(n[y]==="<")if(n[y+1]==="/"){const k=G(n,">",y,"Closing Tag is not closed.");let w=n.substring(y+2,k).trim();if(this.options.removeNSPrefix){const se=w.indexOf(":");se!==-1&&(w=w.substr(se+1))}this.options.transformTagName&&(w=this.options.transformTagName(w)),t&&(i=this.saveTextToParentTag(i,t,u));const $=u.substring(u.lastIndexOf(".")+1);if(w&&this.options.unpairedTags.indexOf(w)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${w}>`);let D=0;$&&this.options.unpairedTags.indexOf($)!==-1?(D=u.lastIndexOf(".",u.lastIndexOf(".")-1),this.tagsNodeStack.pop()):D=u.lastIndexOf("."),u=u.substring(0,D),t=this.tagsNodeStack.pop(),i="",y=k}else if(n[y+1]==="?"){let k=g(n,y,!1,"?>");if(!k)throw new Error("Pi Tag is not closed.");if(i=this.saveTextToParentTag(i,t,u),!(this.options.ignoreDeclaration&&k.tagName==="?xml"||this.options.ignorePiTags)){const w=new O(k.tagName);w.add(this.options.textNodeName,""),k.tagName!==k.tagExp&&k.attrExpPresent&&(w[":@"]=this.buildAttributesMap(k.tagExp,u,k.tagName)),this.addChild(t,w,u)}y=k.closeIndex+1}else if(n.substr(y+1,3)==="!--"){const k=G(n,"-->",y+4,"Comment is not closed.");if(this.options.commentPropName){const w=n.substring(y+4,k-2);i=this.saveTextToParentTag(i,t,u),t.add(this.options.commentPropName,[{[this.options.textNodeName]:w}])}y=k}else if(n.substr(y+1,2)==="!D"){const k=s(n,y);this.docTypeEntities=k.entities,y=k.i}else if(n.substr(y+1,2)==="!["){const k=G(n,"]]>",y,"CDATA is not closed.")-2,w=n.substring(y+9,k);i=this.saveTextToParentTag(i,t,u);let $=this.parseTextData(w,t.tagname,u,!0,!1,!0,!0);$==null&&($=""),this.options.cdataPropName?t.add(this.options.cdataPropName,[{[this.options.textNodeName]:w}]):t.add(this.options.textNodeName,$),y=k+2}else{let k=g(n,y,this.options.removeNSPrefix),w=k.tagName;const $=k.rawTagName;let D=k.tagExp,se=k.attrExpPresent,oe=k.closeIndex;this.options.transformTagName&&(w=this.options.transformTagName(w)),t&&i&&t.tagname!=="!xml"&&(i=this.saveTextToParentTag(i,t,u,!1));const Y=t;if(Y&&this.options.unpairedTags.indexOf(Y.tagname)!==-1&&(t=this.tagsNodeStack.pop(),u=u.substring(0,u.lastIndexOf("."))),w!==o.tagname&&(u+=u?"."+w:w),this.isItStopNode(this.options.stopNodes,u,w)){let ae="";if(D.length>0&&D.lastIndexOf("/")===D.length-1)w[w.length-1]==="/"?(w=w.substr(0,w.length-1),u=u.substr(0,u.length-1),D=w):D=D.substr(0,D.length-1),y=k.closeIndex;else if(this.options.unpairedTags.indexOf(w)!==-1)y=k.closeIndex;else{const ie=this.readStopNodeData(n,$,oe+1);if(!ie)throw new Error(`Unexpected end of ${$}`);y=ie.i,ae=ie.tagContent}const fe=new O(w);w!==D&&se&&(fe[":@"]=this.buildAttributesMap(D,u,w)),ae&&(ae=this.parseTextData(ae,w,u,!0,se,!0,!0)),u=u.substr(0,u.lastIndexOf(".")),fe.add(this.options.textNodeName,ae),this.addChild(t,fe,u)}else{if(D.length>0&&D.lastIndexOf("/")===D.length-1){w[w.length-1]==="/"?(w=w.substr(0,w.length-1),u=u.substr(0,u.length-1),D=w):D=D.substr(0,D.length-1),this.options.transformTagName&&(w=this.options.transformTagName(w));const ae=new O(w);w!==D&&se&&(ae[":@"]=this.buildAttributesMap(D,u,w)),this.addChild(t,ae,u),u=u.substr(0,u.lastIndexOf("."))}else{const ae=new O(w);this.tagsNodeStack.push(t),w!==D&&se&&(ae[":@"]=this.buildAttributesMap(D,u,w)),this.addChild(t,ae,u),t=ae}i="",y=oe}}else i+=n[y];return o.child};function A(n,o,t){const i=this.options.updateTag(o.tagname,t,o[":@"]);i===!1||(typeof i=="string"&&(o.tagname=i),n.addChild(o))}const R=function(n){if(this.options.processEntities){for(let o in this.docTypeEntities){const t=this.docTypeEntities[o];n=n.replace(t.regx,t.val)}for(let o in this.lastEntities){const t=this.lastEntities[o];n=n.replace(t.regex,t.val)}if(this.options.htmlEntities)for(let o in this.htmlEntities){const t=this.htmlEntities[o];n=n.replace(t.regex,t.val)}n=n.replace(this.ampEntity.regex,this.ampEntity.val)}return n};function N(n,o,t,i){return n&&(i===void 0&&(i=Object.keys(o.child).length===0),n=this.parseTextData(n,o.tagname,t,!1,o[":@"]?Object.keys(o[":@"]).length!==0:!1,i),n!==void 0&&n!==""&&o.add(this.options.textNodeName,n),n=""),n}function U(n,o,t){const i="*."+t;for(const u in n){const y=n[u];if(i===y||o===y)return!0}return!1}function z(n,o,t=">"){let i,u="";for(let y=o;y<n.length;y++){let L=n[y];if(i)L===i&&(i="");else if(L==='"'||L==="'")i=L;else if(L===t[0])if(t[1]){if(n[y+1]===t[1])return{data:u,index:y}}else return{data:u,index:y};else L==="	"&&(L=" ");u+=L}}function G(n,o,t,i){const u=n.indexOf(o,t);if(u===-1)throw new Error(i);return u+o.length-1}function g(n,o,t,i=">"){const u=z(n,o+1,i);if(!u)return;let y=u.data;const L=u.index,k=y.search(/\s/);let w=y,$=!0;k!==-1&&(w=y.substring(0,k),y=y.substring(k+1).trimStart());const D=w;if(t){const se=w.indexOf(":");se!==-1&&(w=w.substr(se+1),$=w!==u.data.substr(se+1))}return{tagName:w,tagExp:y,closeIndex:L,attrExpPresent:$,rawTagName:D}}function l(n,o,t){const i=t;let u=1;for(;t<n.length;t++)if(n[t]==="<")if(n[t+1]==="/"){const y=G(n,">",t,`${o} is not closed`);if(n.substring(t+2,y).trim()===o&&(u--,u===0))return{tagContent:n.substring(i,t),i:y};t=y}else if(n[t+1]==="?")t=G(n,"?>",t+1,"StopNode is not closed.");else if(n.substr(t+1,3)==="!--")t=G(n,"-->",t+3,"StopNode is not closed.");else if(n.substr(t+1,2)==="![")t=G(n,"]]>",t,"StopNode is not closed.")-2;else{const y=g(n,t,">");y&&((y&&y.tagName)===o&&y.tagExp[y.tagExp.length-1]!=="/"&&u++,t=y.closeIndex)}}function x(n,o,t){if(o&&typeof n=="string"){const i=n.trim();return i==="true"?!0:i==="false"?!1:j(n,t)}else return F.isExist(n)?n:""}H.exports=b},"./node_modules/fast-xml-parser/src/xmlparser/XMLParser.js":function(H,re,P){const{buildOptions:F}=P("./node_modules/fast-xml-parser/src/xmlparser/OptionsBuilder.js"),O=P("./node_modules/fast-xml-parser/src/xmlparser/OrderedObjParser.js"),{prettify:s}=P("./node_modules/fast-xml-parser/src/xmlparser/node2json.js"),j=P("./node_modules/fast-xml-parser/src/validator.js");class b{constructor(f){this.externalEntities={},this.options=F(f)}parse(f,d){if(typeof f!="string")if(f.toString)f=f.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(d){d===!0&&(d={});const C=j.validate(f,d);if(C!==!0)throw Error(`${C.err.msg}:${C.err.line}:${C.err.col}`)}const m=new O(this.options);m.addExternalEntities(this.externalEntities);const h=m.parseXml(f);return this.options.preserveOrder||h===void 0?h:s(h,this.options)}addEntity(f,d){if(d.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(f.indexOf("&")!==-1||f.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(d==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[f]=d}}H.exports=b},"./node_modules/fast-xml-parser/src/xmlparser/node2json.js":function(H,re,P){function F(M,f){return O(M,f)}function O(M,f,d){let m;const h={};for(let C=0;C<M.length;C++){const A=M[C],R=s(A);let N="";if(d===void 0?N=R:N=d+"."+R,R===f.textNodeName)m===void 0?m=A[R]:m+=""+A[R];else{if(R===void 0)continue;if(A[R]){let U=O(A[R],f,N);const z=b(U,f);A[":@"]?j(U,A[":@"],N,f):Object.keys(U).length===1&&U[f.textNodeName]!==void 0&&!f.alwaysCreateTextNode?U=U[f.textNodeName]:Object.keys(U).length===0&&(f.alwaysCreateTextNode?U[f.textNodeName]="":U=""),h[R]!==void 0&&h.hasOwnProperty(R)?(Array.isArray(h[R])||(h[R]=[h[R]]),h[R].push(U)):f.isArray(R,N,z)?h[R]=[U]:h[R]=U}}}return typeof m=="string"?m.length>0&&(h[f.textNodeName]=m):m!==void 0&&(h[f.textNodeName]=m),h}function s(M){const f=Object.keys(M);for(let d=0;d<f.length;d++){const m=f[d];if(m!==":@")return m}}function j(M,f,d,m){if(f){const h=Object.keys(f),C=h.length;for(let A=0;A<C;A++){const R=h[A];m.isArray(R,d+"."+R,!0,!0)?M[R]=[f[R]]:M[R]=f[R]}}}function b(M,f){const{textNodeName:d}=f,m=Object.keys(M).length;return!!(m===0||m===1&&(M[d]||typeof M[d]=="boolean"||M[d]===0))}re.prettify=F},"./node_modules/fast-xml-parser/src/xmlparser/xmlNode.js":function(H,re,P){class F{constructor(s){this.tagname=s,this.child=[],this[":@"]={}}add(s,j){s==="__proto__"&&(s="#__proto__"),this.child.push({[s]:j})}addChild(s){s.tagname==="__proto__"&&(s.tagname="#__proto__"),s[":@"]&&Object.keys(s[":@"]).length>0?this.child.push({[s.tagname]:s.child,":@":s[":@"]}):this.child.push({[s.tagname]:s.child})}}H.exports=F},"./node_modules/process/browser.js":function(H,re){var P=H.exports={},F,O;function s(){throw new Error("setTimeout has not been defined")}function j(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?F=setTimeout:F=s}catch{F=s}try{typeof clearTimeout=="function"?O=clearTimeout:O=j}catch{O=j}})();function b(U){if(F===setTimeout)return setTimeout(U,0);if((F===s||!F)&&setTimeout)return F=setTimeout,setTimeout(U,0);try{return F(U,0)}catch{try{return F.call(null,U,0)}catch{return F.call(this,U,0)}}}function M(U){if(O===clearTimeout)return clearTimeout(U);if((O===j||!O)&&clearTimeout)return O=clearTimeout,clearTimeout(U);try{return O(U)}catch{try{return O.call(null,U)}catch{return O.call(this,U)}}}var f=[],d=!1,m,h=-1;function C(){!d||!m||(d=!1,m.length?f=m.concat(f):h=-1,f.length&&A())}function A(){if(!d){var U=b(C);d=!0;for(var z=f.length;z;){for(m=f,f=[];++h<z;)m&&m[h].run();h=-1,z=f.length}m=null,d=!1,M(U)}}P.nextTick=function(U){var z=new Array(arguments.length-1);if(arguments.length>1)for(var G=1;G<arguments.length;G++)z[G-1]=arguments[G];f.push(new R(U,z)),f.length===1&&!d&&b(A)};function R(U,z){this.fun=U,this.array=z}R.prototype.run=function(){this.fun.apply(null,this.array)},P.title="browser",P.browser=!0,P.env={},P.argv=[],P.version="",P.versions={};function N(){}P.on=N,P.addListener=N,P.once=N,P.off=N,P.removeListener=N,P.removeAllListeners=N,P.emit=N,P.prependListener=N,P.prependOnceListener=N,P.listeners=function(U){return[]},P.binding=function(U){throw new Error("process.binding is not supported")},P.cwd=function(){return"/"},P.chdir=function(U){throw new Error("process.chdir is not supported")},P.umask=function(){return 0}},"./node_modules/strnum/strnum.js":function(H,re){const P=/^[-+]?0x[a-fA-F0-9]+$/,F=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const O={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function s(b,M={}){if(M=Object.assign({},O,M),!b||typeof b!="string")return b;let f=b.trim();if(M.skipLike!==void 0&&M.skipLike.test(f))return b;if(M.hex&&P.test(f))return Number.parseInt(f,16);{const d=F.exec(f);if(d){const m=d[1],h=d[2];let C=j(d[3]);const A=d[4]||d[6];if(!M.leadingZeros&&h.length>0&&m&&f[2]!==".")return b;if(!M.leadingZeros&&h.length>0&&!m&&f[1]!==".")return b;{const R=Number(f),N=""+R;return N.search(/[eE]/)!==-1||A?M.eNotation?R:b:f.indexOf(".")!==-1?N==="0"&&C===""||N===C||m&&N==="-"+C?R:b:h?C===N||m+C===N?R:b:f===N||f===m+N?R:b}}else return b}}function j(b){return b&&b.indexOf(".")!==-1&&(b=b.replace(/0+$/,""),b==="."?b="0":b[0]==="."?b="0"+b:b[b.length-1]==="."&&(b=b.substr(0,b.length-1))),b}H.exports=s},"./node_modules/webpack/buildin/amd-options.js":function(H,re){(function(P){H.exports=P}).call(this,{})},"./node_modules/webpack/buildin/module.js":function(H,re){H.exports=function(P){return P.webpackPolyfill||(P.deprecate=function(){},P.paths=[],P.children||(P.children=[]),Object.defineProperty(P,"loaded",{enumerable:!0,get:function(){return P.l}}),Object.defineProperty(P,"id",{enumerable:!0,get:function(){return P.i}}),P.webpackPolyfill=1),P}},"./package.json":function(H){H.exports=JSON.parse('{"name":"cos-js-sdk-v5","version":"1.8.6","description":"JavaScript SDK for [腾讯云对象存储](https://cloud.tencent.com/product/cos)","main":"dist/cos-js-sdk-v5.js","types":"index.d.ts","scripts":{"prettier":"prettier --write src demo/demo.js demo/CIDemos/*.js test/test.js server/sts.js lib/request.js index.d.ts","server":"node server/sts.js","dev":"cross-env NODE_ENV=development webpack -w --mode=development","build":"cross-env NODE_ENV=production webpack --mode=production","cos-auth.min.js":"uglifyjs ./demo/common/cos-auth.js -o ./demo/common/cos-auth.min.js -c -m","test":"jest --runInBand --coverage"},"repository":{"type":"git","url":"git+https://github.com/tencentyun/cos-js-sdk-v5.git"},"keywords":[],"author":"carsonxu","license":"ISC","bugs":{"url":"https://github.com/tencentyun/cos-js-sdk-v5/issues"},"homepage":"https://github.com/tencentyun/cos-js-sdk-v5#readme","dependencies":{"fast-xml-parser":"^4.4.0"},"devDependencies":{"@babel/core":"7.17.9","@babel/plugin-transform-runtime":"7.18.10","@babel/preset-env":"7.16.11","babel-loader":"8.2.5","body-parser":"^1.18.3","cross-env":"^5.2.0","express":"^4.16.4","jest":"^29.3.1","jest-environment-jsdom":"^29.3.1","prettier":"^3.0.1","qcloud-cos-sts":"^3.0.2","request":"^2.87.0","terser-webpack-plugin":"4.2.3","uglifyjs":"^2.4.11","webpack":"4.46.0","webpack-cli":"4.10.0"}}')},"./src/advance.js":function(H,re,P){var F=P("./node_modules/@babel/runtime/helpers/typeof.js"),O=P("./src/session.js"),s=P("./src/async.js"),j=P("./src/event.js").EventProxy,b=P("./src/util.js"),M=P("./src/tracker.js");function f(n,o){var t=this,i=new j,u=n.TaskId,y=n.Bucket,L=n.Region,k=n.Key,w=n.Body,$=n.ChunkSize||n.SliceSize||t.options.ChunkSize,D=n.AsyncLimit,se=n.StorageClass,oe=n.ServerSideEncryption,Y,ae,fe=n.onHashProgress,ie=n.tracker;ie&&ie.setParams({chunkSize:$}),i.on("error",function(J){if(t._isRunningTask(u))return n.UploadData.UploadId&&O.removeUsing(n.UploadData.UploadId),J.UploadId=n.UploadData.UploadId||"",o(J)}),i.on("upload_complete",function(J){var V=b.extend({UploadId:n.UploadData.UploadId||""},J);o(null,V)}),i.on("upload_slice_complete",function(J){var V={};b.each(n.Headers,function(Z,de){var ce=de.toLowerCase();(ce.indexOf("x-cos-meta-")===0||["pic-operations","x-cos-callback","x-cos-callback-var","x-cos-return-body"].includes(ce))&&(V[de]=Z)}),R.call(t,{Bucket:y,Region:L,Key:k,UploadId:J.UploadId,SliceList:J.SliceList,Headers:V,tracker:ie},function(Z,de){if(t._isRunningTask(u)){if(O.removeUsing(J.UploadId),Z)return ae(null,!0),i.emit("error",Z);O.removeUploadId.call(t,J.UploadId),ae({loaded:Y,total:Y},!0),i.emit("upload_complete",de)}})}),i.on("get_upload_data_finish",function(J){var V=O.getFileId(w,n.ChunkSize,y,k);V&&O.saveUploadId.call(t,V,J.UploadId,t.options.UploadIdCacheLimit),O.setUsing(J.UploadId),ae(null,!0),C.call(t,{TaskId:u,Bucket:y,Region:L,Key:k,Body:w,FileSize:Y,SliceSize:$,AsyncLimit:D,ServerSideEncryption:oe,UploadData:J,Headers:n.Headers,onProgress:ae,tracker:ie},function(Z,de){if(t._isRunningTask(u)){if(Z)return ae(null,!0),i.emit("error",Z);i.emit("upload_slice_complete",de)}})}),i.on("get_file_size_finish",function(){if(ae=b.throttleOnProgress.call(t,Y,n.onProgress),n.UploadData.UploadId)i.emit("get_upload_data_finish",n.UploadData);else{var J=b.extend({TaskId:u,Bucket:y,Region:L,Key:k,Headers:n.Headers,StorageClass:se,Body:w,FileSize:Y,SliceSize:$,onHashProgress:fe,tracker:ie},n);d.call(t,J,function(V,Z){if(t._isRunningTask(u)){if(V)return i.emit("error",V);n.UploadData.UploadId=Z.UploadId,n.UploadData.PartList=Z.PartList,i.emit("get_upload_data_finish",n.UploadData)}})}}),Y=n.ContentLength,delete n.ContentLength,!n.Headers&&(n.Headers={}),b.each(n.Headers,function(J,V){V.toLowerCase()==="content-length"&&delete n.Headers[V]}),function(){for(var J=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,5120],V=1024*1024,Z=0;Z<J.length&&(V=J[Z]*1024*1024,!(Y/V<=t.options.MaxPartNumber));Z++);n.ChunkSize=n.SliceSize=$=Math.max($,V)}(),Y===0?(n.Body="",n.ContentLength=0,n.SkipTask=!0,t.putObject(n,o)):i.emit("get_file_size_finish")}function d(n,o){var t=n.TaskId,i=n.Bucket,u=n.Region,y=n.Key,L=n.StorageClass,k=this,w={},$=n.FileSize,D=n.SliceSize,se=Math.ceil($/D),oe=0,Y=b.throttleOnProgress.call(k,$,n.onHashProgress),ae=function(V,Z){var de=D*(V-1),ce=Math.min(de+D,$),te=ce-de;w[V]?Z(null,{PartNumber:V,ETag:w[V],Size:te}):b.fileSlice(n.Body,de,ce,!1,function(ne){b.getFileMd5(ne,function(ye,ge){if(ye)return Z(b.error(ye));var ke='"'+ge+'"';w[V]=ke,oe+=te,Y({loaded:oe,total:$}),Z(null,{PartNumber:V,ETag:ke,Size:te})})})},fe=function(V,Z){var de=V.length;if(de===0)return Z(null,!0);if(de>se)return Z(null,!1);if(de>1){var ce=Math.max(V[0].Size,V[1].Size);if(ce!==D)return Z(null,!1)}var te=function ne(ye){if(ye<de){var ge=V[ye];ae(ge.PartNumber,function(ke,me){me&&me.ETag===ge.ETag&&me.Size===ge.Size?ne(ye+1):Z(null,!1)})}else Z(null,!0)};te(0)},ie=new j;ie.on("error",function(J){if(k._isRunningTask(t))return o(J)}),ie.on("upload_id_available",function(J){var V={},Z=[];b.each(J.PartList,function(te){V[te.PartNumber]=te});for(var de=1;de<=se;de++){var ce=V[de];ce?(ce.PartNumber=de,ce.Uploaded=!0):ce={PartNumber:de,ETag:null,Uploaded:!1},Z.push(ce)}J.PartList=Z,o(null,J)}),ie.on("no_available_upload_id",function(){if(k._isRunningTask(t)){var J=b.extend({Bucket:i,Region:u,Key:y,Query:b.clone(n.Query),StorageClass:L,Body:n.Body,calledBySdk:"sliceUploadFile",tracker:n.tracker},n),V=b.clone(n.Headers);delete V["x-cos-mime-limit"],J.Headers=V,k.multipartInit(J,function(Z,de){if(k._isRunningTask(t)){if(Z)return ie.emit("error",Z);var ce=de.UploadId;if(!ce)return o(b.error(new Error("no such upload id")));ie.emit("upload_id_available",{UploadId:ce,PartList:[]})}})}}),ie.on("has_and_check_upload_id",function(J){J=J.reverse(),s.eachLimit(J,1,function(V,Z){if(k._isRunningTask(t)){if(O.using[V]){Z();return}h.call(k,{Bucket:i,Region:u,Key:y,UploadId:V,tracker:n.tracker},function(de,ce){if(k._isRunningTask(t)){if(de)return O.removeUsing(V),ie.emit("error",de);var te=ce.PartList;te.forEach(function(ne){ne.PartNumber*=1,ne.Size*=1,ne.ETag=ne.ETag||""}),fe(te,function(ne,ye){if(k._isRunningTask(t)){if(ne)return ie.emit("error",ne);ye?Z({UploadId:V,PartList:te}):Z()}})}})}},function(V){k._isRunningTask(t)&&(Y(null,!0),V&&V.UploadId?ie.emit("upload_id_available",V):ie.emit("no_available_upload_id"))})}),ie.on("seek_local_avail_upload_id",function(J){var V=O.getFileId(n.Body,n.ChunkSize,i,y),Z=O.getUploadIdList.call(k,V);if(!V||!Z){ie.emit("has_and_check_upload_id",J);return}var de=function ce(te){if(te>=Z.length){ie.emit("has_and_check_upload_id",J);return}var ne=Z[te];if(!b.isInArray(J,ne)){O.removeUploadId.call(k,ne),ce(te+1);return}if(O.using[ne]){ce(te+1);return}h.call(k,{Bucket:i,Region:u,Key:y,UploadId:ne,tracker:n.tracker},function(ye,ge){k._isRunningTask(t)&&(ye?(O.removeUploadId.call(k,ne),ce(te+1)):ie.emit("upload_id_available",{UploadId:ne,PartList:ge.PartList}))})};de(0)}),ie.on("get_remote_upload_id_list",function(){m.call(k,{Bucket:i,Region:u,Key:y,tracker:n.tracker},function(J,V){if(k._isRunningTask(t)){if(J)return ie.emit("error",J);var Z=b.filter(V.UploadList,function(te){return te.Key===y&&(!L||te.StorageClass.toUpperCase()===L.toUpperCase())}).reverse().map(function(te){return te.UploadId||te.UploadID});if(Z.length)ie.emit("seek_local_avail_upload_id",Z);else{var de=O.getFileId(n.Body,n.ChunkSize,i,y),ce;de&&(ce=O.getUploadIdList.call(k,de))&&b.each(ce,function(te){O.removeUploadId.call(k,te)}),ie.emit("no_available_upload_id")}}})}),ie.emit("get_remote_upload_id_list")}function m(n,o){var t=this,i=[],u={Bucket:n.Bucket,Region:n.Region,Prefix:n.Key,calledBySdk:n.calledBySdk||"sliceUploadFile",tracker:n.tracker},y=function L(){t.multipartList(u,function(k,w){if(k)return o(k);i.push.apply(i,w.Upload||[]),w.IsTruncated==="true"?(u.KeyMarker=w.NextKeyMarker,u.UploadIdMarker=w.NextUploadIdMarker,L()):o(null,{UploadList:i})})};y()}function h(n,o){var t=this,i=[],u={Bucket:n.Bucket,Region:n.Region,Key:n.Key,UploadId:n.UploadId,calledBySdk:"sliceUploadFile",tracker:n.tracker},y=function L(){t.multipartListPart(u,function(k,w){if(k)return o(k);i.push.apply(i,w.Part||[]),w.IsTruncated==="true"?(u.PartNumberMarker=w.NextPartNumberMarker,L()):o(null,{PartList:i})})};y()}function C(n,o){var t=this,i=n.TaskId,u=n.Bucket,y=n.Region,L=n.Key,k=n.UploadData,w=n.FileSize,$=n.SliceSize,D=Math.min(n.AsyncLimit||t.options.ChunkParallelLimit||1,256),se=n.Body,oe=Math.ceil(w/$),Y=0,ae=n.ServerSideEncryption,fe=n.Headers,ie=b.filter(k.PartList,function(V){return V.Uploaded&&(Y+=V.PartNumber>=oe&&w%$||$),!V.Uploaded}),J=n.onProgress;s.eachLimit(ie,D,function(V,Z){if(t._isRunningTask(i)){var de=V.PartNumber,ce=Math.min(w,V.PartNumber*$)-(V.PartNumber-1)*$,te=0;A.call(t,{TaskId:i,Bucket:u,Region:y,Key:L,SliceSize:$,FileSize:w,PartNumber:de,ServerSideEncryption:ae,Body:se,UploadData:k,Headers:fe,onProgress:function(ye){Y+=ye.loaded-te,te=ye.loaded,J({loaded:Y,total:w})},tracker:n.tracker},function(ne,ye){t._isRunningTask(i)&&(!ne&&!ye.ETag&&(ne='get ETag error, please add "ETag" to CORS ExposeHeader setting.( 获取ETag失败，请在CORS ExposeHeader设置中添加ETag，请参考文档：https://cloud.tencent.com/document/product/436/13318 )'),ne?Y-=te:(Y+=ce-te,V.ETag=ye.ETag),J({loaded:Y,total:w}),Z(ne||null,ye))})}},function(V){if(t._isRunningTask(i)){if(V)return o(V);o(null,{UploadId:k.UploadId,SliceList:k.PartList})}})}function A(n,o){var t=this,i=n.TaskId,u=n.Bucket,y=n.Region,L=n.Key,k=n.FileSize,w=n.Body,$=n.PartNumber*1,D=n.SliceSize,se=n.ServerSideEncryption,oe=n.UploadData,Y=n.Headers||{},ae=t.options.ChunkRetryTimes+1,fe=D*($-1),ie=D,J=fe+D;J>k&&(J=k,ie=J-fe);var V=["x-cos-traffic-limit","x-cos-mime-limit"],Z={};b.each(Y,function(ce,te){V.indexOf(te)>-1&&(Z[te]=ce)});var de=oe.PartList[$-1];s.retry(ae,function(ce){t._isRunningTask(i)&&b.fileSlice(w,fe,J,!0,function(te){t.multipartUpload({TaskId:i,Bucket:u,Region:y,Key:L,ContentLength:ie,PartNumber:$,UploadId:oe.UploadId,ServerSideEncryption:se,Body:te,Headers:Z,onProgress:n.onProgress,calledBySdk:"sliceUploadFile",tracker:n.tracker},function(ne,ye){if(t._isRunningTask(i))return ne?ce(ne):(de.Uploaded=!0,ce(null,ye))})})},function(ce,te){if(t._isRunningTask(i))return o(ce,te)})}function R(n,o){var t=n.Bucket,i=n.Region,u=n.Key,y=n.UploadId,L=n.SliceList,k=this,w=this.options.ChunkRetryTimes+1,$=n.Headers,D=L.map(function(se){return{PartNumber:se.PartNumber,ETag:se.ETag}});s.retry(w,function(se){k.multipartComplete({Bucket:t,Region:i,Key:u,UploadId:y,Parts:D,Headers:$,calledBySdk:"sliceUploadFile",tracker:n.tracker},se)},function(se,oe){o(se,oe)})}function N(n,o){var t=n.Bucket,i=n.Region,u=n.Key,y=n.UploadId,L=n.Level||"task",k=n.AsyncLimit,w=this,$=new j;if($.on("error",function(D){return o(D)}),$.on("get_abort_array",function(D){U.call(w,{Bucket:t,Region:i,Key:u,Headers:n.Headers,AsyncLimit:k,AbortArray:D},o)}),L==="bucket")m.call(w,{Bucket:t,Region:i,calledBySdk:"abortUploadTask"},function(D,se){if(D)return o(D);$.emit("get_abort_array",se.UploadList||[])});else if(L==="file"){if(!u)return o(b.error(new Error("abort_upload_task_no_key")));m.call(w,{Bucket:t,Region:i,Key:u,calledBySdk:"abortUploadTask"},function(D,se){if(D)return o(D);$.emit("get_abort_array",se.UploadList||[])})}else if(L==="task"){if(!y)return o(b.error(new Error("abort_upload_task_no_id")));if(!u)return o(b.error(new Error("abort_upload_task_no_key")));$.emit("get_abort_array",[{Key:u,UploadId:y}])}else return o(b.error(new Error("abort_unknown_level")))}function U(n,o){var t=n.Bucket,i=n.Region,u=n.Key,y=n.AbortArray,L=n.AsyncLimit||1,k=this,w=0,$=new Array(y.length);s.eachLimit(y,L,function(D,se){var oe=w;if(u&&u!==D.Key){$[oe]={error:{KeyNotMatch:!0}},se(null);return}var Y=D.UploadId||D.UploadID;k.multipartAbort({Bucket:t,Region:i,Key:D.Key,Headers:n.Headers,UploadId:Y},function(ae){var fe={Bucket:t,Region:i,Key:D.Key,UploadId:Y};$[oe]={error:ae,task:fe},se(null)}),w++},function(D){if(D)return o(D);for(var se=[],oe=[],Y=0,ae=$.length;Y<ae;Y++){var fe=$[Y];fe.task&&(fe.error?oe.push(fe.task):se.push(fe.task))}return o(null,{successList:se,errorList:oe})})}function z(n,o){var t=this,i=n.SliceSize===void 0?t.options.SliceSize:n.SliceSize,u=[],y=n.Body,L=y.size||y.length||0,k={TaskId:""};if(t.options.EnableReporter){var w=t.options.UseAccelerate||typeof t.options.Domain=="string"&&t.options.Domain.includes("accelerate."),$=L>i?"sliceUploadFile":"putObject";n.tracker=new M({Beacon:t.options.BeaconReporter,clsReporter:t.options.ClsReporter,bucket:n.Bucket,region:n.Region,apiName:"uploadFile",realApi:$,fileKey:n.Key,fileSize:L,accelerate:w,deepTracker:t.options.DeepTracker,customId:t.options.CustomId,delay:t.options.TrackerDelay})}b.each(n,function(fe,ie){F(fe)!=="object"&&typeof fe!="function"&&(k[ie]=fe)});var D=n.onTaskReady,se=function(ie){k.TaskId=ie,D&&D(ie)};n.onTaskReady=se;var oe=L>i?"sliceUploadFile":"putObject",Y=n.onFileFinish,ae=function(ie,J){n.tracker&&n.tracker.report(ie,J),Y&&Y(ie,J,k),o&&o(ie,J)};u.push({api:oe,params:n,callback:ae}),t._addTasks(u)}function G(n,o){var t=this,i=n.SliceSize===void 0?t.options.SliceSize:n.SliceSize,u=0,y=0,L=b.throttleOnProgress.call(t,y,n.onProgress),k=n.files.length,w=n.onFileFinish,$=Array(k),D=function(Y,ae,fe){L(null,!0),w&&w(Y,ae,fe),$[fe.Index]={options:fe,error:Y,data:ae},--k<=0&&o&&o(null,{files:$})},se=[];b.each(n.files,function(oe,Y){(function(){var ae=oe.Body,fe=ae.size||ae.length||0,ie={Index:Y,TaskId:""};if(!t.options.UseRawKey&&oe.Key&&oe.Key.substr(0,1)==="/"&&(oe.Key=oe.Key.substr(1)),u+=fe,t.options.EnableReporter){var J=t.options.UseAccelerate||typeof t.options.Domain=="string"&&t.options.Domain.includes("accelerate."),V=fe>i?"sliceUploadFile":"putObject";oe.tracker=new M({Beacon:t.options.BeaconReporter,clsReporter:t.options.ClsReporter,bucket:oe.Bucket,region:oe.Region,apiName:"uploadFiles",realApi:V,fileKey:oe.Key,fileSize:fe,accelerate:J,deepTracker:t.options.DeepTracker,customId:t.options.CustomId,delay:t.options.TrackerDelay})}b.each(oe,function(me,Te){F(me)!=="object"&&typeof me!="function"&&(ie[Te]=me)});var Z=oe.onTaskReady,de=function(Te){ie.TaskId=Te,Z&&Z(Te)};oe.onTaskReady=de;var ce=0,te=oe.onProgress,ne=function(Te){y=y-ce+Te.loaded,ce=Te.loaded,te&&te(Te),L({loaded:y,total:u})};oe.onProgress=ne;var ye=fe>i?"sliceUploadFile":"putObject",ge=oe.onFileFinish,ke=function(Te,Oe){oe.tracker&&oe.tracker.report(Te,Oe),ge&&ge(Te,Oe),D&&D(Te,Oe,ie)};se.push({api:ye,params:oe,callback:ke})})()}),t._addTasks(se)}function g(n,o){var t=new j,i=this,u=n.Bucket,y=n.Region,L=n.Key,k=n.CopySource,w=b.getSourceParams.call(this,k);if(!w){o(b.error(new Error("CopySource format error")));return}var $=w.Bucket,D=w.Region,se=decodeURIComponent(w.Key),oe=n.CopySliceSize===void 0?i.options.CopySliceSize:n.CopySliceSize;oe=Math.max(0,oe);var Y=n.CopyChunkSize||this.options.CopyChunkSize,ae=this.options.CopyChunkParallelLimit,fe=this.options.ChunkRetryTimes+1,ie=0,J=0,V,Z,de={},ce={},te={};t.on("copy_slice_complete",function(ne){b.each(n.Headers,function(ge,ke){ke.toLowerCase().indexOf("x-cos-meta-")});var ye=b.map(ne.PartList,function(ge){return{PartNumber:ge.PartNumber,ETag:ge.ETag}});s.retry(fe,function(ge){i.multipartComplete({Bucket:u,Region:y,Key:L,UploadId:ne.UploadId,Parts:ye,tracker:n.tracker,calledBySdk:"sliceCopyFile"},ge)},function(ge,ke){if(O.removeUsing(ne.UploadId),ge)return Z(null,!0),o(ge);O.removeUploadId(ne.UploadId),Z({loaded:V,total:V},!0),o(null,ke)})}),t.on("get_copy_data_finish",function(ne){var ye=O.getCopyFileId(k,de,Y,u,L);ye&&O.saveUploadId(ye,ne.UploadId,i.options.UploadIdCacheLimit),O.setUsing(ne.UploadId);var ge=b.filter(ne.PartList,function(ke){return ke.Uploaded&&(J+=ke.PartNumber>=ie&&V%Y||Y),!ke.Uploaded});s.eachLimit(ge,ae,function(ke,me){var Te=ke.PartNumber,Oe=ke.CopySourceRange,qe=ke.end-ke.start;s.retry(fe,function(je){l.call(i,{Bucket:u,Region:y,Key:L,CopySource:k,UploadId:ne.UploadId,PartNumber:Te,CopySourceRange:Oe,tracker:n.tracker,calledBySdk:"sliceCopyFile"},je)},function(je,We){if(je)return me(je);J+=qe,Z({loaded:J,total:V}),ke.ETag=We.ETag,me(je||null,We)})},function(ke){if(ke)return O.removeUsing(ne.UploadId),Z(null,!0),o(ke);t.emit("copy_slice_complete",ne)})}),t.on("get_chunk_size_finish",function(){var ne=function(){i.multipartInit({Bucket:u,Region:y,Key:L,Headers:te,tracker:n.tracker,calledBySdk:"sliceCopyFile"},function(Te,Oe){if(Te)return o(Te);n.UploadId=Oe.UploadId,t.emit("get_copy_data_finish",{UploadId:n.UploadId,PartList:n.PartList})})},ye=O.getCopyFileId(k,de,Y,u,L),ge=O.getUploadIdList(ye);if(!ye||!ge)return ne();var ke=function me(Te){if(Te>=ge.length)return ne();var Oe=ge[Te];if(O.using[Oe])return me(Te+1);h.call(i,{Bucket:u,Region:y,Key:L,UploadId:Oe,tracker:n.tracker,calledBySdk:"sliceCopyFile"},function(qe,je){if(qe)O.removeUploadId(Oe),me(Te+1);else{if(O.using[Oe])return me(Te+1);var We={},Je=0;b.each(je.PartList,function(Me){var Qe=parseInt(Me.Size),rt=Je+Qe-1;We[Me.PartNumber+"|"+Je+"|"+rt]=Me.ETag,Je+=Qe}),b.each(n.PartList,function(Me){var Qe=We[Me.PartNumber+"|"+Me.start+"|"+Me.end];Qe&&(Me.ETag=Qe,Me.Uploaded=!0)}),t.emit("get_copy_data_finish",{UploadId:Oe,PartList:n.PartList})}})};ke(0)}),t.on("get_file_size_finish",function(){if(function(){for(var ye=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,5120],ge=1024*1024,ke=0;ke<ye.length&&(ge=ye[ke]*1024*1024,!(V/ge<=i.options.MaxPartNumber));ke++);n.ChunkSize=Y=Math.max(Y,ge),ie=Math.ceil(V/Y);for(var me=[],Te=1;Te<=ie;Te++){var Oe=(Te-1)*Y,qe=Te*Y<V?Te*Y-1:V-1,je={PartNumber:Te,start:Oe,end:qe,CopySourceRange:"bytes="+Oe+"-"+qe};me.push(je)}n.PartList=me}(),n.Headers["x-cos-metadata-directive"]==="Replaced"?te=n.Headers:te=ce,te["x-cos-storage-class"]=n.Headers["x-cos-storage-class"]||ce["x-cos-storage-class"],te=b.clearKey(te),ce["x-cos-storage-class"]==="ARCHIVE"||ce["x-cos-storage-class"]==="DEEP_ARCHIVE"){var ne=ce["x-cos-restore"];if(!ne||ne==='ongoing-request="true"'){o(b.error(new Error("Unrestored archive object is not allowed to be copied")));return}}delete te["x-cos-copy-source"],delete te["x-cos-metadata-directive"],delete te["x-cos-copy-source-If-Modified-Since"],delete te["x-cos-copy-source-If-Unmodified-Since"],delete te["x-cos-copy-source-If-Match"],delete te["x-cos-copy-source-If-None-Match"],t.emit("get_chunk_size_finish")}),i.headObject({Bucket:$,Region:D,Key:se,tracker:n.tracker,calledBySdk:"sliceCopyFile"},function(ne,ye){if(ne){ne.statusCode&&ne.statusCode===404?o(b.error(ne,{ErrorStatus:se+" Not Exist"})):o(ne);return}if(V=n.FileSize=ye.headers["content-length"],V===void 0||!V){o(b.error(new Error('get Content-Length error, please add "Content-Length" to CORS ExposeHeader setting.（ 获取Content-Length失败，请在CORS ExposeHeader设置中添加Content-Length，请参考文档：https://cloud.tencent.com/document/product/436/13318 ）')));return}if(n.tracker&&n.tracker.setParams({httpSize:V}),Z=b.throttleOnProgress.call(i,V,n.onProgress),V<=oe)n.Headers["x-cos-metadata-directive"]||(n.Headers["x-cos-metadata-directive"]="Copy"),i.putObjectCopy(Object.assign(n,{calledBySdk:"sliceCopyFile"}),function(ke,me){if(ke)return Z(null,!0),o(ke);Z({loaded:V,total:V},!0),o(ke,me)});else{var ge=ye.headers;de=ge,ce={"Cache-Control":ge["cache-control"],"Content-Disposition":ge["content-disposition"],"Content-Encoding":ge["content-encoding"],"Content-Type":ge["content-type"],Expires:ge.expires,"x-cos-storage-class":ge["x-cos-storage-class"]},b.each(ge,function(ke,me){var Te="x-cos-meta-";me.indexOf(Te)===0&&me.length>Te.length&&(ce[me]=ke)}),t.emit("get_file_size_finish")}})}function l(n,o){var t=n.TaskId,i=n.Bucket,u=n.Region,y=n.Key,L=n.CopySource,k=n.UploadId,w=n.PartNumber*1,$=n.CopySourceRange,D=this.options.ChunkRetryTimes+1,se=this;s.retry(D,function(oe){se.uploadPartCopy({TaskId:t,Bucket:i,Region:u,Key:y,CopySource:L,UploadId:k,PartNumber:w,CopySourceRange:$,tracker:n.tracker,calledBySdk:n.calledBySdk},function(Y,ae){oe(Y||null,ae)})},function(oe,Y){return o(oe,Y)})}var x={sliceUploadFile:f,abortUploadTask:N,uploadFile:z,uploadFiles:G,sliceCopyFile:g};H.exports.init=function(n,o){o.transferToTaskMethod(x,"sliceUploadFile"),b.each(x,function(t,i){n.prototype[i]=b.apiWrapper(i,t)})}},"./src/async.js":function(H,re){var P=function(j,b,M,f){if(f=f||function(){},!j.length||b<=0)return f();var d=0,m=0,h=0;(function C(){if(d>=j.length)return f();for(;h<b&&m<j.length;)m+=1,h+=1,M(j[m-1],function(A){A?(f(A),f=function(){}):(d+=1,h-=1,d>=j.length?f():C())})})()},F=function(j,b,M){var f=function d(m){b(function(h,C){h&&m<j?d(m+1):M(h,C)})};j<1?M():f(1)},O={eachLimit:P,retry:F};H.exports=O},"./src/base.js":function(H,re,P){var F=P("./node_modules/@babel/runtime/helpers/typeof.js"),O=P("./lib/request.js"),s=P("./src/util.js");function j(e,a){var r=this.options.Protocol||(s.isBrowser&&(typeof location>"u"?"undefined":F(location))==="object"&&location.protocol==="http:"?"http:":"https:"),c=this.options.ServiceDomain,v=e.AppId||this.options.appId,p=e.Region;c?(c=c.replace(/\{\{AppId\}\}/gi,v||"").replace(/\{\{Region\}\}/gi,p||"").replace(/\{\{.*?\}\}/gi,""),/^[a-zA-Z]+:\/\//.test(c)||(c=r+"//"+c),c.slice(-1)==="/"&&(c=c.slice(0,-1))):p?c=r+"//cos."+p+".myqcloud.com":c=r+"//service.cos.myqcloud.com";var S="",B=p?"cos."+p+".myqcloud.com":"service.cos.myqcloud.com",_=c.replace(/^https?:\/\/([^/]+)(\/.*)?$/,"$1");B===_&&(S=B),X.call(this,{Action:"name/cos:GetService",url:c,method:"GET",headers:e.Headers,SignHost:S,tracker:e.tracker},function(le,ue){if(le)return a(le);var xe=ue&&ue.ListAllMyBucketsResult&&ue.ListAllMyBucketsResult.Buckets&&ue.ListAllMyBucketsResult.Buckets.Bucket||[];xe=s.isArray(xe)?xe:[xe];var Q=ue&&ue.ListAllMyBucketsResult&&ue.ListAllMyBucketsResult.Owner||{};a(null,{Buckets:xe,Owner:Q,statusCode:ue.statusCode,headers:ue.headers})})}function b(e,a){var r=this,c="";if(e.BucketAZConfig){var v={BucketAZConfig:e.BucketAZConfig};c=s.json2xml({CreateBucketConfiguration:v})}X.call(this,{Action:"name/cos:PutBucket",method:"PUT",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,body:c,tracker:e.tracker},function(p,S){if(p)return a(p);var B=He({protocol:r.options.Protocol,domain:r.options.Domain,bucket:e.Bucket,region:e.Region,isLocation:!0});a(null,{Location:B,statusCode:S.statusCode,headers:S.headers})})}function M(e,a){X.call(this,{Action:"name/cos:HeadBucket",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,method:"HEAD",tracker:e.tracker},a)}function f(e,a){var r={};r.prefix=e.Prefix||"",r.delimiter=e.Delimiter,r.marker=e.Marker,r["max-keys"]=e.MaxKeys,r["encoding-type"]=e.EncodingType,X.call(this,{Action:"name/cos:GetBucket",ResourceKey:r.prefix,method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,qs:r,tracker:e.tracker},function(c,v){if(c)return a(c);var p=v.ListBucketResult||{},S=p.Contents||[],B=p.CommonPrefixes||[];S=s.isArray(S)?S:[S],B=s.isArray(B)?B:[B];var _=s.clone(p);s.extend(_,{Contents:S,CommonPrefixes:B,statusCode:v.statusCode,headers:v.headers}),a(null,_)})}function d(e,a){X.call(this,{Action:"name/cos:DeleteBucket",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,method:"DELETE",tracker:e.tracker},function(r,c){if(r&&r.statusCode===204)return a(null,{statusCode:r.statusCode});if(r)return a(r);a(null,{statusCode:c.statusCode,headers:c.headers})})}function m(e,a){var r=e.Headers,c="";if(e.AccessControlPolicy){var v=s.clone(e.AccessControlPolicy||{}),p=v.Grants||v.Grant;p=s.isArray(p)?p:[p],delete v.Grant,delete v.Grants,v.AccessControlList={Grant:p},c=s.json2xml({AccessControlPolicy:v}),r["Content-Type"]="application/xml",r["Content-MD5"]=s.b64(s.md5(c))}s.each(r,function(S,B){B.indexOf("x-cos-grant-")===0&&(r[B]=Ge(r[B]))}),X.call(this,{Action:"name/cos:PutBucketACL",method:"PUT",Bucket:e.Bucket,Region:e.Region,headers:r,action:"acl",body:c,tracker:e.tracker},function(S,B){if(S)return a(S);a(null,{statusCode:B.statusCode,headers:B.headers})})}function h(e,a){X.call(this,{Action:"name/cos:GetBucketACL",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"acl",tracker:e.tracker},function(r,c){if(r)return a(r);var v=c.AccessControlPolicy||{},p=v.Owner||{},S=v.AccessControlList.Grant||[];S=s.isArray(S)?S:[S];var B=Re(v);c.headers&&c.headers["x-cos-acl"]&&(B.ACL=c.headers["x-cos-acl"]),B=s.extend(B,{Owner:p,Grants:S,statusCode:c.statusCode,headers:c.headers}),a(null,B)})}function C(e,a){var r=e.CORSConfiguration||{},c=r.CORSRules||e.CORSRules||[];c=s.clone(s.isArray(c)?c:[c]),s.each(c,function(B){s.each(["AllowedOrigin","AllowedHeader","AllowedMethod","ExposeHeader"],function(_){var le=_+"s",ue=B[le]||B[_]||[];delete B[le],B[_]=s.isArray(ue)?ue:[ue]})});var v={CORSRule:c};e.ResponseVary&&(v.ResponseVary=e.ResponseVary);var p=s.json2xml({CORSConfiguration:v}),S=e.Headers;S["Content-Type"]="application/xml",S["Content-MD5"]=s.b64(s.md5(p)),X.call(this,{Action:"name/cos:PutBucketCORS",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:p,action:"cors",headers:S,tracker:e.tracker},function(B,_){if(B)return a(B);a(null,{statusCode:_.statusCode,headers:_.headers})})}function A(e,a){X.call(this,{Action:"name/cos:GetBucketCORS",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"cors",tracker:e.tracker},function(r,c){if(r){if(r.statusCode===404&&r.error&&r.error.Code==="NoSuchCORSConfiguration"){var v={CORSRules:[],statusCode:r.statusCode};r.headers&&(v.headers=r.headers),a(null,v)}else a(r);return}var p=c.CORSConfiguration||{},S=p.CORSRules||p.CORSRule||[];S=s.clone(s.isArray(S)?S:[S]);var B=p.ResponseVary;s.each(S,function(_){s.each(["AllowedOrigin","AllowedHeader","AllowedMethod","ExposeHeader"],function(le){var ue=le+"s",xe=_[ue]||_[le]||[];delete _[le],_[ue]=s.isArray(xe)?xe:[xe]})}),a(null,{CORSRules:S,ResponseVary:B,statusCode:c.statusCode,headers:c.headers})})}function R(e,a){X.call(this,{Action:"name/cos:DeleteBucketCORS",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"cors",tracker:e.tracker},function(r,c){if(r&&r.statusCode===204)return a(null,{statusCode:r.statusCode});if(r)return a(r);a(null,{statusCode:c.statusCode||r.statusCode,headers:c.headers})})}function N(e,a){X.call(this,{Action:"name/cos:GetBucketLocation",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"location",tracker:e.tracker},a)}function U(e,a){var r=e.Policy;try{typeof r=="string"&&(r=JSON.parse(r))}catch{}if(!r||typeof r=="string")return a(s.error(new Error("Policy format error")));var c=JSON.stringify(r);r.version||(r.version="2.0");var v=e.Headers;v["Content-Type"]="application/json",v["Content-MD5"]=s.b64(s.md5(c)),X.call(this,{Action:"name/cos:PutBucketPolicy",method:"PUT",Bucket:e.Bucket,Region:e.Region,action:"policy",body:c,headers:v,tracker:e.tracker},function(p,S){if(p&&p.statusCode===204)return a(null,{statusCode:p.statusCode});if(p)return a(p);a(null,{statusCode:S.statusCode,headers:S.headers})})}function z(e,a){X.call(this,{Action:"name/cos:GetBucketPolicy",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"policy",rawBody:!0,tracker:e.tracker},function(r,c){if(r)return r.statusCode&&r.statusCode===403?a(s.error(r,{ErrorStatus:"Access Denied"})):r.statusCode&&r.statusCode===405?a(s.error(r,{ErrorStatus:"Method Not Allowed"})):r.statusCode&&r.statusCode===404?a(s.error(r,{ErrorStatus:"Policy Not Found"})):a(r);var v={};try{v=JSON.parse(c.body)}catch{}a(null,{Policy:v,statusCode:c.statusCode,headers:c.headers})})}function G(e,a){X.call(this,{Action:"name/cos:DeleteBucketPolicy",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"policy",tracker:e.tracker},function(r,c){if(r&&r.statusCode===204)return a(null,{statusCode:r.statusCode});if(r)return a(r);a(null,{statusCode:c.statusCode||r.statusCode,headers:c.headers})})}function g(e,a){var r=e.Tagging||{},c=r.TagSet||r.Tags||e.Tags||[];c=s.clone(s.isArray(c)?c:[c]);var v=s.json2xml({Tagging:{TagSet:{Tag:c}}}),p=e.Headers;p["Content-Type"]="application/xml",p["Content-MD5"]=s.b64(s.md5(v)),X.call(this,{Action:"name/cos:PutBucketTagging",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:v,action:"tagging",headers:p,tracker:e.tracker},function(S,B){if(S&&S.statusCode===204)return a(null,{statusCode:S.statusCode});if(S)return a(S);a(null,{statusCode:B.statusCode,headers:B.headers})})}function l(e,a){X.call(this,{Action:"name/cos:GetBucketTagging",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"tagging",tracker:e.tracker},function(r,c){if(r){if(r.statusCode===404&&r.error&&(r.error==="Not Found"||r.error.Code==="NoSuchTagSet")){var v={Tags:[],statusCode:r.statusCode};r.headers&&(v.headers=r.headers),a(null,v)}else a(r);return}var p=[];try{p=c.Tagging.TagSet.Tag||[]}catch{}p=s.clone(s.isArray(p)?p:[p]),a(null,{Tags:p,statusCode:c.statusCode,headers:c.headers})})}function x(e,a){X.call(this,{Action:"name/cos:DeleteBucketTagging",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"tagging",tracker:e.tracker},function(r,c){if(r&&r.statusCode===204)return a(null,{statusCode:r.statusCode});if(r)return a(r);a(null,{statusCode:c.statusCode,headers:c.headers})})}function n(e,a){var r=e.LifecycleConfiguration||{},c=r.Rules||e.Rules||[];c=s.clone(c);var v=s.json2xml({LifecycleConfiguration:{Rule:c}}),p=e.Headers;p["Content-Type"]="application/xml",p["Content-MD5"]=s.b64(s.md5(v)),X.call(this,{Action:"name/cos:PutBucketLifecycle",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:v,action:"lifecycle",headers:p,tracker:e.tracker},function(S,B){if(S&&S.statusCode===204)return a(null,{statusCode:S.statusCode});if(S)return a(S);a(null,{statusCode:B.statusCode,headers:B.headers})})}function o(e,a){X.call(this,{Action:"name/cos:GetBucketLifecycle",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"lifecycle",tracker:e.tracker},function(r,c){if(r){if(r.statusCode===404&&r.error&&r.error.Code==="NoSuchLifecycleConfiguration"){var v={Rules:[],statusCode:r.statusCode};r.headers&&(v.headers=r.headers),a(null,v)}else a(r);return}var p=[];try{p=c.LifecycleConfiguration.Rule||[]}catch{}p=s.clone(s.isArray(p)?p:[p]),a(null,{Rules:p,statusCode:c.statusCode,headers:c.headers})})}function t(e,a){X.call(this,{Action:"name/cos:DeleteBucketLifecycle",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"lifecycle",tracker:e.tracker},function(r,c){if(r&&r.statusCode===204)return a(null,{statusCode:r.statusCode});if(r)return a(r);a(null,{statusCode:c.statusCode,headers:c.headers})})}function i(e,a){if(!e.VersioningConfiguration){a(s.error(new Error("missing param VersioningConfiguration")));return}var r=e.VersioningConfiguration||{},c=s.json2xml({VersioningConfiguration:r}),v=e.Headers;v["Content-Type"]="application/xml",v["Content-MD5"]=s.b64(s.md5(c)),X.call(this,{Action:"name/cos:PutBucketVersioning",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:c,action:"versioning",headers:v,tracker:e.tracker},function(p,S){if(p&&p.statusCode===204)return a(null,{statusCode:p.statusCode});if(p)return a(p);a(null,{statusCode:S.statusCode,headers:S.headers})})}function u(e,a){X.call(this,{Action:"name/cos:GetBucketVersioning",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"versioning",tracker:e.tracker},function(r,c){r||!c.VersioningConfiguration&&(c.VersioningConfiguration={}),a(r,c)})}function y(e,a){var r=s.clone(e.ReplicationConfiguration),c=s.json2xml({ReplicationConfiguration:r});c=c.replace(/<(\/?)Rules>/gi,"<$1Rule>"),c=c.replace(/<(\/?)Tags>/gi,"<$1Tag>");var v=e.Headers;v["Content-Type"]="application/xml",v["Content-MD5"]=s.b64(s.md5(c)),X.call(this,{Action:"name/cos:PutBucketReplication",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:c,action:"replication",headers:v,tracker:e.tracker},function(p,S){if(p&&p.statusCode===204)return a(null,{statusCode:p.statusCode});if(p)return a(p);a(null,{statusCode:S.statusCode,headers:S.headers})})}function L(e,a){X.call(this,{Action:"name/cos:GetBucketReplication",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"replication",tracker:e.tracker},function(r,c){if(r){if(r.statusCode===404&&r.error&&(r.error==="Not Found"||r.error.Code==="ReplicationConfigurationnotFoundError")){var v={ReplicationConfiguration:{Rules:[]},statusCode:r.statusCode};r.headers&&(v.headers=r.headers),a(null,v)}else a(r);return}!c.ReplicationConfiguration&&(c.ReplicationConfiguration={}),c.ReplicationConfiguration.Rule&&(c.ReplicationConfiguration.Rules=s.makeArray(c.ReplicationConfiguration.Rule),delete c.ReplicationConfiguration.Rule),a(r,c)})}function k(e,a){X.call(this,{Action:"name/cos:DeleteBucketReplication",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"replication",tracker:e.tracker},function(r,c){if(r&&r.statusCode===204)return a(null,{statusCode:r.statusCode});if(r)return a(r);a(null,{statusCode:c.statusCode,headers:c.headers})})}function w(e,a){if(!e.WebsiteConfiguration){a(s.error(new Error("missing param WebsiteConfiguration")));return}var r=s.clone(e.WebsiteConfiguration||{}),c=r.RoutingRules||r.RoutingRule||[];c=s.isArray(c)?c:[c],delete r.RoutingRule,delete r.RoutingRules,c.length&&(r.RoutingRules={RoutingRule:c});var v=s.json2xml({WebsiteConfiguration:r}),p=e.Headers;p["Content-Type"]="application/xml",p["Content-MD5"]=s.b64(s.md5(v)),X.call(this,{Action:"name/cos:PutBucketWebsite",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:v,action:"website",headers:p,tracker:e.tracker},function(S,B){if(S&&S.statusCode===204)return a(null,{statusCode:S.statusCode});if(S)return a(S);a(null,{statusCode:B.statusCode,headers:B.headers})})}function $(e,a){X.call(this,{Action:"name/cos:GetBucketWebsite",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,action:"website",tracker:e.tracker},function(r,c){if(r){if(r.statusCode===404&&r.error.Code==="NoSuchWebsiteConfiguration"){var v={WebsiteConfiguration:{},statusCode:r.statusCode};r.headers&&(v.headers=r.headers),a(null,v)}else a(r);return}var p=c.WebsiteConfiguration||{};if(p.RoutingRules){var S=s.clone(p.RoutingRules.RoutingRule||[]);S=s.makeArray(S),p.RoutingRules=S}a(null,{WebsiteConfiguration:p,statusCode:c.statusCode,headers:c.headers})})}function D(e,a){X.call(this,{Action:"name/cos:DeleteBucketWebsite",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"website",tracker:e.tracker},function(r,c){if(r&&r.statusCode===204)return a(null,{statusCode:r.statusCode});if(r)return a(r);a(null,{statusCode:c.statusCode,headers:c.headers})})}function se(e,a){if(!e.RefererConfiguration){a(s.error(new Error("missing param RefererConfiguration")));return}var r=s.clone(e.RefererConfiguration||{}),c=r.DomainList||{},v=c.Domains||c.Domain||[];v=s.isArray(v)?v:[v],v.length&&(r.DomainList={Domain:v});var p=s.json2xml({RefererConfiguration:r}),S=e.Headers;S["Content-Type"]="application/xml",S["Content-MD5"]=s.b64(s.md5(p)),X.call(this,{Action:"name/cos:PutBucketReferer",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:p,action:"referer",headers:S,tracker:e.tracker},function(B,_){if(B&&B.statusCode===204)return a(null,{statusCode:B.statusCode});if(B)return a(B);a(null,{statusCode:_.statusCode,headers:_.headers})})}function oe(e,a){X.call(this,{Action:"name/cos:GetBucketReferer",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,action:"referer",tracker:e.tracker},function(r,c){if(r){if(r.statusCode===404&&r.error.Code==="NoSuchRefererConfiguration"){var v={WebsiteConfiguration:{},statusCode:r.statusCode};r.headers&&(v.headers=r.headers),a(null,v)}else a(r);return}var p=c.RefererConfiguration||{};if(p.DomainList){var S=s.makeArray(p.DomainList.Domain||[]);p.DomainList={Domains:S}}a(null,{RefererConfiguration:p,statusCode:c.statusCode,headers:c.headers})})}function Y(e,a){var r=e.DomainConfiguration||{},c=r.DomainRule||e.DomainRule||[];c=s.clone(c);var v=s.json2xml({DomainConfiguration:{DomainRule:c}}),p=e.Headers;p["Content-Type"]="application/xml",p["Content-MD5"]=s.b64(s.md5(v)),X.call(this,{Action:"name/cos:PutBucketDomain",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:v,action:"domain",headers:p,tracker:e.tracker},function(S,B){if(S&&S.statusCode===204)return a(null,{statusCode:S.statusCode});if(S)return a(S);a(null,{statusCode:B.statusCode,headers:B.headers})})}function ae(e,a){X.call(this,{Action:"name/cos:GetBucketDomain",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"domain",tracker:e.tracker},function(r,c){if(r)return a(r);var v=[];try{v=c.DomainConfiguration.DomainRule||[]}catch{}v=s.clone(s.isArray(v)?v:[v]),a(null,{DomainRule:v,statusCode:c.statusCode,headers:c.headers})})}function fe(e,a){X.call(this,{Action:"name/cos:DeleteBucketDomain",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"domain",tracker:e.tracker},function(r,c){if(r&&r.statusCode===204)return a(null,{statusCode:r.statusCode});if(r)return a(r);a(null,{statusCode:c.statusCode,headers:c.headers})})}function ie(e,a){var r=e.OriginConfiguration||{},c=r.OriginRule||e.OriginRule||[];c=s.clone(c);var v=s.json2xml({OriginConfiguration:{OriginRule:c}}),p=e.Headers;p["Content-Type"]="application/xml",p["Content-MD5"]=s.b64(s.md5(v)),X.call(this,{Action:"name/cos:PutBucketOrigin",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:v,action:"origin",headers:p,tracker:e.tracker},function(S,B){if(S&&S.statusCode===204)return a(null,{statusCode:S.statusCode});if(S)return a(S);a(null,{statusCode:B.statusCode,headers:B.headers})})}function J(e,a){X.call(this,{Action:"name/cos:GetBucketOrigin",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"origin",tracker:e.tracker},function(r,c){if(r)return a(r);var v=[];try{v=c.OriginConfiguration.OriginRule||[]}catch{}v=s.clone(s.isArray(v)?v:[v]),a(null,{OriginRule:v,statusCode:c.statusCode,headers:c.headers})})}function V(e,a){X.call(this,{Action:"name/cos:DeleteBucketOrigin",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"origin",tracker:e.tracker},function(r,c){if(r&&r.statusCode===204)return a(null,{statusCode:r.statusCode});if(r)return a(r);a(null,{statusCode:c.statusCode,headers:c.headers})})}function Z(e,a){var r=s.json2xml({BucketLoggingStatus:e.BucketLoggingStatus||""}),c=e.Headers;c["Content-Type"]="application/xml",c["Content-MD5"]=s.b64(s.md5(r)),X.call(this,{Action:"name/cos:PutBucketLogging",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:r,action:"logging",headers:c,tracker:e.tracker},function(v,p){if(v&&v.statusCode===204)return a(null,{statusCode:v.statusCode});if(v)return a(v);a(null,{statusCode:p.statusCode,headers:p.headers})})}function de(e,a){X.call(this,{Action:"name/cos:GetBucketLogging",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"logging",tracker:e.tracker},function(r,c){if(r)return a(r);a(null,{BucketLoggingStatus:c.BucketLoggingStatus,statusCode:c.statusCode,headers:c.headers})})}function ce(e,a,r){var c=s.clone(a.InventoryConfiguration);if(c.OptionalFields){var v=c.OptionalFields||[];c.OptionalFields={Field:v}}if(c.Destination&&c.Destination.COSBucketDestination&&c.Destination.COSBucketDestination.Encryption){var p=c.Destination.COSBucketDestination.Encryption;Object.keys(p).indexOf("SSECOS")>-1&&(p["SSE-COS"]=p.SSECOS,delete p.SSECOS)}var S=s.json2xml({InventoryConfiguration:c}),B=a.Headers;B["Content-Type"]="application/xml",B["Content-MD5"]=s.b64(s.md5(S));var _=e==="PUT"?"name/cos:PutBucketInventory":"name/cos:PostBucketInventory";X.call(this,{Action:_,method:e,Bucket:a.Bucket,Region:a.Region,body:S,action:"inventory",qs:{id:a.Id},headers:B,tracker:a.tracker},function(le,ue){if(le&&le.statusCode===204)return r(null,{statusCode:le.statusCode});if(le)return r(le);r(null,{statusCode:ue.statusCode,headers:ue.headers})})}function te(e,a){return ce.call(this,"PUT",e,a)}function ne(e,a){return ce.call(this,"POST",e,a)}function ye(e,a){X.call(this,{Action:"name/cos:GetBucketInventory",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"inventory",qs:{id:e.Id},tracker:e.tracker},function(r,c){if(r)return a(r);var v=c.InventoryConfiguration;if(v&&v.OptionalFields&&v.OptionalFields.Field){var p=v.OptionalFields.Field;s.isArray(p)||(p=[p]),v.OptionalFields=p}if(v.Destination&&v.Destination.COSBucketDestination&&v.Destination.COSBucketDestination.Encryption){var S=v.Destination.COSBucketDestination.Encryption;Object.keys(S).indexOf("SSE-COS")>-1&&(S.SSECOS=S["SSE-COS"],delete S["SSE-COS"])}a(null,{InventoryConfiguration:v,statusCode:c.statusCode,headers:c.headers})})}function ge(e,a){X.call(this,{Action:"name/cos:ListBucketInventory",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"inventory",qs:{"continuation-token":e.ContinuationToken},tracker:e.tracker},function(r,c){if(r)return a(r);var v=c.ListInventoryConfigurationResult,p=v.InventoryConfiguration||[];p=s.isArray(p)?p:[p],delete v.InventoryConfiguration,s.each(p,function(S){if(S&&S.OptionalFields&&S.OptionalFields.Field){var B=S.OptionalFields.Field;s.isArray(B)||(B=[B]),S.OptionalFields=B}if(S.Destination&&S.Destination.COSBucketDestination&&S.Destination.COSBucketDestination.Encryption){var _=S.Destination.COSBucketDestination.Encryption;Object.keys(_).indexOf("SSE-COS")>-1&&(_.SSECOS=_["SSE-COS"],delete _["SSE-COS"])}}),v.InventoryConfigurations=p,s.extend(v,{statusCode:c.statusCode,headers:c.headers}),a(null,v)})}function ke(e,a){X.call(this,{Action:"name/cos:DeleteBucketInventory",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"inventory",qs:{id:e.Id},tracker:e.tracker},function(r,c){if(r&&r.statusCode===204)return a(null,{statusCode:r.statusCode});if(r)return a(r);a(null,{statusCode:c.statusCode,headers:c.headers})})}function me(e,a){if(!e.AccelerateConfiguration){a(s.error(new Error("missing param AccelerateConfiguration")));return}var r={AccelerateConfiguration:e.AccelerateConfiguration||{}},c=s.json2xml(r),v={};v["Content-Type"]="application/xml",v["Content-MD5"]=s.b64(s.md5(c)),X.call(this,{Action:"name/cos:PutBucketAccelerate",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:c,action:"accelerate",headers:v,tracker:e.tracker},function(p,S){if(p)return a(p);a(null,{statusCode:S.statusCode,headers:S.headers})})}function Te(e,a){X.call(this,{Action:"name/cos:GetBucketAccelerate",method:"GET",Bucket:e.Bucket,Region:e.Region,action:"accelerate",tracker:e.tracker},function(r,c){r||!c.AccelerateConfiguration&&(c.AccelerateConfiguration={}),a(r,c)})}function Oe(e,a){var r=e.ServerSideEncryptionConfiguration||{},c=r.Rule||r.Rules||[],v=s.json2xml({ServerSideEncryptionConfiguration:{Rule:c}}),p=e.Headers;p["Content-Type"]="application/xml",p["Content-MD5"]=s.b64(s.md5(v)),X.call(this,{Action:"name/cos:PutBucketEncryption",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:v,action:"encryption",headers:p,tracker:e.tracker},function(S,B){if(S&&S.statusCode===204)return a(null,{statusCode:S.statusCode});if(S)return a(S);a(null,{statusCode:B.statusCode,headers:B.headers})})}function qe(e,a){X.call(this,{Action:"name/cos:GetBucketEncryption",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"encryption",tracker:e.tracker},function(r,c){if(r){if(r.statusCode===404&&r.code==="NoSuchEncryptionConfiguration"){var v={EncryptionConfiguration:{Rules:[]},statusCode:r.statusCode};r.headers&&(v.headers=r.headers),a(null,v)}else a(r);return}var p=s.makeArray(c.EncryptionConfiguration&&c.EncryptionConfiguration.Rule||[]);c.EncryptionConfiguration={Rules:p},a(r,c)})}function je(e,a){X.call(this,{Action:"name/cos:DeleteBucketReplication",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"encryption",tracker:e.tracker},function(r,c){if(r&&r.statusCode===204)return a(null,{statusCode:r.statusCode});if(r)return a(r);a(null,{statusCode:c.statusCode,headers:c.headers})})}function We(e,a){X.call(this,{Action:"name/cos:HeadObject",method:"HEAD",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,headers:e.Headers,tracker:e.tracker},function(r,c){if(r){var v=r.statusCode;return e.Headers["If-Modified-Since"]&&v&&v===304?a(null,{NotModified:!0,statusCode:v}):a(r)}c.ETag=s.attr(c.headers,"etag",""),a(null,c)})}function Je(e,a){var r={};r.prefix=e.Prefix||"",r.delimiter=e.Delimiter,r["key-marker"]=e.KeyMarker,r["version-id-marker"]=e.VersionIdMarker,r["max-keys"]=e.MaxKeys,r["encoding-type"]=e.EncodingType,X.call(this,{Action:"name/cos:GetBucketObjectVersions",ResourceKey:r.prefix,method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,qs:r,action:"versions",tracker:e.tracker},function(c,v){if(c)return a(c);var p=v.ListVersionsResult||{},S=p.DeleteMarker||[];S=s.isArray(S)?S:[S];var B=p.Version||[];B=s.isArray(B)?B:[B];var _=s.clone(p);delete _.DeleteMarker,delete _.Version,s.extend(_,{DeleteMarkers:S,Versions:B,statusCode:v.statusCode,headers:v.headers}),a(null,_)})}function Me(e,a){if(this.options.ObjectKeySimplifyCheck){var r=s.simplifyPath(e.Key);if(r==="/"){a(s.error(new Error("The Getobject Key is illegal")));return}}var c=e.Query||{},v=e.QueryString||"",p=s.throttleOnProgress.call(this,0,e.onProgress),S=e.tracker;S&&S.setParams({signStartTime:new Date().getTime()}),c["response-content-type"]=e.ResponseContentType,c["response-content-language"]=e.ResponseContentLanguage,c["response-expires"]=e.ResponseExpires,c["response-cache-control"]=e.ResponseCacheControl,c["response-content-disposition"]=e.ResponseContentDisposition,c["response-content-encoding"]=e.ResponseContentEncoding,X.call(this,{Action:"name/cos:GetObject",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,DataType:e.DataType,headers:e.Headers,qs:c,qsStr:v,rawBody:!0,onDownloadProgress:p,tracker:S},function(B,_){if(p(null,!0),B){var le=B.statusCode;return e.Headers["If-Modified-Since"]&&le&&le===304?a(null,{NotModified:!0}):a(B)}a(null,{Body:_.body,ETag:s.attr(_.headers,"etag",""),statusCode:_.statusCode,headers:_.headers})})}function Qe(e,a){var r=this,c=e.ContentLength,v=s.throttleOnProgress.call(r,c,e.onProgress),p=e.Headers;!p["Cache-Control"]&&!p["cache-control"]&&(p["Cache-Control"]=""),!p["Content-Type"]&&!p["content-type"]&&(p["Content-Type"]=e.Body&&e.Body.type||"");var S=e.UploadAddMetaMd5||r.options.UploadAddMetaMd5||r.options.UploadCheckContentMd5,B=e.tracker;S&&B&&B.setParams({md5StartTime:new Date().getTime()}),s.getBodyMd5(S,e.Body,function(_){_&&(B&&B.setParams({md5EndTime:new Date().getTime()}),r.options.UploadCheckContentMd5&&(p["Content-MD5"]=s.b64(_)),(e.UploadAddMetaMd5||r.options.UploadAddMetaMd5)&&(p["x-cos-meta-md5"]=_)),e.ContentLength!==void 0&&(p["Content-Length"]=e.ContentLength),v(null,!0),X.call(r,{Action:"name/cos:PutObject",TaskId:e.TaskId,method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,qs:e.Query,body:e.Body,onProgress:v,tracker:B},function(le,ue){if(le)return v(null,!0),a(le);v({loaded:c,total:c},!0);var xe=He({ForcePathStyle:r.options.ForcePathStyle,protocol:r.options.Protocol,domain:r.options.Domain,bucket:e.Bucket,region:r.options.UseAccelerate?"accelerate":e.Region,object:e.Key});xe=xe.substr(xe.indexOf("://")+3),ue.Location=xe,ue.ETag=s.attr(ue.headers,"etag",""),a(null,ue)})},e.onHashProgress)}function rt(e,a){X.call(this,{Action:"name/cos:DeleteObject",method:"DELETE",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,VersionId:e.VersionId,action:e.Recursive?"recursive":"",tracker:e.tracker},function(r,c){if(r){var v=r.statusCode;return v&&v===404?a(null,{BucketNotFound:!0,statusCode:v}):a(r)}a(null,{statusCode:c.statusCode,headers:c.headers})})}function ct(e,a){var r={};e.VersionId&&(r.versionId=e.VersionId),X.call(this,{Action:"name/cos:GetObjectACL",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,qs:r,action:"acl",tracker:e.tracker},function(c,v){if(c)return a(c);var p=v.AccessControlPolicy||{},S=p.Owner||{},B=p.AccessControlList&&p.AccessControlList.Grant||[];B=s.isArray(B)?B:[B];var _=Re(p);delete _.GrantWrite,v.headers&&v.headers["x-cos-acl"]&&(_.ACL=v.headers["x-cos-acl"]),_=s.extend(_,{Owner:S,Grants:B,statusCode:v.statusCode,headers:v.headers}),a(null,_)})}function at(e,a){var r=e.Headers,c="";if(e.AccessControlPolicy){var v=s.clone(e.AccessControlPolicy||{}),p=v.Grants||v.Grant;p=s.isArray(p)?p:[p],delete v.Grant,delete v.Grants,v.AccessControlList={Grant:p},c=s.json2xml({AccessControlPolicy:v}),r["Content-Type"]="application/xml",r["Content-MD5"]=s.b64(s.md5(c))}s.each(r,function(S,B){B.indexOf("x-cos-grant-")===0&&(r[B]=Ge(r[B]))}),X.call(this,{Action:"name/cos:PutObjectACL",method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,action:"acl",headers:r,body:c,tracker:e.tracker},function(S,B){if(S)return a(S);a(null,{statusCode:B.statusCode,headers:B.headers})})}function lt(e,a){var r=e.Headers;r.Origin=e.Origin,r["Access-Control-Request-Method"]=e.AccessControlRequestMethod,r["Access-Control-Request-Headers"]=e.AccessControlRequestHeaders,X.call(this,{Action:"name/cos:OptionsObject",method:"OPTIONS",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:r,tracker:e.tracker},function(c,v){if(c)return c.statusCode&&c.statusCode===403?a(null,{OptionsForbidden:!0,statusCode:c.statusCode}):a(c);var p=v.headers||{};a(null,{AccessControlAllowOrigin:p["access-control-allow-origin"],AccessControlAllowMethods:p["access-control-allow-methods"],AccessControlAllowHeaders:p["access-control-allow-headers"],AccessControlExposeHeaders:p["access-control-expose-headers"],AccessControlMaxAge:p["access-control-max-age"],statusCode:v.statusCode,headers:v.headers})})}function dt(e,a){var r=this,c=e.Headers;!c["Cache-Control"]&&!c["cache-control"]&&(c["Cache-Control"]="");var v=e.CopySource||"",p=s.getSourceParams.call(this,v);if(!p){a(s.error(new Error("CopySource format error")));return}var S=p.Bucket,B=p.Region,_=decodeURIComponent(p.Key);X.call(this,{Scope:[{action:"name/cos:GetObject",bucket:S,region:B,prefix:_},{action:"name/cos:PutObject",bucket:e.Bucket,region:e.Region,prefix:e.Key}],method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,headers:e.Headers,tracker:e.tracker},function(le,ue){if(le)return a(le);var xe=s.clone(ue.CopyObjectResult||{}),Q=He({ForcePathStyle:r.options.ForcePathStyle,protocol:r.options.Protocol,domain:r.options.Domain,bucket:e.Bucket,region:e.Region,object:e.Key,isLocation:!0});s.extend(xe,{Location:Q,statusCode:ue.statusCode,headers:ue.headers}),a(null,xe)})}function Fe(e,a){var r=e.CopySource||"",c=s.getSourceParams.call(this,r);if(!c){a(s.error(new Error("CopySource format error")));return}var v=c.Bucket,p=c.Region,S=decodeURIComponent(c.Key);X.call(this,{Scope:[{action:"name/cos:GetObject",bucket:v,region:p,prefix:S},{action:"name/cos:PutObject",bucket:e.Bucket,region:e.Region,prefix:e.Key}],method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,qs:{partNumber:e.PartNumber,uploadId:e.UploadId},headers:e.Headers,tracker:e.tracker},function(B,_){if(B)return a(B);var le=s.clone(_.CopyPartResult||{});s.extend(le,{statusCode:_.statusCode,headers:_.headers}),a(null,le)})}function K(e,a){var r=e.Objects||[],c=e.Quiet;r=s.isArray(r)?r:[r];var v=s.json2xml({Delete:{Object:r,Quiet:c||!1}}),p=e.Headers;p["Content-Type"]="application/xml",p["Content-MD5"]=s.b64(s.md5(v));var S=s.map(r,function(B){return{action:"name/cos:DeleteObject",bucket:e.Bucket,region:e.Region,prefix:B.Key}});X.call(this,{Scope:S,method:"POST",Bucket:e.Bucket,Region:e.Region,body:v,action:"delete",headers:p,tracker:e.tracker},function(B,_){if(B)return a(B);var le=_.DeleteResult||{},ue=le.Deleted||[],xe=le.Error||[];ue=s.isArray(ue)?ue:[ue],xe=s.isArray(xe)?xe:[xe];var Q=s.clone(le);s.extend(Q,{Error:xe,Deleted:ue,statusCode:_.statusCode,headers:_.headers}),a(null,Q)})}function T(e,a){var r=e.Headers;if(!e.RestoreRequest){a(s.error(new Error("missing param RestoreRequest")));return}var c=e.RestoreRequest||{},v=s.json2xml({RestoreRequest:c});r["Content-Type"]="application/xml",r["Content-MD5"]=s.b64(s.md5(v)),X.call(this,{Action:"name/cos:RestoreObject",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,body:v,action:"restore",headers:r,tracker:e.tracker},a)}function E(e,a){var r=e.Tagging||{},c=r.TagSet||r.Tags||e.Tags||[];c=s.clone(s.isArray(c)?c:[c]);var v=s.json2xml({Tagging:{TagSet:{Tag:c}}}),p=e.Headers;p["Content-Type"]="application/xml",p["Content-MD5"]=s.b64(s.md5(v)),X.call(this,{Action:"name/cos:PutObjectTagging",method:"PUT",Bucket:e.Bucket,Key:e.Key,Region:e.Region,body:v,action:"tagging",headers:p,VersionId:e.VersionId,tracker:e.tracker},function(S,B){if(S&&S.statusCode===204)return a(null,{statusCode:S.statusCode});if(S)return a(S);a(null,{statusCode:B.statusCode,headers:B.headers})})}function I(e,a){X.call(this,{Action:"name/cos:GetObjectTagging",method:"GET",Key:e.Key,Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"tagging",VersionId:e.VersionId,tracker:e.tracker},function(r,c){if(r){if(r.statusCode===404&&r.error&&(r.error==="Not Found"||r.error.Code==="NoSuchTagSet")){var v={Tags:[],statusCode:r.statusCode};r.headers&&(v.headers=r.headers),a(null,v)}else a(r);return}var p=[];try{p=c.Tagging.TagSet.Tag||[]}catch{}p=s.clone(s.isArray(p)?p:[p]),a(null,{Tags:p,statusCode:c.statusCode,headers:c.headers})})}function q(e,a){X.call(this,{Action:"name/cos:DeleteObjectTagging",method:"DELETE",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,action:"tagging",VersionId:e.VersionId,tracker:e.tracker},function(r,c){if(r&&r.statusCode===204)return a(null,{statusCode:r.statusCode});if(r)return a(r);a(null,{statusCode:c.statusCode,headers:c.headers})})}function W(e,a){var r=e.SelectType;if(!r)return a(s.error(new Error("missing param SelectType")));var c=e.SelectRequest||{},v=s.json2xml({SelectRequest:c}),p=e.Headers;p["Content-Type"]="application/xml",p["Content-MD5"]=s.b64(s.md5(v)),X.call(this,{Action:"name/cos:GetObject",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,action:"select",qs:{"select-type":e.SelectType},VersionId:e.VersionId,body:v,DataType:"arraybuffer",rawBody:!0,tracker:e.tracker},function(S,B){if(S&&S.statusCode===204)return a(null,{statusCode:S.statusCode});if(S)return a(S);var _=s.parseSelectPayload(B.body);a(null,{statusCode:B.statusCode,headers:B.headers,Body:_.body,Payload:_.payload})})}function ee(e,a){var r=this,c=e.Headers,v=e.tracker;!c["Cache-Control"]&&!c["cache-control"]&&(c["Cache-Control"]=""),!c["Content-Type"]&&!c["content-type"]&&(c["Content-Type"]=e.Body&&e.Body.type||"");var p=e.Body&&(e.UploadAddMetaMd5||r.options.UploadAddMetaMd5);p&&v&&v.setParams({md5StartTime:new Date().getTime()}),s.getBodyMd5(p,e.Body,function(S){S&&(e.Headers["x-cos-meta-md5"]=S),p&&v&&v.setParams({md5EndTime:new Date().getTime()}),X.call(r,{Action:"name/cos:InitiateMultipartUpload",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,action:"uploads",headers:e.Headers,qs:e.Query,tracker:v},function(B,_){if(B)return v&&v.parent&&v.parent.setParams({errorNode:"multipartInit"}),a(B);if(_=s.clone(_||{}),_&&_.InitiateMultipartUploadResult)return a(null,s.extend(_.InitiateMultipartUploadResult,{statusCode:_.statusCode,headers:_.headers}));a(null,_)})},e.onHashProgress)}function he(e,a){var r=this;s.getFileSize("multipartUpload",e,function(){var c=e.tracker,v=r.options.UploadCheckContentMd5;v&&c&&c.setParams({md5StartTime:new Date().getTime()}),s.getBodyMd5(v,e.Body,function(p){p&&(e.Headers["Content-MD5"]=s.b64(p)),v&&c&&c.setParams({md5EndTime:new Date().getTime()}),c&&c.setParams({partNumber:e.PartNumber}),X.call(r,{Action:"name/cos:UploadPart",TaskId:e.TaskId,method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,qs:{partNumber:e.PartNumber,uploadId:e.UploadId},headers:e.Headers,onProgress:e.onProgress,body:e.Body||null,tracker:c},function(S,B){if(S)return c&&c.parent&&c.parent.setParams({errorNode:"multipartUpload"}),a(S);a(null,{ETag:s.attr(B.headers,"etag",""),statusCode:B.statusCode,headers:B.headers})})})})}function pe(e,a){for(var r=this,c=e.UploadId,v=e.Parts,p=e.tracker,S=0,B=v.length;S<B;S++)v[S].ETag&&v[S].ETag.indexOf('"')===0||(v[S].ETag='"'+v[S].ETag+'"');var _=s.json2xml({CompleteMultipartUpload:{Part:v}});_=_.replace(/\n\s*/g,"");var le=e.Headers;le["Content-Type"]="application/xml",le["Content-MD5"]=s.b64(s.md5(_)),X.call(this,{Action:"name/cos:CompleteMultipartUpload",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,qs:{uploadId:c},body:_,headers:le,tracker:p},function(ue,xe){if(ue)return p&&p.parent&&p.parent.setParams({errorNode:"multipartComplete"}),a(ue);var Q=He({ForcePathStyle:r.options.ForcePathStyle,protocol:r.options.Protocol,domain:r.options.Domain,bucket:e.Bucket,region:e.Region,object:e.Key,isLocation:!0}),Se=xe.CompleteMultipartUploadResult||{};if(Se.ProcessResults&&(Se.UploadResult={OriginalInfo:{Key:Se.Key,Location:Q,ETag:Se.ETag,ImageInfo:Se.ImageInfo},ProcessResults:Se.ProcessResults},delete Se.ImageInfo,delete Se.ProcessResults),Se.CallbackResult){var _e=Se.CallbackResult;if(_e.Status==="200"&&_e.CallbackBody)try{Se.CallbackBody=JSON.parse(s.decodeBase64(_e.CallbackBody))}catch{Se.CallbackBody={}}else Se.CallbackError=_e.Error||{};delete Se.CallbackResult}if(Se.ReturnBodyResult){var Ue=Se.ReturnBodyResult;if(Ue.Status==="200"&&Ue.ReturnBody)try{Se.ReturnBody=JSON.parse(s.decodeBase64(Ue.ReturnBody))}catch{Se.ReturnBody={}}else Se.ReturnError={Code:Ue.Code,Message:Ue.Message,Status:Ue.Status};delete Se.ReturnBodyResult}var Ke=s.extend(Se,{Location:Q,statusCode:xe.statusCode,headers:xe.headers});a(null,Ke)})}function Be(e,a){var r={};r.delimiter=e.Delimiter,r["encoding-type"]=e.EncodingType,r.prefix=e.Prefix||"",r["max-uploads"]=e.MaxUploads,r["key-marker"]=e.KeyMarker,r["upload-id-marker"]=e.UploadIdMarker,r=s.clearKey(r);var c=e.tracker;c&&c.setParams({signStartTime:new Date().getTime()}),X.call(this,{Action:"name/cos:ListMultipartUploads",ResourceKey:r.prefix,method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,qs:r,action:"uploads",tracker:c},function(v,p){if(v)return c&&c.parent&&c.parent.setParams({errorNode:"multipartList"}),a(v);if(p&&p.ListMultipartUploadsResult){var S=p.ListMultipartUploadsResult.Upload||[];S=s.isArray(S)?S:[S],p.ListMultipartUploadsResult.Upload=S}var B=s.clone(p.ListMultipartUploadsResult||{});s.extend(B,{statusCode:p.statusCode,headers:p.headers}),a(null,B)})}function Pe(e,a){var r={},c=e.tracker;r.uploadId=e.UploadId,r["encoding-type"]=e.EncodingType,r["max-parts"]=e.MaxParts,r["part-number-marker"]=e.PartNumberMarker,X.call(this,{Action:"name/cos:ListParts",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,qs:r,tracker:c},function(v,p){if(v)return c&&c.parent&&c.parent.setParams({errorNode:"multipartListPart"}),a(v);var S=p.ListPartsResult||{},B=S.Part||[];B=s.isArray(B)?B:[B],S.Part=B;var _=s.clone(S);s.extend(_,{statusCode:p.statusCode,headers:p.headers}),a(null,_)})}function Ie(e,a){var r={};r.uploadId=e.UploadId,X.call(this,{Action:"name/cos:AbortMultipartUpload",method:"DELETE",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,qs:r,tracker:e.tracker},function(c,v){if(c)return a(c);a(null,{statusCode:v.statusCode,headers:v.headers})})}function Ee(e,a){X.call(this,{method:e.Method,Bucket:e.Bucket,Region:e.Region,Key:e.Key,action:e.Action,headers:e.Headers,qs:e.Query,body:e.Body,Url:e.Url,rawBody:e.RawBody,DataType:e.DataType,tracker:e.tracker},function(r,c){if(r)return a(r);c&&c.body&&(c.Body=c.body,delete c.body),a(r,c)})}function Le(e,a){var r=e.Headers;!r["Cache-Control"]&&!r["cache-control"]&&(r["Cache-Control"]=""),!r["Content-Type"]&&!r["content-type"]&&(r["Content-Type"]=e.Body&&e.Body.type||""),X.call(this,{Action:"name/cos:AppendObject",method:"POST",Bucket:e.Bucket,Region:e.Region,action:"append",Key:e.Key,body:e.Body,qs:{position:e.Position},headers:e.Headers,tracker:e.tracker},function(c,v){if(c)return a(c);a(null,v)})}function Ze(e){var a=this;return s.getAuth({SecretId:e.SecretId||this.options.SecretId||"",SecretKey:e.SecretKey||this.options.SecretKey||"",Bucket:e.Bucket,Region:e.Region,Method:e.Method,Key:e.Key,Query:e.Query,Headers:e.Headers,Expires:e.Expires,UseRawKey:a.options.UseRawKey,SystemClockOffset:a.options.SystemClockOffset})}function Ve(e,a){var r=this,c=e.UseAccelerate===void 0?r.options.UseAccelerate:e.UseAccelerate,v=He({ForcePathStyle:r.options.ForcePathStyle,protocol:e.Protocol||r.options.Protocol,domain:e.Domain||r.options.Domain,bucket:e.Bucket,region:c?"accelerate":e.Region,object:e.Key}),p="";e.Query&&(p+=s.obj2str(e.Query)),e.QueryString&&(p+=(p?"&":"")+e.QueryString);var S=v;if(e.Sign!==void 0&&!e.Sign)return p&&(S+="?"+p),a(null,{Url:S}),S;var B=tt.call(this,{Bucket:e.Bucket,Region:e.Region,UseAccelerate:e.UseAccelerate,Url:v}),_=ot.call(this,{Action:(e.Method||"").toUpperCase()==="PUT"?"name/cos:PutObject":"name/cos:GetObject",Bucket:e.Bucket||"",Region:e.Region||"",Method:e.Method||"get",Key:e.Key,Expires:e.Expires,Headers:e.Headers,Query:e.Query,SignHost:B,ForceSignHost:e.ForceSignHost===!1?!1:r.options.ForceSignHost},function(le,ue){if(a){if(le){a(le);return}var xe=function(_e){var Ue=_e.match(/q-url-param-list.*?(?=&)/g)[0],Ke="q-url-param-list="+encodeURIComponent(Ue.replace(/q-url-param-list=/,"")).toLowerCase(),ze=new RegExp(Ue,"g"),De=_e.replace(ze,Ke);return De},Q=v;Q+="?"+(ue.Authorization.indexOf("q-signature")>-1?xe(ue.Authorization):"sign="+encodeURIComponent(ue.Authorization)),ue.SecurityToken&&(Q+="&x-cos-security-token="+ue.SecurityToken),ue.ClientIP&&(Q+="&clientIP="+ue.ClientIP),ue.ClientUA&&(Q+="&clientUA="+ue.ClientUA),ue.Token&&(Q+="&token="+ue.Token),p&&(Q+="&"+p),setTimeout(function(){a(null,{Url:Q})})}});return _?(S+="?"+_.Authorization+(_.SecurityToken?"&x-cos-security-token="+_.SecurityToken:""),p&&(S+="&"+p)):p&&(S+="?"+p),S}function Re(e){var a={GrantFullControl:[],GrantWrite:[],GrantRead:[],GrantReadAcp:[],GrantWriteAcp:[],ACL:""},r={FULL_CONTROL:"GrantFullControl",WRITE:"GrantWrite",READ:"GrantRead",READ_ACP:"GrantReadAcp",WRITE_ACP:"GrantWriteAcp"},c=e&&e.AccessControlList||{},v=c.Grant;v&&(v=s.isArray(v)?v:[v]);var p={READ:0,WRITE:0,FULL_CONTROL:0};return v&&v.length&&s.each(v,function(S){var B=S.Grantee.URI&&S.Grantee.URI.endsWith("/groups/global/AllUsers");S.Grantee.ID==="qcs::cam::anyone:anyone"||B?p[S.Permission]=1:S.Grantee.ID!==e.Owner.ID&&a[r[S.Permission]].push('id="'+S.Grantee.ID+'"')}),p.FULL_CONTROL||p.WRITE&&p.READ?a.ACL="public-read-write":p.READ?a.ACL="public-read":a.ACL="private",s.each(r,function(S){a[S]=Ge(a[S].join(","))}),a}function Ge(e){var a=e.split(","),r={},c,v;for(c=0;c<a.length;)v=a[c].trim(),r[v]?a.splice(c,1):(r[v]=!0,a[c]=v,c++);return a.join(",")}function He(e){var a=e.region||"",r=e.bucket||"",c=r.substr(0,r.lastIndexOf("-")),v=r.substr(r.lastIndexOf("-")+1),p=e.domain,S=e.object;typeof p=="function"&&(p=p({Bucket:r,Region:a})),["http","https"].includes(e.protocol)&&(e.protocol=e.protocol+":");var B=e.protocol||(s.isBrowser&&(typeof location>"u"?"undefined":F(location))==="object"&&location.protocol==="http:"?"http:":"https:");p||(["cn-south","cn-south-2","cn-north","cn-east","cn-southwest","sg"].indexOf(a)>-1?p="{Region}.myqcloud.com":p="cos.{Region}.myqcloud.com",e.ForcePathStyle||(p="{Bucket}."+p)),p=p.replace(/\{\{AppId\}\}/gi,v).replace(/\{\{Bucket\}\}/gi,c).replace(/\{\{Region\}\}/gi,a).replace(/\{\{.*?\}\}/gi,""),p=p.replace(/\{AppId\}/gi,v).replace(/\{BucketName\}/gi,c).replace(/\{Bucket\}/gi,r).replace(/\{Region\}/gi,a).replace(/\{.*?\}/gi,""),/^[a-zA-Z]+:\/\//.test(p)||(p=B+"//"+p),p.slice(-1)==="/"&&(p=p.slice(0,-1));var _=p;return e.ForcePathStyle&&(_+="/"+r),_+="/",S&&(_+=s.camSafeUrlEncode(S).replace(/%2F/g,"/")),e.isLocation&&(_=_.replace(/^https?:\/\//,"")),_}var tt=function(a){if(!a.Bucket||!a.Region)return"";var r=a.UseAccelerate===void 0?this.options.UseAccelerate:a.UseAccelerate,c=a.Url||He({ForcePathStyle:this.options.ForcePathStyle,protocol:this.options.Protocol,domain:this.options.Domain,bucket:a.Bucket,region:r?"accelerate":a.Region}),v=c.replace(/^https?:\/\/([^/]+)(\/.*)?$/,"$1");return v};function ot(e,a){var r=s.clone(e.Headers),c="";s.each(r,function(be,Ce){(be===""||["content-type","cache-control","expires"].indexOf(Ce.toLowerCase())>-1)&&delete r[Ce],Ce.toLowerCase()==="host"&&(c=be)});var v=e.ForceSignHost!==!1;!c&&e.SignHost&&v&&(r.Host=e.SignHost);var p=!1,S=function(Ce,ve){p||(p=!0,ve&&ve.XCosSecurityToken&&!ve.SecurityToken&&(ve=s.clone(ve),ve.SecurityToken=ve.XCosSecurityToken,delete ve.XCosSecurityToken),a&&a(Ce,ve))},B=this,_=e.Bucket||"",le=e.Region||"",ue=e.Key||"";B.options.ForcePathStyle&&_&&(ue=_+"/"+ue);var xe="/"+ue,Q={},Se=e.Scope;if(!Se){var _e=e.Action||"",Ue=e.ResourceKey||e.Key||"";Se=e.Scope||[{action:_e,bucket:_,region:le,prefix:Ue}]}var Ke=s.md5(JSON.stringify(Se));B._StsCache=B._StsCache||[],function(){var be,Ce;for(be=B._StsCache.length-1;be>=0;be--){Ce=B._StsCache[be];var ve=Math.round(s.getSkewTime(B.options.SystemClockOffset)/1e3)+30;if(Ce.StartTime&&ve<Ce.StartTime||ve>=Ce.ExpiredTime){B._StsCache.splice(be,1);continue}if(!Ce.ScopeLimit||Ce.ScopeLimit&&Ce.ScopeKey===Ke){Q=Ce;break}}}();var ze=function(){var Ce="";Q.StartTime&&e.Expires?Ce=Q.StartTime+";"+(Q.StartTime+e.Expires*1):Q.StartTime&&Q.ExpiredTime&&(Ce=Q.StartTime+";"+Q.ExpiredTime);var ve=s.getAuth({SecretId:Q.TmpSecretId,SecretKey:Q.TmpSecretKey,Method:e.Method,Pathname:xe,Query:e.Query,Headers:r,Expires:e.Expires,UseRawKey:B.options.UseRawKey,SystemClockOffset:B.options.SystemClockOffset,KeyTime:Ce,ForceSignHost:v}),Ae={Authorization:ve,SecurityToken:Q.SecurityToken||Q.XCosSecurityToken||"",Token:Q.Token||"",ClientIP:Q.ClientIP||"",ClientUA:Q.ClientUA||"",SignFrom:"client"};S(null,Ae)},De=function(Ce){if(Ce.Authorization){var ve=!1,Ae=Ce.Authorization;if(Ae)if(Ae.indexOf(" ")>-1)ve=!1;else if(Ae.indexOf("q-sign-algorithm=")>-1&&Ae.indexOf("q-ak=")>-1&&Ae.indexOf("q-sign-time=")>-1&&Ae.indexOf("q-key-time=")>-1&&Ae.indexOf("q-url-param-list=")>-1)ve=!0;else try{Ae=atob(Ae),Ae.indexOf("a=")>-1&&Ae.indexOf("k=")>-1&&Ae.indexOf("t=")>-1&&Ae.indexOf("r=")>-1&&Ae.indexOf("b=")>-1&&(ve=!0)}catch{}if(!ve)return s.error(new Error("getAuthorization callback params format error"))}else{if(!Ce.TmpSecretId)return s.error(new Error('getAuthorization callback params missing "TmpSecretId"'));if(!Ce.TmpSecretKey)return s.error(new Error('getAuthorization callback params missing "TmpSecretKey"'));if(!Ce.SecurityToken&&!Ce.XCosSecurityToken)return s.error(new Error('getAuthorization callback params missing "SecurityToken"'));if(!Ce.ExpiredTime)return s.error(new Error('getAuthorization callback params missing "ExpiredTime"'));if(Ce.ExpiredTime&&Ce.ExpiredTime.toString().length!==10)return s.error(new Error('getAuthorization callback params "ExpiredTime" should be 10 digits'));if(Ce.StartTime&&Ce.StartTime.toString().length!==10)return s.error(new Error('getAuthorization callback params "StartTime" should be 10 StartTime'))}return!1};if(Q.ExpiredTime&&Q.ExpiredTime-s.getSkewTime(B.options.SystemClockOffset)/1e3>60)ze();else if(B.options.getAuthorization)B.options.getAuthorization.call(B,{Bucket:_,Region:le,Method:e.Method,Key:ue,Pathname:xe,Query:e.Query,Headers:r,Scope:Se,SystemClockOffset:B.options.SystemClockOffset,ForceSignHost:v},function(be){typeof be=="string"&&(be={Authorization:be});var Ce=De(be);if(Ce)return S(Ce);be.Authorization?S(null,be):(Q=be||{},Q.Scope=Se,Q.ScopeKey=Ke,B._StsCache.push(Q),ze())});else if(B.options.getSTS)B.options.getSTS.call(B,{Bucket:_,Region:le},function(be){Q=be||{},Q.Scope=Se,Q.ScopeKey=Ke,Q.TmpSecretId||(Q.TmpSecretId=Q.SecretId),Q.TmpSecretKey||(Q.TmpSecretKey=Q.SecretKey);var Ce=De(Q);if(Ce)return S(Ce);B._StsCache.push(Q),ze()});else return function(){var be="";if(B.options.StartTime&&e.Expires){if(B.options.StartTime.toString().length!==10)return S(s.error(new Error('params "StartTime" should be 10 digits')));be=B.options.StartTime+";"+(B.options.StartTime+e.Expires*1)}else if(B.options.StartTime&&B.options.ExpiredTime){if(B.options.StartTime.toString().length!==10)return S(s.error(new Error('params "StartTime" should be 10 digits')));if(B.options.ExpiredTime.toString().length!==10)return S(s.error(new Error('params "ExpiredTime" should be 10 digits')));be=B.options.StartTime+";"+B.options.ExpiredTime*1}var Ce=s.getAuth({SecretId:e.SecretId||B.options.SecretId,SecretKey:e.SecretKey||B.options.SecretKey,Method:e.Method,Pathname:xe,Query:e.Query,Headers:r,Expires:e.Expires,KeyTime:be,UseRawKey:B.options.UseRawKey,SystemClockOffset:B.options.SystemClockOffset,ForceSignHost:v}),ve={Authorization:Ce,SecurityToken:B.options.SecurityToken||B.options.XCosSecurityToken,SignFrom:"client"};return S(null,ve),ve}();return""}function ft(e){var a=this,r=!1,c=!1,v=!1,p=e.headers&&(e.headers.date||e.headers.Date)||e.error&&e.error.ServerTime;try{var S=e.error.Code,B=e.error.Message;(S==="RequestTimeTooSkewed"||S==="AccessDenied"&&B==="Request has expired")&&(c=!0)}catch{}if(e)if(c&&p){var _=Date.parse(p);this.options.CorrectClockSkew&&Math.abs(s.getSkewTime(this.options.SystemClockOffset)-_)>=3e4&&(console.error("error: Local time is too skewed."),this.options.SystemClockOffset=_-Date.now(),r=!0)}else Math.floor(e.statusCode/100)===5?r=!0:e.message==="CORS blocked or network error"&&(v=!0,r=a.options.AutoSwitchHost);return{canRetry:r,networkError:v}}function ht(e){var a=e.requestUrl,r=e.clientCalcSign,c=e.networkError;if(!this.options.AutoSwitchHost||!a||!r||!c)return!1;var v=/^https?:\/\/[^\/]*\.cos\.[^\/]*\.myqcloud\.com(\/.*)?$/,p=/^https?:\/\/[^\/]*\.cos\.accelerate\.myqcloud\.com(\/.*)?$/,S=v.test(a)&&!p.test(a);return S}function X(e,a){var r=this;!e.headers&&(e.headers={}),!e.qs&&(e.qs={}),e.VersionId&&(e.qs.versionId=e.VersionId),e.qs=s.clearKey(e.qs),e.headers&&(e.headers=s.clearKey(e.headers)),e.qs&&(e.qs=s.clearKey(e.qs));var c=s.clone(e.qs);e.action&&(c[e.action]="");var v=e.url||e.Url,p=e.SignHost||tt.call(this,{Bucket:e.Bucket,Region:e.Region,Url:v}),S=e.tracker,B=function _(le){var ue=r.options.SystemClockOffset;S&&S.setParams({signStartTime:new Date().getTime(),httpRetryTimes:le-1}),e.SwitchHost&&(p=p.replace(/myqcloud.com/,"tencentcos.cn")),ot.call(r,{Bucket:e.Bucket||"",Region:e.Region||"",Method:e.method,Key:e.Key,Query:c,Headers:e.headers,SignHost:p,Action:e.Action,ResourceKey:e.ResourceKey,Scope:e.Scope,ForceSignHost:r.options.ForceSignHost,SwitchHost:e.SwitchHost},function(xe,Q){if(xe){a(xe);return}S&&S.setParams({signEndTime:new Date().getTime(),httpStartTime:new Date().getTime()}),e.AuthData=Q,gt.call(r,e,function(Se,_e){S&&S.setParams({httpEndTime:new Date().getTime()});var Ue=!1,Ke=!1;if(Se){var ze=ft.call(r,Se);Ue=ze.canRetry||ue!==r.options.SystemClockOffset,Ke=ze.networkError}if(Se&&le<2&&Ue){e.headers&&(delete e.headers.Authorization,delete e.headers.token,delete e.headers.clientIP,delete e.headers.clientUA,e.headers["x-cos-security-token"]&&delete e.headers["x-cos-security-token"],e.headers["x-ci-security-token"]&&delete e.headers["x-ci-security-token"]);var De=ht.call(r,{requestUrl:(Se==null?void 0:Se.url)||"",clientCalcSign:Q.SignFrom==="client",networkError:Ke});e.SwitchHost=De,e.retry=!0,_(le+1)}else a(Se,_e)})})};B(1)}function gt(e,a){var r=this,c=e.TaskId;if(!(c&&!r._isRunningTask(c))){var v=e.Bucket,p=e.Region,S=e.Key,B=e.method||"GET",_=e.Url||e.url,le=e.body,ue=e.rawBody;r.options.UseAccelerate&&(p="accelerate"),_=_||He({ForcePathStyle:r.options.ForcePathStyle,protocol:r.options.Protocol,domain:r.options.Domain,bucket:v,region:p,object:S}),e.SwitchHost&&(_=_.replace(/myqcloud.com/,"tencentcos.cn"));var xe=S?_:"";e.action&&(_=_+"?"+(s.isIOS_QQ?"".concat(e.action,"="):e.action)),e.qsStr&&(_.indexOf("?")>-1?_=_+"&"+e.qsStr:_=_+"?"+e.qsStr);var Q={method:B,url:_,headers:e.headers,qs:e.qs,body:le},Se="x-cos-security-token";if(s.isCIHost(_)&&(Se="x-ci-security-token"),Q.headers.Authorization=e.AuthData.Authorization,e.AuthData.Token&&(Q.headers.token=e.AuthData.Token),e.AuthData.ClientIP&&(Q.headers.clientIP=e.AuthData.ClientIP),e.AuthData.ClientUA&&(Q.headers.clientUA=e.AuthData.ClientUA),e.AuthData.SecurityToken&&(Q.headers[Se]=e.AuthData.SecurityToken),Q.headers&&(Q.headers=s.clearKey(Q.headers)),e.retry&&(Q.headers["x-cos-sdk-retry"]=!0),Q=s.clearKey(Q),e.onProgress&&typeof e.onProgress=="function"){var _e=le&&(le.size||le.length)||0;Q.onProgress=function(ve){if(!(c&&!r._isRunningTask(c))){var Ae=ve?ve.loaded:0;e.onProgress({loaded:Ae,total:_e})}}}e.onDownloadProgress&&(Q.onDownloadProgress=e.onDownloadProgress),e.DataType&&(Q.dataType=e.DataType),this.options.Timeout&&(Q.timeout=this.options.Timeout),r.options.ForcePathStyle&&(Q.pathStyle=r.options.ForcePathStyle),r.emit("before-send",Q);var Ue=Q.url.includes("accelerate."),Ke=Q.qs?Object.keys(Q.qs).map(function(ve){return"".concat(ve,"=").concat(Q.qs[ve])}).join("&"):"",ze=Ke?Q.url+"?"+Ke:Q.url;if(e.tracker){var De;e.tracker.setParams({url:ze,httpMethod:Q.method,accelerate:Ue,httpSize:((De=Q.body)===null||De===void 0?void 0:De.size)||0}),e.tracker.parent&&!e.tracker.parent.params.url&&e.tracker.parent.setParams({url:xe,accelerate:Ue})}var be=(r.options.Request||O)(Q,function(ve){if(!(ve&&ve.error==="abort")){var Ae={options:Q,error:ve&&ve.error,statusCode:ve&&ve.statusCode||0,statusMessage:ve&&ve.statusMessage||"",headers:ve&&ve.headers||{},body:ve&&ve.body};r.emit("after-receive",Ae);var pt=Ae.error,it=Ae.body,Xe={statusCode:Ae.statusCode,statusMessage:Ae.statusMessage,headers:Ae.headers},kt,Ye=function(et,we){if(c&&r.off("inner-kill-task",Ce),!kt){kt=!0;var nt={};if(Xe&&Xe.statusCode&&(nt.statusCode=Xe.statusCode),Xe&&Xe.headers&&(nt.headers=Xe.headers),et)Q.url&&(nt.url=Q.url),Q.method&&(nt.method=Q.method),et=s.extend(et||{},nt),a(et,null);else{if(e.Action==="name/cos:PutObject"){var yt={};for(var Tt in e.headers){var At=Tt.toLowerCase();yt[At]=e.headers[Tt]}yt["x-cos-callback"]?we.Error?(we.CallbackError=s.clone(we.Error),delete we.Error):we.CallbackBody=s.clone(we):yt["x-cos-return-body"]&&(we.Error?(we.ReturnError=s.clone(we.Error),delete we.Error):we.ReturnBody=s.clone(we))}we=s.extend(we||{},nt),a(null,we)}be=null}};if(pt)return Ye(s.error(pt));var st=Xe.statusCode,St=Math.floor(st/100)===2;if(ue){if(St)return Ye(null,{body:it});if(it instanceof Blob){s.readAsBinaryString(it,function(xt){var et=s.parseResBody(xt),we=et.Error||et;return Ye(s.error(new Error(we.Message||"response body error"),{code:we.Code,error:we}))});return}}var vt=s.parseResBody(it),ut=vt.Error||vt;St?Ye(null,vt):ut?Ye(s.error(new Error(ut.Message),{code:ut.Code,error:ut})):st?Ye(s.error(new Error(Xe.statusMessage),{code:""+st})):st&&Ye(s.error(new Error("statusCode error")))}}),Ce=function ve(Ae){Ae.TaskId===c&&(be&&be.abort&&be.abort(),r.off("inner-kill-task",ve))};c&&r.on("inner-kill-task",Ce)}}var Ct={getService:j,putBucket:b,headBucket:M,getBucket:f,deleteBucket:d,putBucketAcl:m,getBucketAcl:h,putBucketCors:C,getBucketCors:A,deleteBucketCors:R,getBucketLocation:N,getBucketPolicy:z,putBucketPolicy:U,deleteBucketPolicy:G,putBucketTagging:g,getBucketTagging:l,deleteBucketTagging:x,putBucketLifecycle:n,getBucketLifecycle:o,deleteBucketLifecycle:t,putBucketVersioning:i,getBucketVersioning:u,putBucketReplication:y,getBucketReplication:L,deleteBucketReplication:k,putBucketWebsite:w,getBucketWebsite:$,deleteBucketWebsite:D,putBucketReferer:se,getBucketReferer:oe,putBucketDomain:Y,getBucketDomain:ae,deleteBucketDomain:fe,putBucketOrigin:ie,getBucketOrigin:J,deleteBucketOrigin:V,putBucketLogging:Z,getBucketLogging:de,putBucketInventory:te,postBucketInventory:ne,getBucketInventory:ye,listBucketInventory:ge,deleteBucketInventory:ke,putBucketAccelerate:me,getBucketAccelerate:Te,putBucketEncryption:Oe,getBucketEncryption:qe,deleteBucketEncryption:je,getObject:Me,headObject:We,listObjectVersions:Je,putObject:Qe,deleteObject:rt,getObjectAcl:ct,putObjectAcl:at,optionsObject:lt,putObjectCopy:dt,deleteMultipleObject:K,restoreObject:T,putObjectTagging:E,getObjectTagging:I,deleteObjectTagging:q,selectObjectContent:W,appendObject:Le,uploadPartCopy:Fe,multipartInit:ee,multipartUpload:he,multipartComplete:pe,multipartList:Be,multipartListPart:Pe,multipartAbort:Ie,request:Ee,getObjectUrl:Ve,getAuth:Ze};function bt(e,a,r){s.each(["Cors","Acl"],function(c){if(e.slice(-c.length)===c){var v=e.slice(0,-c.length)+c.toUpperCase(),p=s.apiWrapper(e,a),S=!1;r[v]=function(){!S&&console.warn("warning: cos."+v+" has been deprecated. Please Use cos."+e+" instead."),S=!0,p.apply(this,arguments)}}})}H.exports.init=function(e,a){a.transferToTaskMethod(Ct,"putObject"),s.each(Ct,function(r,c){e.prototype[c]=s.apiWrapper(c,r),bt(c,r,e.prototype)})}},"./src/cos.js":function(H,re,P){var F=P("./src/util.js"),O=P("./src/event.js"),s=P("./src/task.js"),j=P("./src/base.js"),b=P("./src/advance.js"),M=P("./package.json"),f={AppId:"",SecretId:"",SecretKey:"",SecurityToken:"",StartTime:0,ExpiredTime:0,ChunkRetryTimes:2,FileParallelLimit:3,ChunkParallelLimit:3,ChunkSize:1024*1024,SliceSize:1024*1024,CopyChunkParallelLimit:20,CopyChunkSize:1024*1024*10,CopySliceSize:1024*1024*10,MaxPartNumber:1e4,ProgressInterval:1e3,Domain:"",ServiceDomain:"",Protocol:"",CompatibilityMode:!1,ForcePathStyle:!1,UseRawKey:!1,Timeout:0,CorrectClockSkew:!0,SystemClockOffset:0,UploadCheckContentMd5:!1,UploadQueueSize:1e4,UploadAddMetaMd5:!1,UploadIdCacheLimit:50,UseAccelerate:!1,ForceSignHost:!0,AutoSwitchHost:!0,CopySourceParser:null,ObjectKeySimplifyCheck:!0,DeepTracker:!1,TrackerDelay:5e3,CustomId:"",BeaconReporter:null,ClsReporter:null},d=function(h){if(this.options=F.extend(F.clone(f),h||{}),this.options.FileParallelLimit=Math.max(1,this.options.FileParallelLimit),this.options.ChunkParallelLimit=Math.max(1,this.options.ChunkParallelLimit),this.options.ChunkRetryTimes=Math.max(0,this.options.ChunkRetryTimes),this.options.ChunkSize=Math.max(1024*1024,this.options.ChunkSize),this.options.CopyChunkParallelLimit=Math.max(1,this.options.CopyChunkParallelLimit),this.options.CopyChunkSize=Math.max(1024*1024,this.options.CopyChunkSize),this.options.CopySliceSize=Math.max(0,this.options.CopySliceSize),this.options.MaxPartNumber=Math.max(1024,Math.min(1e4,this.options.MaxPartNumber)),this.options.Timeout=Math.max(0,this.options.Timeout),this.options.EnableReporter=this.options.BeaconReporter||this.options.ClsReporter,this.options.AppId&&console.warn('warning: AppId has been deprecated, Please put it at the end of parameter Bucket(E.g: "test-1250000000").'),this.options.SecretId&&this.options.SecretId.indexOf(" ")>-1&&(console.error("error: SecretId格式错误，请检查"),console.error("error: SecretId format is incorrect. Please check")),this.options.SecretKey&&this.options.SecretKey.indexOf(" ")>-1&&(console.error("error: SecretKey格式错误，请检查"),console.error("error: SecretKey format is incorrect. Please check")),F.isNode()&&(console.log("Tip: Next.js、Nuxt.js 等服务端渲染技术可正常使用JavaScript SDK，请忽略下方 nodejs 环境警告"),console.warn("warning: cos-js-sdk-v5 不支持 nodejs 环境使用，请改用 cos-nodejs-sdk-v5，参考文档： https://cloud.tencent.com/document/product/436/8629"),console.warn("warning: cos-js-sdk-v5 does not support nodejs environment. Please use cos-nodejs-sdk-v5 instead. See: https://cloud.tencent.com/document/product/436/8629")),this.options.ForcePathStyle)throw console.warn("cos-js-sdk-v5不再支持使用path-style，仅支持使用virtual-hosted-style，参考文档：https://cloud.tencent.com/document/product/436/96243"),new Error("ForcePathStyle is not supported");O.init(this),s.init(this)};j.init(d,s),b.init(d,s),d.util={md5:F.md5,xml2json:F.xml2json,json2xml:F.json2xml,encodeBase64:F.encodeBase64},d.getAuthorization=F.getAuth,d.version=M.version,H.exports=d},"./src/event.js":function(H,re){var P=function(s){var j={},b=function(f){return!j[f]&&(j[f]=[]),j[f]};s.on=function(M,f){M==="task-list-update"&&console.warn('warning: Event "'+M+'" has been deprecated. Please use "list-update" instead.'),b(M).push(f)},s.off=function(M,f){for(var d=b(M),m=d.length-1;m>=0;m--)f===d[m]&&d.splice(m,1)},s.emit=function(M,f){for(var d=b(M).map(function(h){return h}),m=0;m<d.length;m++)d[m](f)}},F=function(){P(this)};H.exports.init=P,H.exports.EventProxy=F},"./src/session.js":function(H,re,P){var F=P("./src/util.js"),O="cos_sdk_upload_cache",s=30*24*3600,j,b,M=function(){try{var A=JSON.parse(localStorage.getItem(O))}catch{}A||(A=[]),j=A},f=function(){try{j.length?localStorage.setItem(O,JSON.stringify(j)):localStorage.removeItem(O)}catch{}},d=function(){if(!j){M.call(this);for(var A=!1,R=Math.round(Date.now()/1e3),N=j.length-1;N>=0;N--){var U=j[N][2];(!U||U+s<R)&&(j.splice(N,1),A=!0)}A&&f()}},m=function(){b||(b=setTimeout(function(){f(),b=null},400))},h={using:{},setUsing:function(A){h.using[A]=!0},removeUsing:function(A){delete h.using[A]},getFileId:function(A,R,N,U){return A.name&&A.size&&A.lastModifiedDate&&R?F.md5([A.name,A.size,A.lastModifiedDate,R,N,U].join("::")):null},getCopyFileId:function(A,R,N,U,z){var G=R["content-length"],g=R.etag||"",l=R["last-modified"];return A&&N?F.md5([A,G,g,l,N,U,z].join("::")):null},getUploadIdList:function(A){if(!A)return null;d.call(this);for(var R=[],N=0;N<j.length;N++)j[N][0]===A&&R.push(j[N][1]);return R.length?R:null},saveUploadId:function(A,R,N){if(d.call(this),!!A){for(var U=j.length-1;U>=0;U--){var z=j[U];z[0]===A&&z[1]===R&&j.splice(U,1)}j.unshift([A,R,Math.round(Date.now()/1e3)]),j.length>N&&j.splice(N),m()}},removeUploadId:function(A){d.call(this),delete h.using[A];for(var R=j.length-1;R>=0;R--)j[R][1]===A&&j.splice(R,1);m()}};H.exports=h},"./src/task.js":function(H,re,P){var F=P("./src/session.js"),O=P("./src/util.js"),s={},j=function(f,d){s[d]=f[d],f[d]=function(m,h){m.SkipTask?s[d].call(this,m,h):this._addTask(d,m,h)}},b=function(f){var d=[],m={},h=0,C=0,A=function(l){var x={id:l.id,Bucket:l.Bucket,Region:l.Region,Key:l.Key,FilePath:l.FilePath,state:l.state,loaded:l.loaded,size:l.size,speed:l.speed,percent:l.percent,hashPercent:l.hashPercent,error:l.error};return l.FilePath&&(x.FilePath=l.FilePath),l._custom&&(x._custom=l._custom),x},R=function(){var g,l=function(){g=0,f.emit("task-list-update",{list:O.map(d,A)}),f.emit("list-update",{list:O.map(d,A)})};return function(){g||(g=setTimeout(l))}}(),N=function(){if(!(d.length<=f.options.UploadQueueSize)){for(var l=0;l<C&&l<d.length&&d.length>f.options.UploadQueueSize;){var x=d[l].state==="waiting"||d[l].state==="checking"||d[l].state==="uploading";!d[l]||!x?(m[d[l].id]&&delete m[d[l].id],d.splice(l,1),C--):l++}R()}},U=function g(){if(!(h>=f.options.FileParallelLimit)){for(;d[C]&&d[C].state!=="waiting";)C++;if(!(C>=d.length)){var l=d[C];C++,h++,l.state="checking",l.params.onTaskStart&&l.params.onTaskStart(A(l)),!l.params.UploadData&&(l.params.UploadData={});var x=O.formatParams(l.api,l.params);s[l.api].call(f,x,function(n,o){f._isRunningTask(l.id)&&((l.state==="checking"||l.state==="uploading")&&(l.state=n?"error":"success",n&&(l.error=n),h--,R(),g(),l.callback&&l.callback(n,o),l.state==="success"&&(l.params&&(delete l.params.UploadData,delete l.params.Body,delete l.params),delete l.callback)),N())}),R(),setTimeout(g)}}},z=function(l,x){var n=m[l];if(n){var o=n&&n.state==="waiting",t=n&&(n.state==="checking"||n.state==="uploading");if(x==="canceled"&&n.state!=="canceled"||x==="paused"&&o||x==="paused"&&t){n.state=x,f.emit("inner-kill-task",{TaskId:l,toState:x});try{var i=n&&n.params&&n.params.UploadData.UploadId}catch{}x==="canceled"&&i&&F.removeUsing(i),R(),t&&(h--,U()),x==="canceled"&&(n.params&&(delete n.params.UploadData,delete n.params.Body,delete n.params),delete n.callback)}N()}};f._addTasks=function(g){O.each(g,function(l){f._addTask(l.api,l.params,l.callback,!0)}),R()};var G=!0;f._addTask=function(g,l,x,n){l=O.formatParams(g,l);var o=O.uuid();l.TaskId=o,l.onTaskReady&&l.onTaskReady(o),l.TaskReady&&(l.TaskReady(o),G&&console.warn('warning: Param "TaskReady" has been deprecated. Please use "onTaskReady" instead.'),G=!1);var t={params:l,callback:x,api:g,index:d.length,id:o,Bucket:l.Bucket,Region:l.Region,Key:l.Key,FilePath:l.FilePath||"",state:"waiting",loaded:0,size:0,speed:0,percent:0,hashPercent:0,error:null,_custom:l._custom},i=l.onHashProgress;l.onHashProgress=function(y){f._isRunningTask(t.id)&&(t.hashPercent=y.percent,i&&i(y),R())};var u=l.onProgress;return l.onProgress=function(y){f._isRunningTask(t.id)&&(t.state==="checking"&&(t.state="uploading"),t.loaded=y.loaded,t.speed=y.speed,t.percent=y.percent,u&&u(y),R())},O.getFileSize(g,l,function(y,L){if(y)return x(O.error(y));m[o]=t,d.push(t),t.size=L,!n&&R(),U(),N()}),o},f._isRunningTask=function(g){var l=m[g];return!!(l&&(l.state==="checking"||l.state==="uploading"))},f.getTaskList=function(){return O.map(d,A)},f.cancelTask=function(g){z(g,"canceled")},f.pauseTask=function(g){z(g,"paused")},f.restartTask=function(g){var l=m[g];l&&(l.state==="paused"||l.state==="error")&&(l.state="waiting",R(),C=Math.min(C,l.index),U())},f.isUploadRunning=function(){return h||C<d.length}};H.exports.transferToTaskMethod=j,H.exports.init=b},"./src/tracker.js":function(H,re,P){var F=P("./node_modules/@babel/runtime/helpers/classCallCheck.js"),O=P("./node_modules/@babel/runtime/helpers/createClass.js"),s=P("./node_modules/@babel/runtime/helpers/typeof.js"),j=P("./package.json"),b=null,M=function(x,n){if(!b){if(typeof x!="function")throw new Error("Beacon not found");b=new x({appkey:"0WEB05PY6MHRGK0U",versionCode:j.version,channelID:"js_sdk",openid:"openid",unionid:"unid",strictMode:!1,delay:n,sessionDuration:60*1e3})}return b},f=function(x){return!x||x<0?0:(x/1e3).toFixed(3)},d={getUid:function(){var x=function(){return((1+Math.random())*65536|0).toString(16).substring(1)};return x()+x()+"-"+x()+"-"+x()+"-"+x()+"-"+x()+x()+x()},getNetType:function(){if((typeof navigator>"u"?"undefined":s(navigator))==="object"){var x=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return(x==null?void 0:x.type)||(x==null?void 0:x.effectiveType)||"unknown"}return"unknown"},getProtocol:function(){return(typeof location>"u"?"undefined":s(location))==="object"?location.protocol.replace(/:/,""):"unknown protocol"},getOsType:function(){if((typeof navigator>"u"?"undefined":s(navigator))!=="object")return"unknown os";var x=navigator.userAgent.toLowerCase(),n=/macintosh|mac os x/i.test(navigator.userAgent);return x.indexOf("win32")>=0||x.indexOf("wow32")>=0?"win32":x.indexOf("win64")>=0||x.indexOf("wow64")>=0?"win64":n?"mac":"unknown os"},isMobile:function(){var x=/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i;return!!((typeof navigator>"u"?"undefined":s(navigator))==="object"&&navigator.userAgent.match(x))},isAndroid:function(){var x=/(Android|Adr|Linux)/i;return!!((typeof navigator>"u"?"undefined":s(navigator))==="object"&&navigator.userAgent.match(x))},isIOS:function(){var x=/(iPhone|iPod|iPad|iOS)/i;return!!((typeof navigator>"u"?"undefined":s(navigator))==="object"&&navigator.userAgent.match(x))},isOtherMobile:function(){return m&&!isAndroid&&!isIOS},getUA:function(){if((typeof navigator>"u"?"undefined":s(navigator))!=="object")return"unknown device";var x=navigator.userAgent;return x}},m=d.isMobile(),h=d.isAndroid()?"android":d.isIOS?"ios":"other_mobile",C=d.getOsType(),A=m?h:C,R=d.getUA(),N=d.getProtocol(),U=function(x){return["putObject","sliceUploadFile","uploadFile","uploadFiles"].includes(x)?"UploadTask":x==="getObject"?"DownloadTask":["putObjectCopy","sliceCopyFile"].includes(x)?"CopyTask":x};function z(l){return l.replace(/([A-Z])/g,"_$1").toLowerCase()}function G(l){var x={},n=["sdkVersionName","sdkVersionCode","osName","networkType","requestName","requestResult","bucket","region","appid","accelerate","url","host","requestPath","userAgent","networkProtocol","httpMethod","httpSize","httpSpeed","httpTookTime","httpMd5","httpSign","httpFullTime","httpDomain","partNumber","httpRetryTimes","customId","traceId","realApi"],o=[].concat(n,["errorNode","errorCode","errorName","errorMessage","errorRequestId","errorHttpCode","errorServiceName","errorType","fullError"]),t=l.requestResult==="Success"?n:o;for(var i in l)if(t.includes(i)){var u=z(i);x[u]=l[i]}return x.request_name=l.realApi?U(l.realApi):l.requestName,x}var g=function(){function l(x){F(this,l);var n=x.parent,o=x.traceId,t=x.bucket,i=x.region,u=x.apiName,y=x.realApi,L=x.httpMethod,k=x.fileKey,w=x.fileSize,$=x.accelerate,D=x.customId,se=x.delay,oe=x.deepTracker,Y=x.Beacon,ae=x.clsReporter,fe=t&&t.substr(t.lastIndexOf("-")+1)||"";this.parent=n,this.deepTracker=oe,this.delay=se,ae&&!this.clsReporter&&(this.clsReporter=ae),this.params={sdkVersionName:"cos-js-sdk-v5",sdkVersionCode:j.version,osName:A,networkType:"",requestName:u||"",requestResult:"",realApi:y,bucket:t,region:i,accelerate:$,httpMethod:L,url:"",host:"",httpDomain:"",requestPath:k||"",userAgent:R,networkProtocol:N,errorType:"",errorCode:"",errorName:"",errorMessage:"",errorRequestId:"",errorHttpCode:0,errorServiceName:"",errorNode:"",httpTookTime:0,httpSize:w||0,httpMd5:0,httpSign:0,httpFullTime:0,httpSpeed:0,md5StartTime:0,md5EndTime:0,signStartTime:0,signEndTime:0,httpStartTime:0,httpEndTime:0,startTime:new Date().getTime(),endTime:0,traceId:o||d.getUid(),appid:fe,partNumber:0,httpRetryTimes:0,customId:D||"",partTime:0},Y&&(this.beacon=M(Y,se))}return O(l,[{key:"formatResult",value:function(n,o){var t,i,u,y,L,k,w=new Date().getTime(),$=d.getNetType(),D=n?(n==null?void 0:n.code)||(n==null||(t=n.error)===null||t===void 0?void 0:t.code)||(n==null||(i=n.error)===null||i===void 0?void 0:i.Code):"",se=n?(n==null?void 0:n.message)||(n==null||(u=n.error)===null||u===void 0?void 0:u.message)||(n==null||(y=n.error)===null||y===void 0?void 0:y.Message):"",oe=se,Y=n?(n==null?void 0:n.resource)||(n==null||(L=n.error)===null||L===void 0?void 0:L.resource)||(n==null||(k=n.error)===null||k===void 0?void 0:k.Resource):"",ae=n?n==null?void 0:n.statusCode:o.statusCode,fe=n?(n==null?void 0:n.headers)&&(n==null?void 0:n.headers["x-cos-request-id"]):(o==null?void 0:o.headers)&&(o==null?void 0:o.headers["x-cos-request-id"]),ie=n?fe?"Server":"Client":"";this.params.requestName==="getObject"&&(this.params.httpSize=o?o.headers&&o.headers["content-length"]:0);var J=this.params.realApi==="sliceUploadFile",V=this.params.realApi==="sliceCopyFile";if(J||V){var Z=this.params.httpSize/1024/this.params.partTime;Object.assign(this.params,{httpSpeed:Z<0?0:Z.toFixed(3)})}else{var de=w-this.params.startTime,ce=this.params.httpEndTime-this.params.httpStartTime,te=this.params.httpSize/1024/(ce/1e3),ne=this.params.md5EndTime-this.params.md5StartTime,ye=this.params.signEndTime-this.params.signStartTime;this.parent&&(this.parent.addParamValue("httpTookTime",f(ce)),this.parent.addParamValue("httpFullTime",f(de)),this.parent.addParamValue("httpMd5",f(ne)),this.parent.addParamValue("httpSign",f(ye)),["multipartUpload","uploadPartCopy","putObjectCopy"].includes(this.params.requestName)&&this.parent.addParamValue("partTime",f(ce))),Object.assign(this.params,{httpFullTime:f(de),httpMd5:f(ne),httpSign:f(ye),httpTookTime:f(ce),httpSpeed:te<0?0:te.toFixed(3)})}if(Object.assign(this.params,{networkType:$,requestResult:n?"Failure":"Success",errorType:ie,errorCode:D,errorHttpCode:ae,errorName:oe,errorMessage:se,errorServiceName:Y,errorRequestId:fe}),n&&(!D||!se)&&(this.params.fullError=n?JSON.stringify(n):""),this.params.url){try{var ge=/^http(s)?:\/\/(.*?)\//.exec(this.params.url);this.params.host=ge[2]}catch{this.params.host=this.params.url}this.params.httpDomain=this.params.host}}},{key:"report",value:function(n,o){if(!(!this.beacon&&!this.clsReporter)){this.formatResult(n,o);var t=G(this.params);this.beacon&&this.sendEventsToBeacon(t),this.clsReporter&&this.sendEventsToCLS(t)}}},{key:"setParams",value:function(n){Object.assign(this.params,n)}},{key:"addParamValue",value:function(n,o){this.params[n]=(+this.params[n]+ +o).toFixed(3)}},{key:"sendEventsToBeacon",value:function(n){var o=this.params.requestName==="sliceUploadFile"||this.params.realApi==="sliceUploadFile";if(!(o&&!this.deepTracker)){var t="qcloud_track_cos_sdk";this.delay===0?this.beacon&&this.beacon.onDirectUserAction(t,n):this.beacon&&this.beacon.onUserAction(t,n)}}},{key:"sendEventsToCLS",value:function(n){var o=this.delay===0;this.clsReporter.log(n,o)}},{key:"generateSubTracker",value:function(n){return Object.assign(n,{parent:this,deepTracker:this.deepTracker,traceId:this.params.traceId,bucket:this.params.bucket,region:this.params.region,accelerate:this.params.accelerate,fileKey:this.params.requestPath,customId:this.params.customId,delay:this.delay,clsReporter:this.clsReporter}),new l(n)}}]),l}();H.exports=g},"./src/util.js":function(H,re,P){(function(F){var O=P("./node_modules/@babel/runtime/helpers/typeof.js");function s(K,T){var E=typeof Symbol<"u"&&K[Symbol.iterator]||K["@@iterator"];if(!E){if(Array.isArray(K)||(E=j(K))||T&&K&&typeof K.length=="number"){E&&(K=E);var I=0,q=function(){};return{s:q,n:function(){return I>=K.length?{done:!0}:{done:!1,value:K[I++]}},e:function(Be){throw Be},f:q}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var W=!0,ee=!1,he;return{s:function(){E=E.call(K)},n:function(){var Be=E.next();return W=Be.done,Be},e:function(Be){ee=!0,he=Be},f:function(){try{!W&&E.return!=null&&E.return()}finally{if(ee)throw he}}}}function j(K,T){if(K){if(typeof K=="string")return b(K,T);var E=Object.prototype.toString.call(K).slice(8,-1);if(E==="Object"&&K.constructor&&(E=K.constructor.name),E==="Map"||E==="Set")return Array.from(K);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return b(K,T)}}function b(K,T){(T==null||T>K.length)&&(T=K.length);for(var E=0,I=new Array(T);E<T;E++)I[E]=K[E];return I}var M=P("./lib/md5.js"),f=P("./lib/crypto.js"),d=P("./node_modules/fast-xml-parser/src/fxp.js"),m=d.XMLParser,h=d.XMLBuilder,C=new m({ignoreDeclaration:!0,ignoreAttributes:!0,parseTagValue:!1}),A=new h,R=P("./lib/base64.js"),N=P("./src/tracker.js"),U=function(T){var E=C.parse(T);return E},z=function(T){var E=A.build(T);return E};function G(K){return encodeURIComponent(K).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")}function g(K,T){var E=[];for(var I in K)K.hasOwnProperty(I)&&E.push(T?G(I).toLowerCase():I);return E.sort(function(q,W){return q=q.toLowerCase(),W=W.toLowerCase(),q===W?0:q>W?1:-1})}var l=function(T,E){var I,q,W,ee=[],he=g(T);for(I=0;I<he.length;I++)q=he[I],W=T[q]===void 0||T[q]===null?"":""+T[q],q=E?G(q).toLowerCase():G(q),W=G(W)||"",ee.push(q+"="+W);return ee.join("&")},x=["cache-control","content-disposition","content-encoding","content-length","content-md5","expect","expires","host","if-match","if-modified-since","if-none-match","if-unmodified-since","origin","range","transfer-encoding","pic-operations"],n=function(T){var E={};for(var I in T){var q=I.toLowerCase();(q.indexOf("x-cos-")>-1||x.indexOf(q)>-1)&&(E[I]=T[I])}return E},o=function(T){T=T||{};var E=T.SecretId,I=T.SecretKey,q=T.KeyTime,W=(T.method||T.Method||"get").toLowerCase(),ee=ae(T.Query||T.params||{}),he=n(ae(T.Headers||T.headers||{})),pe=T.Key||"",Be;T.UseRawKey?Be=T.Pathname||T.pathname||"/"+pe:(Be=T.Pathname||T.pathname||pe,Be.indexOf("/")!==0&&(Be="/"+Be));var Pe=T.ForceSignHost!==!1;if(!he.Host&&!he.host&&T.Bucket&&T.Region&&Pe&&(he.Host=T.Bucket+".cos."+T.Region+".myqcloud.com"),!E)throw new Error("missing param SecretId");if(!I)throw new Error("missing param SecretKey");var Ie=Math.round(qe(T.SystemClockOffset)/1e3)-1,Ee=Ie,Le=T.Expires||T.expires;Le===void 0?Ee+=900:Ee+=Le*1||0;var Ze="sha1",Ve=E,Re=q||Ie+";"+Ee,Ge=q||Ie+";"+Ee,He=g(he,!0).join(";").toLowerCase(),tt=g(ee,!0).join(";").toLowerCase(),ot=f.HmacSHA1(Ge,I).toString(),ft=[W,Be,Fe.obj2str(ee,!0),Fe.obj2str(he,!0),""].join(`
`),ht=["sha1",Re,f.SHA1(ft).toString(),""].join(`
`),X=f.HmacSHA1(ht,ot).toString(),gt=["q-sign-algorithm="+Ze,"q-ak="+Ve,"q-sign-time="+Re,"q-key-time="+Ge,"q-header-list="+He,"q-url-param-list="+tt,"q-signature="+X].join("&");return gt},t=function(T,E,I){var q=E/8,W=T.slice(I,I+q);return new Uint8Array(W).reverse(),new{8:Uint8Array,16:Uint16Array,32:Uint32Array}[E](W)[0]},i=function(T,E,I,q){var W=T.slice(E,I),ee="";return new Uint8Array(W).forEach(function(he){ee+=String.fromCharCode(he)}),q&&(ee=decodeURIComponent(escape(ee))),ee},u=function(T){for(var E={},I=i(T),q={records:[]};T.byteLength;){var W=t(T,32,0),ee=t(T,32,4),he=W-ee-16,pe=0,Be;for(T=T.slice(12);pe<ee;){var Pe=t(T,8,pe),Ie=i(T,pe+1,pe+1+Pe),Ee=t(T,16,pe+Pe+2),Le=i(T,pe+Pe+4,pe+Pe+4+Ee);E[Ie]=Le,pe+=Pe+4+Ee}if(E[":event-type"]==="Records")Be=i(T,pe,pe+he,!0),q.records.push(Be);else if(E[":event-type"]==="Stats")Be=i(T,pe,pe+he,!0),q.stats=Fe.xml2json(Be).Stats;else if(E[":event-type"]==="error"){var Ze=E[":error-code"],Ve=E[":error-message"],Re=new Error(Ve);Re.message=Ve,Re.name=Re.code=Ze,q.error=Re}T=T.slice(pe+he+4)}return{payload:q.records.join(""),body:I}},y=function(T){var E=this.options.CopySourceParser;if(E)return E(T);var I=T.match(/^([^.]+-\d+)\.cos(v6|-cdc|-cdz|-internal)?\.([^.]+)\.((myqcloud\.com)|(tencentcos\.cn))\/(.+)$/);return I?{Bucket:I[1],Region:I[3],Key:I[7]}:null},L=function(){},k=function(T){var E={};for(var I in T)T.hasOwnProperty(I)&&T[I]!==void 0&&T[I]!==null&&(E[I]=T[I]);return E},w=function(T,E){var I,q=new FileReader;FileReader.prototype.readAsBinaryString?(I=FileReader.prototype.readAsBinaryString,q.onload=function(){E(this.result)}):FileReader.prototype.readAsArrayBuffer?I=function(ee){var he="",pe=new FileReader;pe.onload=function(Be){for(var Pe=new Uint8Array(pe.result),Ie=Pe.byteLength,Ee=0;Ee<Ie;Ee++)he+=String.fromCharCode(Pe[Ee]);E(he)},pe.readAsArrayBuffer(ee)}:console.error("FileReader not support readAsBinaryString"),I.call(q,T)},$=function(){var K=function(I,q){I=I.split("."),q=q.split(".");for(var W=0;W<q.length;W++)if(I[W]!==q[W])return parseInt(I[W])>parseInt(q[W])?1:-1;return 0},T=function(I){if(!I)return!1;var q=(I.match(/Chrome\/([.\d]+)/)||[])[1],W=(I.match(/QBCore\/([.\d]+)/)||[])[1],ee=(I.match(/QQBrowser\/([.\d]+)/)||[])[1],he=q&&K(q,"53.0.2785.116")<0&&W&&K(W,"3.53.991.400")<0&&ee&&K(ee,"9.0.2524.400")<=0||!1;return he};return T(typeof navigator<"u"&&navigator.userAgent)}(),D=function(T,E,I,q,W){var ee;if(T.slice?ee=T.slice(E,I):T.mozSlice?ee=T.mozSlice(E,I):T.webkitSlice&&(ee=T.webkitSlice(E,I)),q&&$){var he=new FileReader;he.onload=function(pe){ee=null,W(new Blob([he.result]))},he.readAsArrayBuffer(ee)}else W(ee)},se=function(T,E,I,q){I=I||L,T?typeof E=="string"?I(Fe.md5(E,!0)):Blob&&E instanceof Blob?Fe.getFileMd5(E,function(W,ee){I(ee)},q):I():I()},oe=1024*1024,Y=function(T,E,I){var q=T.size,W=0,ee=M.getCtx(),he=function pe(Be){if(Be>=q){var Pe=ee.digest("hex");E(null,Pe);return}var Ie=Math.min(q,Be+oe);Fe.fileSlice(T,Be,Ie,!1,function(Ee){w(Ee,function(Le){Ee=null,ee=ee.update(Le,!0),W+=Le.length,Le=null,I&&I({loaded:W,total:q,percent:Math.round(W/q*1e4)/1e4}),pe(Be+oe)})})};he(0)};function ae(K){return ce(K,function(T){return O(T)==="object"&&T!==null?ae(T):T})}function fe(K,T,E){return K&&T in K?K[T]:E}function ie(K,T){return de(T,function(E,I){K[I]=T[I]}),K}function J(K){return K instanceof Array}function V(K,T){for(var E=!1,I=0;I<K.length;I++)if(T===K[I]){E=!0;break}return E}function Z(K){return J(K)?K:[K]}function de(K,T){for(var E in K)K.hasOwnProperty(E)&&T(K[E],E)}function ce(K,T){var E=J(K)?[]:{};for(var I in K)K.hasOwnProperty(I)&&(E[I]=T(K[I],I));return E}function te(K,T){var E=J(K),I=E?[]:{};for(var q in K)K.hasOwnProperty(q)&&T(K[q],q)&&(E?I.push(K[q]):I[q]=K[q]);return I}var ne=function(T){var E,I,q,W="";for(E=0,I=T.length/2;E<I;E++)q=parseInt(T[E*2]+T[E*2+1],16),W+=String.fromCharCode(q);return btoa(W)},ye=function(){var T=function(){return((1+Math.random())*65536|0).toString(16).substring(1)};return T()+T()+"-"+T()+"-"+T()+"-"+T()+"-"+T()+T()+T()},ge=function(T,E){var I=E.Bucket,q=E.Region,W=E.Key,ee=this.options.Domain,he=!ee||typeof ee=="string"&&ee.indexOf("{Bucket}")>-1,pe=!ee||typeof ee=="string"&&ee.indexOf("{Region}")>-1;if(T.indexOf("Bucket")>-1||T==="deleteMultipleObject"||T==="multipartList"||T==="listObjectVersions"){if(he&&!I)return"Bucket";if(pe&&!q)return"Region"}else if(T.indexOf("Object")>-1||T.indexOf("multipart")>-1||T==="sliceUploadFile"||T==="abortUploadTask"||T==="uploadFile"){if(he&&!I)return"Bucket";if(pe&&!q)return"Region";if(!W)return"Key"}return!1},ke=function(T,E){if(E=ie({},E),T!=="getAuth"&&T!=="getV4Auth"&&T!=="getObjectUrl"){var I=E.Headers||{};if(E&&O(E)==="object"){(function(){for(var W in E)E.hasOwnProperty(W)&&W.indexOf("x-cos-")>-1&&(I[W]=E[W])})();var q={"x-cos-mfa":"MFA","Content-MD5":"ContentMD5","Content-Length":"ContentLength","Content-Type":"ContentType",Expect:"Expect",Expires:"Expires","Cache-Control":"CacheControl","Content-Disposition":"ContentDisposition","Content-Encoding":"ContentEncoding",Range:"Range","If-Modified-Since":"IfModifiedSince","If-Unmodified-Since":"IfUnmodifiedSince","If-Match":"IfMatch","If-None-Match":"IfNoneMatch","x-cos-copy-source":"CopySource","x-cos-copy-source-Range":"CopySourceRange","x-cos-metadata-directive":"MetadataDirective","x-cos-copy-source-If-Modified-Since":"CopySourceIfModifiedSince","x-cos-copy-source-If-Unmodified-Since":"CopySourceIfUnmodifiedSince","x-cos-copy-source-If-Match":"CopySourceIfMatch","x-cos-copy-source-If-None-Match":"CopySourceIfNoneMatch","x-cos-acl":"ACL","x-cos-grant-read":"GrantRead","x-cos-grant-write":"GrantWrite","x-cos-grant-full-control":"GrantFullControl","x-cos-grant-read-acp":"GrantReadAcp","x-cos-grant-write-acp":"GrantWriteAcp","x-cos-storage-class":"StorageClass","x-cos-traffic-limit":"TrafficLimit","x-cos-mime-limit":"MimeLimit","x-cos-server-side-encryption-customer-algorithm":"SSECustomerAlgorithm","x-cos-server-side-encryption-customer-key":"SSECustomerKey","x-cos-server-side-encryption-customer-key-MD5":"SSECustomerKeyMD5","x-cos-server-side-encryption":"ServerSideEncryption","x-cos-server-side-encryption-cos-kms-key-id":"SSEKMSKeyId","x-cos-server-side-encryption-context":"SSEContext","Pic-Operations":"PicOperations","x-cos-callback":"Callback","x-cos-callback-var":"CallbackVar","x-cos-return-body":"ReturnBody"};Fe.each(q,function(W,ee){E[W]!==void 0&&(I[ee]=E[W])}),E.Headers=k(I)}}return E},me=function(T,E){return function(I,q){var W=this;typeof I=="function"&&(q=I,I={}),I=ke(T,I);var ee;if(W.options.EnableReporter)if(I.calledBySdk==="sliceUploadFile"||I.calledBySdk==="sliceCopyFile")ee=I.tracker&&I.tracker.generateSubTracker({apiName:T});else if(["uploadFile","uploadFiles"].includes(T))ee=null;else{var he=0;I.Body&&(he=typeof I.Body=="string"?I.Body.length:I.Body.size||I.Body.byteLength||0);var pe=W.options.UseAccelerate||typeof W.options.Domain=="string"&&W.options.Domain.includes("accelerate.");ee=new N({Beacon:W.options.BeaconReporter,clsReporter:W.options.ClsReporter,bucket:I.Bucket,region:I.Region,apiName:T,realApi:T,accelerate:pe,fileKey:I.Key,fileSize:he,deepTracker:W.options.DeepTracker,customId:W.options.CustomId,delay:W.options.TrackerDelay})}I.tracker=ee;var Be=function(Re){return Re&&Re.headers&&(Re.headers["x-cos-request-id"]&&(Re.RequestId=Re.headers["x-cos-request-id"]),Re.headers["x-ci-request-id"]&&(Re.RequestId=Re.headers["x-ci-request-id"]),Re.headers["x-cos-version-id"]&&(Re.VersionId=Re.headers["x-cos-version-id"]),Re.headers["x-cos-delete-marker"]&&(Re.DeleteMarker=Re.headers["x-cos-delete-marker"])),Re},Pe=function(Re,Ge){ee&&ee.report(Re,Ge),q&&q(Be(Re),Be(Ge))},Ie=function(){if(T!=="getService"&&T!=="abortUploadTask"){var Re=ge.call(W,T,I);if(Re)return"missing param "+Re;if(I.Region){if(W.options.CompatibilityMode){if(!/^([a-z\d-.]+)$/.test(I.Region))return"Region format error."}else{if(I.Region.indexOf("cos.")>-1)return'param Region should not be start with "cos."';if(!/^([a-z\d-]+)$/.test(I.Region))return"Region format error."}!W.options.CompatibilityMode&&I.Region.indexOf("-")===-1&&I.Region!=="yfb"&&I.Region!=="default"&&I.Region!=="accelerate"&&console.warn("warning: param Region format error, find help here: https://cloud.tencent.com/document/product/436/6224")}if(I.Bucket){if(!/^([a-z\d-]+)-(\d+)$/.test(I.Bucket))if(I.AppId)I.Bucket=I.Bucket+"-"+I.AppId;else if(W.options.AppId)I.Bucket=I.Bucket+"-"+W.options.AppId;else return'Bucket should format as "test-1250000000".';I.AppId&&(console.warn('warning: AppId has been deprecated, Please put it at the end of parameter Bucket(E.g Bucket:"test-1250000000" ).'),delete I.AppId)}!W.options.UseRawKey&&I.Key&&I.Key.substr(0,1)==="/"&&(I.Key=I.Key.substr(1))}},Ee=Ie(),Le=["getAuth","getObjectUrl"].includes(T);if(typeof Promise=="function"&&!Le&&!q)return new Promise(function(Ve,Re){if(q=function(He,tt){He?Re(He):Ve(tt)},Ee)return Pe(Fe.error(new Error(Ee)));E.call(W,I,Pe)});if(Ee)return Pe(Fe.error(new Error(Ee)));var Ze=E.call(W,I,Pe);if(Le)return Ze}},Te=function(T,E){var I=this,q=0,W=0,ee=Date.now(),he,pe;function Be(){if(pe=0,E&&typeof E=="function"){he=Date.now();var Pe=Math.max(0,Math.round((W-q)/((he-ee)/1e3)*100)/100)||0,Ie;W===0&&T===0?Ie=1:Ie=Math.floor(W/T*100)/100||0,ee=he,q=W;try{E({loaded:W,total:T,speed:Pe,percent:Ie})}catch{}}}return function(Pe,Ie){if(Pe&&(W=Pe.loaded,T=Pe.total),Ie)clearTimeout(pe),Be();else{if(pe)return;pe=setTimeout(Be,I.options.ProgressInterval)}}},Oe=function(T,E,I){var q;if(typeof E.Body=="string"?E.Body=new Blob([E.Body],{type:"text/plain"}):E.Body instanceof ArrayBuffer&&(E.Body=new Blob([E.Body])),E.Body&&(E.Body instanceof Blob||E.Body.toString()==="[object File]"||E.Body.toString()==="[object Blob]"))q=E.Body.size;else{I(Fe.error(new Error("params body format error, Only allow File|Blob|String.")));return}E.ContentLength=q,I(null,q)},qe=function(T){return Date.now()+(T||0)},je=function(T,E){var I=T;return T.message=T.message||null,typeof E=="string"?(T.error=E,T.message=E):O(E)==="object"&&E!==null&&(ie(T,E),(E.code||E.name)&&(T.code=E.code||E.name),E.message&&(T.message=E.message),E.stack&&(T.stack=E.stack)),typeof Object.defineProperty=="function"&&(Object.defineProperty(T,"name",{writable:!0,enumerable:!1}),Object.defineProperty(T,"message",{enumerable:!0})),T.name=E&&E.name||T.name||T.code||"Error",T.code||(T.code=T.name),T.error||(T.error=ae(I)),T},We=function(){return(typeof globalThis>"u"?"undefined":O(globalThis))==="object"&&(globalThis.constructor.name==="DedicatedWorkerGlobalScope"||globalThis.FileReaderSync)},Je=function(){return(typeof window>"u"?"undefined":O(window))!=="object"&&(typeof F>"u"?"undefined":O(F))==="object"&&!0&&!We()},Me=function(T){return/^https?:\/\/([^/]+\.)?ci\.[^/]+/.test(T)},Qe=function(){if((typeof navigator>"u"?"undefined":O(navigator))!=="object")return!1;var K=navigator.userAgent,T=!!K.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);return T}(),rt=function(){return(typeof navigator>"u"?"undefined":O(navigator))!=="object"?!1:/\sQQ/i.test(navigator.userAgent)}(),ct=function(T,E){var I=R.encode(T);return E&&(I=I.replaceAll("+","-").replaceAll("/","_").replaceAll("=","")),I},at=function(T){return T?R.decode(T):""},lt=function(T){var E=T.split("/"),I=[],q=s(E),W;try{for(q.s();!(W=q.n()).done;){var ee=W.value;ee===".."?I.length&&I.pop():ee.length&&ee!=="."&&I.push(ee)}}catch(he){q.e(he)}finally{q.f()}return"/"+I.join("/")},dt=function(T){var E;if(T&&typeof T=="string"){var I=T.trim(),q=I.indexOf("<")===0,W=I.indexOf("{")===0;if(q)E=Fe.xml2json(T)||{};else if(W)try{var ee=T.replace(/\n/g," "),he=JSON.parse(ee);Object.prototype.toString.call(he)==="[object Object]"?E=he:E=T}catch{E=T}else E=T}else E=T||{};return E},Fe={noop:L,formatParams:ke,apiWrapper:me,xml2json:U,json2xml:z,md5:M,clearKey:k,fileSlice:D,getBodyMd5:se,getFileMd5:Y,b64:ne,extend:ie,isArray:J,isInArray:V,makeArray:Z,each:de,map:ce,filter:te,clone:ae,attr:fe,uuid:ye,camSafeUrlEncode:G,throttleOnProgress:Te,getFileSize:Oe,getSkewTime:qe,error:je,obj2str:l,getAuth:o,parseSelectPayload:u,getSourceParams:y,isBrowser:!0,isNode:Je,isCIHost:Me,isIOS_QQ:Qe&&rt,encodeBase64:ct,decodeBase64:at,simplifyPath:lt,readAsBinaryString:w,parseResBody:dt};H.exports=Fe}).call(this,P("./node_modules/process/browser.js"))}})})})(mt);var Ut=mt.exports;const Bt=Et(Ut);function Ft(Ne){let $e=null;const H=Ne.secretId,re=Ne.secretKey,P=Ne.getAuthorization;return!H&&!re&&P?$e=new Bt({getAuthorization(F,O){P(Ne).then(s=>{s.ExpiredTime&&typeof s.ExpiredTime=="string"&&(s.ExpiredTime=Ot(s.ExpiredTime).unix()),O(s)})}}):(console.warn("您还未配置getAuthorization，将使用SecretKey授权进行上传"),$e=new Bt({SecretId:H,SecretKey:re})),$e}async function Nt({file:Ne,fileName:$e,onProgress:H,options:re}){const P=await It(Ne,$e,re),F=re,O=Ft(F);return new Promise((s,j)=>{O.putObject({Bucket:F.bucket,Region:F.region,Key:P,Body:Ne,onProgress(b){const M=b;M.total>0&&(M.percent=Math.floor(M.loaded/M.total*100)),H(M)}},async function(b,M){if(b!=null){console.error(b),j(b);return}let f={url:F.domain+"/"+P,key:P};if(F.successHandle){f=await F.successHandle(f),s(f);return}s(f)})})}async function Lt(Ne){const{getConfig:$e}=wt(),H=$e("cos"),re=Ne.options,P=Rt.merge(Rt.cloneDeep(H),re);return Ne.options=P,await Nt(Ne)}export{Ft as getOssClient,Lt as upload};
